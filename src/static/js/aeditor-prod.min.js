function mht(a){var b="";if(16==a.length)for(var c=0;4>c;c++)b+="<span style='font-family: monospace'>["+a[4*c+0].toFixed(4)+","+a[4*c+1].toFixed(4)+","+a[4*c+2].toFixed(4)+","+a[4*c+3].toFixed(4)+"]</span><br>";else{if(9!=a.length)return a.toString();for(var c=0;3>c;c++)b+="<span style='font-family: monospace'>["+a[3*c+0].toFixed(4)+","+a[3*c+1].toFixed(4)+","+a[3*c+2].toFixed(4)+"]</font><br>"}return b}function makeLookAt(a,b,c,d,e,f,g,h,i){var j=$V([a,b,c]),k=$V([d,e,f]),l=$V([g,h,i]),m=j.subtract(k).toUnitVector(),n=l.cross(m).toUnitVector(),o=m.cross(n).toUnitVector(),p=$M([[n.e(1),n.e(2),n.e(3),0],[o.e(1),o.e(2),o.e(3),0],[m.e(1),m.e(2),m.e(3),0],[0,0,0,1]]),q=$M([[1,0,0,-a],[0,1,0,-b],[0,0,1,-c],[0,0,0,1]]);return p.x(q)}function makeOrtho(a,b,c,d,e,f){var g=-(b+a)/(b-a),h=-(d+c)/(d-c),i=-(f+e)/(f-e);return $M([[2/(b-a),0,0,g],[0,2/(d-c),0,h],[0,0,-2/(f-e),i],[0,0,0,1]])}function makePerspective(a,b,c,d){var e=c*Math.tan(a*Math.PI/360),f=-e,g=f*b,h=e*b;return makeFrustum(g,h,f,e,c,d)}function makeFrustum(a,b,c,d,e,f){var g=2*e/(b-a),h=2*e/(d-c),i=(b+a)/(b-a),j=(d+c)/(d-c),k=-(f+e)/(f-e),l=-2*f*e/(f-e);return $M([[g,0,i,0],[0,h,j,0],[0,0,k,l],[0,0,-1,0]])}function makeOrtho(a,b,c,d,e,f){var g=-(b+a)/(b-a),h=-(d+c)/(d-c),i=-(f+e)/(f-e);return $M([[2/(b-a),0,0,g],[0,2/(d-c),0,h],[0,0,-2/(f-e),i],[0,0,0,1]])}function microAjax(a,b){if(this.bindFunction=function(a,b){return function(){return a.apply(b,[b])}},this.stateChange=function(){4==this.request.readyState&&this.callbackFunction(this.request.responseText)},this.getRequest=function(){return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest?new XMLHttpRequest:!1},this.postBody=arguments[2]||"",this.callbackFunction=b,this.url=a,this.request=this.getRequest(),this.request){var c=this.request;c.onreadystatechange=this.bindFunction(this.stateChange,this),""!==this.postBody?(c.open("POST",a,!0),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.setRequestHeader("Content-type","application/x-www-form-urlencoded"),c.setRequestHeader("Connection","close")):c.open("GET",a,!0),c.send(this.postBody)}}!function(a,b){function c(a){var b=a.length,c=fb.type(a);return fb.isWindow(a)?!1:1===a.nodeType&&b?!0:"array"===c||"function"!==c&&(0===b||"number"==typeof b&&b>0&&b-1 in a)}function d(a){var b=ob[a]={};return fb.each(a.match(hb)||[],function(a,c){b[c]=!0}),b}function e(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=fb.expando+Math.random()}function f(a,c,d){var e;if(d===b&&1===a.nodeType)if(e="data-"+c.replace(sb,"-$1").toLowerCase(),d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:+d+""===d?+d:rb.test(d)?JSON.parse(d):d}catch(f){}pb.set(a,c,d)}else d=b;return d}function g(){return!0}function h(){return!1}function i(){try{return T.activeElement}catch(a){}}function j(a,b){for(;(a=a[b])&&1!==a.nodeType;);return a}function k(a,b,c){if(fb.isFunction(b))return fb.grep(a,function(a,d){return!!b.call(a,d,a)!==c});if(b.nodeType)return fb.grep(a,function(a){return a===b!==c});if("string"==typeof b){if(Cb.test(b))return fb.filter(b,a,c);b=fb.filter(b,a)}return fb.grep(a,function(a){return bb.call(b,a)>=0!==c})}function l(a,b){return fb.nodeName(a,"table")&&fb.nodeName(1===b.nodeType?b:b.firstChild,"tr")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function m(a){return a.type=(null!==a.getAttribute("type"))+"/"+a.type,a}function n(a){var b=Nb.exec(a.type);return b?a.type=b[1]:a.removeAttribute("type"),a}function o(a,b){for(var c=a.length,d=0;c>d;d++)qb.set(a[d],"globalEval",!b||qb.get(b[d],"globalEval"))}function p(a,b){var c,d,e,f,g,h,i,j;if(1===b.nodeType){if(qb.hasData(a)&&(f=qb.access(a),g=qb.set(b,f),j=f.events)){delete g.handle,g.events={};for(e in j)for(c=0,d=j[e].length;d>c;c++)fb.event.add(b,e,j[e][c])}pb.hasData(a)&&(h=pb.access(a),i=fb.extend({},h),pb.set(b,i))}}function q(a,c){var d=a.getElementsByTagName?a.getElementsByTagName(c||"*"):a.querySelectorAll?a.querySelectorAll(c||"*"):[];return c===b||c&&fb.nodeName(a,c)?fb.merge([a],d):d}function r(a,b){var c=b.nodeName.toLowerCase();"input"===c&&Kb.test(a.type)?b.checked=a.checked:("input"===c||"textarea"===c)&&(b.defaultValue=a.defaultValue)}function s(a,b){if(b in a)return b;for(var c=b.charAt(0).toUpperCase()+b.slice(1),d=b,e=_b.length;e--;)if(b=_b[e]+c,b in a)return b;return d}function t(a,b){return a=b||a,"none"===fb.css(a,"display")||!fb.contains(a.ownerDocument,a)}function u(b){return a.getComputedStyle(b,null)}function v(a,b){for(var c,d,e,f=[],g=0,h=a.length;h>g;g++)d=a[g],d.style&&(f[g]=qb.get(d,"olddisplay"),c=d.style.display,b?(f[g]||"none"!==c||(d.style.display=""),""===d.style.display&&t(d)&&(f[g]=qb.access(d,"olddisplay",z(d.nodeName)))):f[g]||(e=t(d),(c&&"none"!==c||!e)&&qb.set(d,"olddisplay",e?c:fb.css(d,"display"))));for(g=0;h>g;g++)d=a[g],d.style&&(b&&"none"!==d.style.display&&""!==d.style.display||(d.style.display=b?f[g]||"":"none"));return a}function w(a,b,c){var d=Ub.exec(b);return d?Math.max(0,d[1]-(c||0))+(d[2]||"px"):b}function x(a,b,c,d,e){for(var f=c===(d?"border":"content")?4:"width"===b?1:0,g=0;4>f;f+=2)"margin"===c&&(g+=fb.css(a,c+$b[f],!0,e)),d?("content"===c&&(g-=fb.css(a,"padding"+$b[f],!0,e)),"margin"!==c&&(g-=fb.css(a,"border"+$b[f]+"Width",!0,e))):(g+=fb.css(a,"padding"+$b[f],!0,e),"padding"!==c&&(g+=fb.css(a,"border"+$b[f]+"Width",!0,e)));return g}function y(a,b,c){var d=!0,e="width"===b?a.offsetWidth:a.offsetHeight,f=u(a),g=fb.support.boxSizing&&"border-box"===fb.css(a,"boxSizing",!1,f);if(0>=e||null==e){if(e=Qb(a,b,f),(0>e||null==e)&&(e=a.style[b]),Vb.test(e))return e;d=g&&(fb.support.boxSizingReliable||e===a.style[b]),e=parseFloat(e)||0}return e+x(a,b,c||(g?"border":"content"),d,f)+"px"}function z(a){var b=T,c=Xb[a];return c||(c=A(a,b),"none"!==c&&c||(Rb=(Rb||fb("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(b.documentElement),b=(Rb[0].contentWindow||Rb[0].contentDocument).document,b.write("<!doctype html><html><body>"),b.close(),c=A(a,b),Rb.detach()),Xb[a]=c),c}function A(a,b){var c=fb(b.createElement(a)).appendTo(b.body),d=fb.css(c[0],"display");return c.remove(),d}function B(a,b,c,d){var e;if(fb.isArray(b))fb.each(b,function(b,e){c||bc.test(a)?d(a,e):B(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==fb.type(b))d(a,b);else for(e in b)B(a+"["+e+"]",b[e],c,d)}function C(a){return function(b,c){"string"!=typeof b&&(c=b,b="*");var d,e=0,f=b.toLowerCase().match(hb)||[];if(fb.isFunction(c))for(;d=f[e++];)"+"===d[0]?(d=d.slice(1)||"*",(a[d]=a[d]||[]).unshift(c)):(a[d]=a[d]||[]).push(c)}}function D(a,c,d,e){function f(i){var j;return g[i]=!0,fb.each(a[i]||[],function(a,i){var k=i(c,d,e);return"string"!=typeof k||h||g[k]?h?!(j=k):b:(c.dataTypes.unshift(k),f(k),!1)}),j}var g={},h=a===sc;return f(c.dataTypes[0])||!g["*"]&&f("*")}function E(a,c){var d,e,f=fb.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);return e&&fb.extend(!0,a,e),a}function F(a,c,d){for(var e,f,g,h,i=a.contents,j=a.dataTypes;"*"===j[0];)j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("Content-Type"));if(e)for(f in i)if(i[f]&&i[f].test(e)){j.unshift(f);break}if(j[0]in d)g=j[0];else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}return g?(g!==j[0]&&j.unshift(g),d[g]):b}function G(a,b,c,d){var e,f,g,h,i,j={},k=a.dataTypes.slice();if(k[1])for(g in a.converters)j[g.toLowerCase()]=a.converters[g];for(f=k.shift();f;)if(a.responseFields[f]&&(c[a.responseFields[f]]=b),!i&&d&&a.dataFilter&&(b=a.dataFilter(b,a.dataType)),i=f,f=k.shift())if("*"===f)f=i;else if("*"!==i&&i!==f){if(g=j[i+" "+f]||j["* "+f],!g)for(e in j)if(h=e.split(" "),h[1]===f&&(g=j[i+" "+h[0]]||j["* "+h[0]])){g===!0?g=j[e]:j[e]!==!0&&(f=h[0],k.unshift(h[1]));break}if(g!==!0)if(g&&a["throws"])b=g(b);else try{b=g(b)}catch(l){return{state:"parsererror",error:g?l:"No conversion from "+i+" to "+f}}}return{state:"success",data:b}}function H(){return setTimeout(function(){Bc=b}),Bc=fb.now()}function I(a,b,c){for(var d,e=(Hc[b]||[]).concat(Hc["*"]),f=0,g=e.length;g>f;f++)if(d=e[f].call(c,b,a))return d}function J(a,b,c){var d,e,f=0,g=Gc.length,h=fb.Deferred().always(function(){delete i.elem}),i=function(){if(e)return!1;for(var b=Bc||H(),c=Math.max(0,j.startTime+j.duration-b),d=c/j.duration||0,f=1-d,g=0,i=j.tweens.length;i>g;g++)j.tweens[g].run(f);return h.notifyWith(a,[j,f,c]),1>f&&i?c:(h.resolveWith(a,[j]),!1)},j=h.promise({elem:a,props:fb.extend({},b),opts:fb.extend(!0,{specialEasing:{}},c),originalProperties:b,originalOptions:c,startTime:Bc||H(),duration:c.duration,tweens:[],createTween:function(b,c){var d=fb.Tween(a,j.opts,b,c,j.opts.specialEasing[b]||j.opts.easing);return j.tweens.push(d),d},stop:function(b){var c=0,d=b?j.tweens.length:0;if(e)return this;for(e=!0;d>c;c++)j.tweens[c].run(1);return b?h.resolveWith(a,[j,b]):h.rejectWith(a,[j,b]),this}}),k=j.props;for(K(k,j.opts.specialEasing);g>f;f++)if(d=Gc[f].call(j,a,k,j.opts))return d;return fb.map(k,I,j),fb.isFunction(j.opts.start)&&j.opts.start.call(a,j),fb.fx.timer(fb.extend(i,{elem:a,anim:j,queue:j.opts.queue})),j.progress(j.opts.progress).done(j.opts.done,j.opts.complete).fail(j.opts.fail).always(j.opts.always)}function K(a,b){var c,d,e,f,g;for(c in a)if(d=fb.camelCase(c),e=b[d],f=a[c],fb.isArray(f)&&(e=f[1],f=a[c]=f[0]),c!==d&&(a[d]=f,delete a[c]),g=fb.cssHooks[d],g&&"expand"in g){f=g.expand(f),delete a[d];for(c in f)c in a||(a[c]=f[c],b[c]=e)}else b[d]=e}function L(a,c,d){var e,f,g,h,i,j,k=this,l={},m=a.style,n=a.nodeType&&t(a),o=qb.get(a,"fxshow");d.queue||(i=fb._queueHooks(a,"fx"),null==i.unqueued&&(i.unqueued=0,j=i.empty.fire,i.empty.fire=function(){i.unqueued||j()}),i.unqueued++,k.always(function(){k.always(function(){i.unqueued--,fb.queue(a,"fx").length||i.empty.fire()})})),1===a.nodeType&&("height"in c||"width"in c)&&(d.overflow=[m.overflow,m.overflowX,m.overflowY],"inline"===fb.css(a,"display")&&"none"===fb.css(a,"float")&&(m.display="inline-block")),d.overflow&&(m.overflow="hidden",k.always(function(){m.overflow=d.overflow[0],m.overflowX=d.overflow[1],m.overflowY=d.overflow[2]}));for(e in c)if(f=c[e],Dc.exec(f)){if(delete c[e],g=g||"toggle"===f,f===(n?"hide":"show")){if("show"!==f||!o||o[e]===b)continue;n=!0}l[e]=o&&o[e]||fb.style(a,e)}if(!fb.isEmptyObject(l)){o?"hidden"in o&&(n=o.hidden):o=qb.access(a,"fxshow",{}),g&&(o.hidden=!n),n?fb(a).show():k.done(function(){fb(a).hide()}),k.done(function(){var b;qb.remove(a,"fxshow");for(b in l)fb.style(a,b,l[b])});for(e in l)h=I(n?o[e]:0,e,k),e in o||(o[e]=h.start,n&&(h.end=h.start,h.start="width"===e||"height"===e?1:0))}}function M(a,b,c,d,e){return new M.prototype.init(a,b,c,d,e)}function N(a,b){var c,d={height:a},e=0;for(b=b?1:0;4>e;e+=2-b)c=$b[e],d["margin"+c]=d["padding"+c]=a;return b&&(d.opacity=d.width=a),d}function O(a){return fb.isWindow(a)?a:9===a.nodeType&&a.defaultView}var P,Q,R=typeof b,S=a.location,T=a.document,U=T.documentElement,V=a.jQuery,W=a.$,X={},Y=[],Z="2.0.3",$=Y.concat,_=Y.push,ab=Y.slice,bb=Y.indexOf,cb=X.toString,db=X.hasOwnProperty,eb=Z.trim,fb=function(a,b){return new fb.fn.init(a,b,P)},gb=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,hb=/\S+/g,ib=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,jb=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,kb=/^-ms-/,lb=/-([\da-z])/gi,mb=function(a,b){return b.toUpperCase()},nb=function(){T.removeEventListener("DOMContentLoaded",nb,!1),a.removeEventListener("load",nb,!1),fb.ready()};fb.fn=fb.prototype={jquery:Z,constructor:fb,init:function(a,c,d){var e,f;if(!a)return this;if("string"==typeof a){if(e="<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&a.length>=3?[null,a,null]:ib.exec(a),!e||!e[1]&&c)return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a);if(e[1]){if(c=c instanceof fb?c[0]:c,fb.merge(this,fb.parseHTML(e[1],c&&c.nodeType?c.ownerDocument||c:T,!0)),jb.test(e[1])&&fb.isPlainObject(c))for(e in c)fb.isFunction(this[e])?this[e](c[e]):this.attr(e,c[e]);return this}return f=T.getElementById(e[2]),f&&f.parentNode&&(this.length=1,this[0]=f),this.context=T,this.selector=a,this}return a.nodeType?(this.context=this[0]=a,this.length=1,this):fb.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),fb.makeArray(a,this))},selector:"",length:0,toArray:function(){return ab.call(this)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a){var b=fb.merge(this.constructor(),a);return b.prevObject=this,b.context=this.context,b},each:function(a,b){return fb.each(this,a,b)},ready:function(a){return fb.ready.promise().done(a),this},slice:function(){return this.pushStack(ab.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(a){var b=this.length,c=+a+(0>a?b:0);return this.pushStack(c>=0&&b>c?[this[c]]:[])},map:function(a){return this.pushStack(fb.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:_,sort:[].sort,splice:[].splice},fb.fn.init.prototype=fb.fn,fb.extend=fb.fn.extend=function(){var a,c,d,e,f,g,h=arguments[0]||{},i=1,j=arguments.length,k=!1;for("boolean"==typeof h&&(k=h,h=arguments[1]||{},i=2),"object"==typeof h||fb.isFunction(h)||(h={}),j===i&&(h=this,--i);j>i;i++)if(null!=(a=arguments[i]))for(c in a)d=h[c],e=a[c],h!==e&&(k&&e&&(fb.isPlainObject(e)||(f=fb.isArray(e)))?(f?(f=!1,g=d&&fb.isArray(d)?d:[]):g=d&&fb.isPlainObject(d)?d:{},h[c]=fb.extend(k,g,e)):e!==b&&(h[c]=e));return h},fb.extend({expando:"jQuery"+(Z+Math.random()).replace(/\D/g,""),noConflict:function(b){return a.$===fb&&(a.$=W),b&&a.jQuery===fb&&(a.jQuery=V),fb},isReady:!1,readyWait:1,holdReady:function(a){a?fb.readyWait++:fb.ready(!0)},ready:function(a){(a===!0?--fb.readyWait:fb.isReady)||(fb.isReady=!0,a!==!0&&--fb.readyWait>0||(Q.resolveWith(T,[fb]),fb.fn.trigger&&fb(T).trigger("ready").off("ready")))},isFunction:function(a){return"function"===fb.type(a)},isArray:Array.isArray,isWindow:function(a){return null!=a&&a===a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?a+"":"object"==typeof a||"function"==typeof a?X[cb.call(a)]||"object":typeof a},isPlainObject:function(a){if("object"!==fb.type(a)||a.nodeType||fb.isWindow(a))return!1;try{if(a.constructor&&!db.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0},isEmptyObject:function(a){var b;for(b in a)return!1;return!0},error:function(a){throw Error(a)},parseHTML:function(a,b,c){if(!a||"string"!=typeof a)return null;"boolean"==typeof b&&(c=b,b=!1),b=b||T;var d=jb.exec(a),e=!c&&[];return d?[b.createElement(d[1])]:(d=fb.buildFragment([a],b,e),e&&fb(e).remove(),fb.merge([],d.childNodes))},parseJSON:JSON.parse,parseXML:function(a){var c,d;if(!a||"string"!=typeof a)return null;try{d=new DOMParser,c=d.parseFromString(a,"text/xml")}catch(e){c=b}return(!c||c.getElementsByTagName("parsererror").length)&&fb.error("Invalid XML: "+a),c},noop:function(){},globalEval:function(a){var b,c=eval;a=fb.trim(a),a&&(1===a.indexOf("use strict")?(b=T.createElement("script"),b.text=a,T.head.appendChild(b).parentNode.removeChild(b)):c(a))},camelCase:function(a){return a.replace(kb,"ms-").replace(lb,mb)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toLowerCase()===b.toLowerCase()},each:function(a,b,d){var e,f=0,g=a.length,h=c(a);if(d){if(h)for(;g>f&&(e=b.apply(a[f],d),e!==!1);f++);else for(f in a)if(e=b.apply(a[f],d),e===!1)break}else if(h)for(;g>f&&(e=b.call(a[f],f,a[f]),e!==!1);f++);else for(f in a)if(e=b.call(a[f],f,a[f]),e===!1)break;return a},trim:function(a){return null==a?"":eb.call(a)},makeArray:function(a,b){var d=b||[];return null!=a&&(c(Object(a))?fb.merge(d,"string"==typeof a?[a]:a):_.call(d,a)),d},inArray:function(a,b,c){return null==b?-1:bb.call(b,a,c)},merge:function(a,c){var d=c.length,e=a.length,f=0;if("number"==typeof d)for(;d>f;f++)a[e++]=c[f];else for(;c[f]!==b;)a[e++]=c[f++];return a.length=e,a},grep:function(a,b,c){var d,e=[],f=0,g=a.length;for(c=!!c;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,b,d){var e,f=0,g=a.length,h=c(a),i=[];if(h)for(;g>f;f++)e=b(a[f],f,d),null!=e&&(i[i.length]=e);else for(f in a)e=b(a[f],f,d),null!=e&&(i[i.length]=e);return $.apply([],i)},guid:1,proxy:function(a,c){var d,e,f;return"string"==typeof c&&(d=a[c],c=a,a=d),fb.isFunction(a)?(e=ab.call(arguments,2),f=function(){return a.apply(c||this,e.concat(ab.call(arguments)))},f.guid=a.guid=a.guid||fb.guid++,f):b},access:function(a,c,d,e,f,g,h){var i=0,j=a.length,k=null==d;if("object"===fb.type(d)){f=!0;for(i in d)fb.access(a,c,i,d[i],!0,g,h)}else if(e!==b&&(f=!0,fb.isFunction(e)||(h=!0),k&&(h?(c.call(a,e),c=null):(k=c,c=function(a,b,c){return k.call(fb(a),c)})),c))for(;j>i;i++)c(a[i],d,h?e:e.call(a[i],i,c(a[i],d)));return f?a:k?c.call(a):j?c(a[0],d):g},now:Date.now,swap:function(a,b,c,d){var e,f,g={};for(f in b)g[f]=a.style[f],a.style[f]=b[f];e=c.apply(a,d||[]);for(f in b)a.style[f]=g[f];return e}}),fb.ready.promise=function(b){return Q||(Q=fb.Deferred(),"complete"===T.readyState?setTimeout(fb.ready):(T.addEventListener("DOMContentLoaded",nb,!1),a.addEventListener("load",nb,!1))),Q.promise(b)},fb.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(a,b){X["[object "+b+"]"]=b.toLowerCase()}),P=fb(T),function(a,b){function c(a,b,c,d){var e,f,g,h,i,j,k,l,o,p;if((b?b.ownerDocument||b:O)!==G&&F(b),b=b||G,c=c||[],!a||"string"!=typeof a)return c;if(1!==(h=b.nodeType)&&9!==h)return[];if(I&&!d){if(e=tb.exec(a))if(g=e[1]){if(9===h){if(f=b.getElementById(g),!f||!f.parentNode)return c;if(f.id===g)return c.push(f),c}else if(b.ownerDocument&&(f=b.ownerDocument.getElementById(g))&&M(b,f)&&f.id===g)return c.push(f),c}else{if(e[2])return ab.apply(c,b.getElementsByTagName(a)),c;if((g=e[3])&&x.getElementsByClassName&&b.getElementsByClassName)return ab.apply(c,b.getElementsByClassName(g)),c}if(x.qsa&&(!J||!J.test(a))){if(l=k=N,o=b,p=9===h&&a,1===h&&"object"!==b.nodeName.toLowerCase()){for(j=m(a),(k=b.getAttribute("id"))?l=k.replace(wb,"\\$&"):b.setAttribute("id",l),l="[id='"+l+"'] ",i=j.length;i--;)j[i]=l+n(j[i]);o=nb.test(a)&&b.parentNode||b,p=j.join(",")}if(p)try{return ab.apply(c,o.querySelectorAll(p)),c}catch(q){}finally{k||b.removeAttribute("id")}}}return v(a.replace(kb,"$1"),b,c,d)}function d(){function a(c,d){return b.push(c+=" ")>z.cacheLength&&delete a[b.shift()],a[c]=d}var b=[];return a}function e(a){return a[N]=!0,a}function f(a){var b=G.createElement("div");try{return!!a(b)}catch(c){return!1}finally{b.parentNode&&b.parentNode.removeChild(b),b=null}}function g(a,b){for(var c=a.split("|"),d=a.length;d--;)z.attrHandle[c[d]]=b}function h(a,b){var c=b&&a,d=c&&1===a.nodeType&&1===b.nodeType&&(~b.sourceIndex||X)-(~a.sourceIndex||X);if(d)return d;if(c)for(;c=c.nextSibling;)if(c===b)return-1;return a?1:-1}function i(a){return function(b){var c=b.nodeName.toLowerCase();return"input"===c&&b.type===a}}function j(a){return function(b){var c=b.nodeName.toLowerCase();return("input"===c||"button"===c)&&b.type===a}}function k(a){return e(function(b){return b=+b,e(function(c,d){for(var e,f=a([],c.length,b),g=f.length;g--;)c[e=f[g]]&&(c[e]=!(d[e]=c[e]))})})}function l(){}function m(a,b){var d,e,f,g,h,i,j,k=S[a+" "];if(k)return b?0:k.slice(0);for(h=a,i=[],j=z.preFilter;h;){(!d||(e=lb.exec(h)))&&(e&&(h=h.slice(e[0].length)||h),i.push(f=[])),d=!1,(e=mb.exec(h))&&(d=e.shift(),f.push({value:d,type:e[0].replace(kb," ")}),h=h.slice(d.length));for(g in z.filter)!(e=rb[g].exec(h))||j[g]&&!(e=j[g](e))||(d=e.shift(),f.push({value:d,type:g,matches:e}),h=h.slice(d.length));if(!d)break}return b?h.length:h?c.error(a):S(a,i).slice(0)}function n(a){for(var b=0,c=a.length,d="";c>b;b++)d+=a[b].value;return d}function o(a,b,c){var d=b.dir,e=c&&"parentNode"===d,f=Q++;return b.first?function(b,c,f){for(;b=b[d];)if(1===b.nodeType||e)return a(b,c,f)}:function(b,c,g){var h,i,j,k=P+" "+f;if(g){for(;b=b[d];)if((1===b.nodeType||e)&&a(b,c,g))return!0}else for(;b=b[d];)if(1===b.nodeType||e)if(j=b[N]||(b[N]={}),(i=j[d])&&i[0]===k){if((h=i[1])===!0||h===y)return h===!0}else if(i=j[d]=[k],i[1]=a(b,c,g)||y,i[1]===!0)return!0}}function p(a){return a.length>1?function(b,c,d){for(var e=a.length;e--;)if(!a[e](b,c,d))return!1;return!0}:a[0]}function q(a,b,c,d,e){for(var f,g=[],h=0,i=a.length,j=null!=b;i>h;h++)(f=a[h])&&(!c||c(f,d,e))&&(g.push(f),j&&b.push(h));return g}function r(a,b,c,d,f,g){return d&&!d[N]&&(d=r(d)),f&&!f[N]&&(f=r(f,g)),e(function(e,g,h,i){var j,k,l,m=[],n=[],o=g.length,p=e||u(b||"*",h.nodeType?[h]:h,[]),r=!a||!e&&b?p:q(p,m,a,h,i),s=c?f||(e?a:o||d)?[]:g:r;if(c&&c(r,s,h,i),d)for(j=q(s,n),d(j,[],h,i),k=j.length;k--;)(l=j[k])&&(s[n[k]]=!(r[n[k]]=l));if(e){if(f||a){if(f){for(j=[],k=s.length;k--;)(l=s[k])&&j.push(r[k]=l);f(null,s=[],j,i)}for(k=s.length;k--;)(l=s[k])&&(j=f?cb.call(e,l):m[k])>-1&&(e[j]=!(g[j]=l))}}else s=q(s===g?s.splice(o,s.length):s),f?f(null,g,s,i):ab.apply(g,s)})}function s(a){for(var b,c,d,e=a.length,f=z.relative[a[0].type],g=f||z.relative[" "],h=f?1:0,i=o(function(a){return a===b},g,!0),j=o(function(a){return cb.call(b,a)>-1},g,!0),k=[function(a,c,d){return!f&&(d||c!==D)||((b=c).nodeType?i(a,c,d):j(a,c,d))}];e>h;h++)if(c=z.relative[a[h].type])k=[o(p(k),c)];else{if(c=z.filter[a[h].type].apply(null,a[h].matches),c[N]){for(d=++h;e>d&&!z.relative[a[d].type];d++);return r(h>1&&p(k),h>1&&n(a.slice(0,h-1).concat({value:" "===a[h-2].type?"*":""})).replace(kb,"$1"),c,d>h&&s(a.slice(h,d)),e>d&&s(a=a.slice(d)),e>d&&n(a))}k.push(c)}return p(k)}function t(a,b){var d=0,f=b.length>0,g=a.length>0,h=function(e,h,i,j,k){var l,m,n,o=[],p=0,r="0",s=e&&[],t=null!=k,u=D,v=e||g&&z.find.TAG("*",k&&h.parentNode||h),w=P+=null==u?1:Math.random()||.1;for(t&&(D=h!==G&&h,y=d);null!=(l=v[r]);r++){if(g&&l){for(m=0;n=a[m++];)if(n(l,h,i)){j.push(l);break}t&&(P=w,y=++d)}f&&((l=!n&&l)&&p--,e&&s.push(l))}if(p+=r,f&&r!==p){for(m=0;n=b[m++];)n(s,o,h,i);if(e){if(p>0)for(;r--;)s[r]||o[r]||(o[r]=$.call(j));o=q(o)}ab.apply(j,o),t&&!e&&o.length>0&&p+b.length>1&&c.uniqueSort(j)}return t&&(P=w,D=u),s};return f?e(h):h}function u(a,b,d){for(var e=0,f=b.length;f>e;e++)c(a,b[e],d);return d}function v(a,b,c,d){var e,f,g,h,i,j=m(a);if(!d&&1===j.length){if(f=j[0]=j[0].slice(0),f.length>2&&"ID"===(g=f[0]).type&&x.getById&&9===b.nodeType&&I&&z.relative[f[1].type]){if(b=(z.find.ID(g.matches[0].replace(xb,yb),b)||[])[0],!b)return c;a=a.slice(f.shift().value.length)}for(e=rb.needsContext.test(a)?0:f.length;e--&&(g=f[e],!z.relative[h=g.type]);)if((i=z.find[h])&&(d=i(g.matches[0].replace(xb,yb),nb.test(f[0].type)&&b.parentNode||b))){if(f.splice(e,1),a=d.length&&n(f),!a)return ab.apply(c,d),c;break}}return C(a,j)(d,b,!I,c,nb.test(a)),c}var w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N="sizzle"+-new Date,O=a.document,P=0,Q=0,R=d(),S=d(),T=d(),U=!1,V=function(a,b){return a===b?(U=!0,0):0},W=typeof b,X=1<<31,Y={}.hasOwnProperty,Z=[],$=Z.pop,_=Z.push,ab=Z.push,bb=Z.slice,cb=Z.indexOf||function(a){for(var b=0,c=this.length;c>b;b++)if(this[b]===a)return b;return-1},db="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",eb="[\\x20\\t\\r\\n\\f]",gb="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",hb=gb.replace("w","w#"),ib="\\["+eb+"*("+gb+")"+eb+"*(?:([*^$|!~]?=)"+eb+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+hb+")|)|)"+eb+"*\\]",jb=":("+gb+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ib.replace(3,8)+")*)|.*)\\)|)",kb=RegExp("^"+eb+"+|((?:^|[^\\\\])(?:\\\\.)*)"+eb+"+$","g"),lb=RegExp("^"+eb+"*,"+eb+"*"),mb=RegExp("^"+eb+"*([>+~]|"+eb+")"+eb+"*"),nb=RegExp(eb+"*[+~]"),ob=RegExp("="+eb+"*([^\\]'\"]*)"+eb+"*\\]","g"),pb=RegExp(jb),qb=RegExp("^"+hb+"$"),rb={ID:RegExp("^#("+gb+")"),CLASS:RegExp("^\\.("+gb+")"),TAG:RegExp("^("+gb.replace("w","w*")+")"),ATTR:RegExp("^"+ib),PSEUDO:RegExp("^"+jb),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+eb+"*(even|odd|(([+-]|)(\\d*)n|)"+eb+"*(?:([+-]|)"+eb+"*(\\d+)|))"+eb+"*\\)|)","i"),bool:RegExp("^(?:"+db+")$","i"),needsContext:RegExp("^"+eb+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+eb+"*((?:-\\d)?\\d*)"+eb+"*\\)|)(?=[^-]|$)","i")},sb=/^[^{]+\{\s*\[native \w/,tb=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ub=/^(?:input|select|textarea|button)$/i,vb=/^h\d$/i,wb=/'|\\/g,xb=RegExp("\\\\([\\da-f]{1,6}"+eb+"?|("+eb+")|.)","ig"),yb=function(a,b,c){var d="0x"+b-65536;return d!==d||c?b:0>d?String.fromCharCode(d+65536):String.fromCharCode(55296|d>>10,56320|1023&d)};try{ab.apply(Z=bb.call(O.childNodes),O.childNodes),Z[O.childNodes.length].nodeType}catch(zb){ab={apply:Z.length?function(a,b){_.apply(a,bb.call(b))}:function(a,b){for(var c=a.length,d=0;a[c++]=b[d++];);a.length=c-1}}}B=c.isXML=function(a){var b=a&&(a.ownerDocument||a).documentElement;return b?"HTML"!==b.nodeName:!1},x=c.support={},F=c.setDocument=function(a){var c=a?a.ownerDocument||a:O,d=c.defaultView;return c!==G&&9===c.nodeType&&c.documentElement?(G=c,H=c.documentElement,I=!B(c),d&&d.attachEvent&&d!==d.top&&d.attachEvent("onbeforeunload",function(){F()}),x.attributes=f(function(a){return a.className="i",!a.getAttribute("className")}),x.getElementsByTagName=f(function(a){return a.appendChild(c.createComment("")),!a.getElementsByTagName("*").length}),x.getElementsByClassName=f(function(a){return a.innerHTML="<div class='a'></div><div class='a i'></div>",a.firstChild.className="i",2===a.getElementsByClassName("i").length}),x.getById=f(function(a){return H.appendChild(a).id=N,!c.getElementsByName||!c.getElementsByName(N).length}),x.getById?(z.find.ID=function(a,b){if(typeof b.getElementById!==W&&I){var c=b.getElementById(a);return c&&c.parentNode?[c]:[]}},z.filter.ID=function(a){var b=a.replace(xb,yb);return function(a){return a.getAttribute("id")===b}}):(delete z.find.ID,z.filter.ID=function(a){var b=a.replace(xb,yb);return function(a){var c=typeof a.getAttributeNode!==W&&a.getAttributeNode("id");return c&&c.value===b}}),z.find.TAG=x.getElementsByTagName?function(a,c){return typeof c.getElementsByTagName!==W?c.getElementsByTagName(a):b}:function(a,b){var c,d=[],e=0,f=b.getElementsByTagName(a);if("*"===a){for(;c=f[e++];)1===c.nodeType&&d.push(c);return d}return f},z.find.CLASS=x.getElementsByClassName&&function(a,c){return typeof c.getElementsByClassName!==W&&I?c.getElementsByClassName(a):b},K=[],J=[],(x.qsa=sb.test(c.querySelectorAll))&&(f(function(a){a.innerHTML="<select><option selected=''></option></select>",a.querySelectorAll("[selected]").length||J.push("\\["+eb+"*(?:value|"+db+")"),a.querySelectorAll(":checked").length||J.push(":checked")}),f(function(a){var b=c.createElement("input");b.setAttribute("type","hidden"),a.appendChild(b).setAttribute("t",""),a.querySelectorAll("[t^='']").length&&J.push("[*^$]="+eb+"*(?:''|\"\")"),a.querySelectorAll(":enabled").length||J.push(":enabled",":disabled"),a.querySelectorAll("*,:x"),J.push(",.*:")})),(x.matchesSelector=sb.test(L=H.webkitMatchesSelector||H.mozMatchesSelector||H.oMatchesSelector||H.msMatchesSelector))&&f(function(a){x.disconnectedMatch=L.call(a,"div"),L.call(a,"[s!='']:x"),K.push("!=",jb)}),J=J.length&&RegExp(J.join("|")),K=K.length&&RegExp(K.join("|")),M=sb.test(H.contains)||H.compareDocumentPosition?function(a,b){var c=9===a.nodeType?a.documentElement:a,d=b&&b.parentNode;return a===d||!(!d||1!==d.nodeType||!(c.contains?c.contains(d):a.compareDocumentPosition&&16&a.compareDocumentPosition(d)))}:function(a,b){if(b)for(;b=b.parentNode;)if(b===a)return!0;return!1},V=H.compareDocumentPosition?function(a,b){if(a===b)return U=!0,0;var d=b.compareDocumentPosition&&a.compareDocumentPosition&&a.compareDocumentPosition(b);return d?1&d||!x.sortDetached&&b.compareDocumentPosition(a)===d?a===c||M(O,a)?-1:b===c||M(O,b)?1:E?cb.call(E,a)-cb.call(E,b):0:4&d?-1:1:a.compareDocumentPosition?-1:1}:function(a,b){var d,e=0,f=a.parentNode,g=b.parentNode,i=[a],j=[b];if(a===b)return U=!0,0;if(!f||!g)return a===c?-1:b===c?1:f?-1:g?1:E?cb.call(E,a)-cb.call(E,b):0;if(f===g)return h(a,b);for(d=a;d=d.parentNode;)i.unshift(d);for(d=b;d=d.parentNode;)j.unshift(d);for(;i[e]===j[e];)e++;return e?h(i[e],j[e]):i[e]===O?-1:j[e]===O?1:0},c):G},c.matches=function(a,b){return c(a,null,null,b)},c.matchesSelector=function(a,b){if((a.ownerDocument||a)!==G&&F(a),b=b.replace(ob,"='$1']"),!(!x.matchesSelector||!I||K&&K.test(b)||J&&J.test(b)))try{var d=L.call(a,b);if(d||x.disconnectedMatch||a.document&&11!==a.document.nodeType)return d}catch(e){}return c(b,G,null,[a]).length>0},c.contains=function(a,b){return(a.ownerDocument||a)!==G&&F(a),M(a,b)},c.attr=function(a,c){(a.ownerDocument||a)!==G&&F(a);var d=z.attrHandle[c.toLowerCase()],e=d&&Y.call(z.attrHandle,c.toLowerCase())?d(a,c,!I):b;return e===b?x.attributes||!I?a.getAttribute(c):(e=a.getAttributeNode(c))&&e.specified?e.value:null:e},c.error=function(a){throw Error("Syntax error, unrecognized expression: "+a)},c.uniqueSort=function(a){var b,c=[],d=0,e=0;if(U=!x.detectDuplicates,E=!x.sortStable&&a.slice(0),a.sort(V),U){for(;b=a[e++];)b===a[e]&&(d=c.push(e));for(;d--;)a.splice(c[d],1)}return a},A=c.getText=function(a){var b,c="",d=0,e=a.nodeType;if(e){if(1===e||9===e||11===e){if("string"==typeof a.textContent)return a.textContent;for(a=a.firstChild;a;a=a.nextSibling)c+=A(a)}else if(3===e||4===e)return a.nodeValue}else for(;b=a[d];d++)c+=A(b);return c},z=c.selectors={cacheLength:50,createPseudo:e,match:rb,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(a){return a[1]=a[1].replace(xb,yb),a[3]=(a[4]||a[5]||"").replace(xb,yb),"~="===a[2]&&(a[3]=" "+a[3]+" "),a.slice(0,4)},CHILD:function(a){return a[1]=a[1].toLowerCase(),"nth"===a[1].slice(0,3)?(a[3]||c.error(a[0]),a[4]=+(a[4]?a[5]+(a[6]||1):2*("even"===a[3]||"odd"===a[3])),a[5]=+(a[7]+a[8]||"odd"===a[3])):a[3]&&c.error(a[0]),a},PSEUDO:function(a){var c,d=!a[5]&&a[2];return rb.CHILD.test(a[0])?null:(a[3]&&a[4]!==b?a[2]=a[4]:d&&pb.test(d)&&(c=m(d,!0))&&(c=d.indexOf(")",d.length-c)-d.length)&&(a[0]=a[0].slice(0,c),a[2]=d.slice(0,c)),a.slice(0,3))}},filter:{TAG:function(a){var b=a.replace(xb,yb).toLowerCase();return"*"===a?function(){return!0}:function(a){return a.nodeName&&a.nodeName.toLowerCase()===b}},CLASS:function(a){var b=R[a+" "];return b||(b=RegExp("(^|"+eb+")"+a+"("+eb+"|$)"))&&R(a,function(a){return b.test("string"==typeof a.className&&a.className||typeof a.getAttribute!==W&&a.getAttribute("class")||"")})},ATTR:function(a,b,d){return function(e){var f=c.attr(e,a);return null==f?"!="===b:b?(f+="","="===b?f===d:"!="===b?f!==d:"^="===b?d&&0===f.indexOf(d):"*="===b?d&&f.indexOf(d)>-1:"$="===b?d&&f.slice(-d.length)===d:"~="===b?(" "+f+" ").indexOf(d)>-1:"|="===b?f===d||f.slice(0,d.length+1)===d+"-":!1):!0}},CHILD:function(a,b,c,d,e){var f="nth"!==a.slice(0,3),g="last"!==a.slice(-4),h="of-type"===b;return 1===d&&0===e?function(a){return!!a.parentNode}:function(b,c,i){var j,k,l,m,n,o,p=f!==g?"nextSibling":"previousSibling",q=b.parentNode,r=h&&b.nodeName.toLowerCase(),s=!i&&!h;if(q){if(f){for(;p;){for(l=b;l=l[p];)if(h?l.nodeName.toLowerCase()===r:1===l.nodeType)return!1;o=p="only"===a&&!o&&"nextSibling"}return!0}if(o=[g?q.firstChild:q.lastChild],g&&s){for(k=q[N]||(q[N]={}),j=k[a]||[],n=j[0]===P&&j[1],m=j[0]===P&&j[2],l=n&&q.childNodes[n];l=++n&&l&&l[p]||(m=n=0)||o.pop();)if(1===l.nodeType&&++m&&l===b){k[a]=[P,n,m];break}}else if(s&&(j=(b[N]||(b[N]={}))[a])&&j[0]===P)m=j[1];else for(;(l=++n&&l&&l[p]||(m=n=0)||o.pop())&&((h?l.nodeName.toLowerCase()!==r:1!==l.nodeType)||!++m||(s&&((l[N]||(l[N]={}))[a]=[P,m]),l!==b)););return m-=e,m===d||0===m%d&&m/d>=0}}},PSEUDO:function(a,b){var d,f=z.pseudos[a]||z.setFilters[a.toLowerCase()]||c.error("unsupported pseudo: "+a);return f[N]?f(b):f.length>1?(d=[a,a,"",b],z.setFilters.hasOwnProperty(a.toLowerCase())?e(function(a,c){for(var d,e=f(a,b),g=e.length;g--;)d=cb.call(a,e[g]),a[d]=!(c[d]=e[g])}):function(a){return f(a,0,d)}):f}},pseudos:{not:e(function(a){var b=[],c=[],d=C(a.replace(kb,"$1"));return d[N]?e(function(a,b,c,e){for(var f,g=d(a,null,e,[]),h=a.length;h--;)(f=g[h])&&(a[h]=!(b[h]=f))
}):function(a,e,f){return b[0]=a,d(b,null,f,c),!c.pop()}}),has:e(function(a){return function(b){return c(a,b).length>0}}),contains:e(function(a){return function(b){return(b.textContent||b.innerText||A(b)).indexOf(a)>-1}}),lang:e(function(a){return qb.test(a||"")||c.error("unsupported lang: "+a),a=a.replace(xb,yb).toLowerCase(),function(b){var c;do if(c=I?b.lang:b.getAttribute("xml:lang")||b.getAttribute("lang"))return c=c.toLowerCase(),c===a||0===c.indexOf(a+"-");while((b=b.parentNode)&&1===b.nodeType);return!1}}),target:function(b){var c=a.location&&a.location.hash;return c&&c.slice(1)===b.id},root:function(a){return a===H},focus:function(a){return a===G.activeElement&&(!G.hasFocus||G.hasFocus())&&!!(a.type||a.href||~a.tabIndex)},enabled:function(a){return a.disabled===!1},disabled:function(a){return a.disabled===!0},checked:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&!!a.checked||"option"===b&&!!a.selected},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},empty:function(a){for(a=a.firstChild;a;a=a.nextSibling)if(a.nodeName>"@"||3===a.nodeType||4===a.nodeType)return!1;return!0},parent:function(a){return!z.pseudos.empty(a)},header:function(a){return vb.test(a.nodeName)},input:function(a){return ub.test(a.nodeName)},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},text:function(a){var b;return"input"===a.nodeName.toLowerCase()&&"text"===a.type&&(null==(b=a.getAttribute("type"))||b.toLowerCase()===a.type)},first:k(function(){return[0]}),last:k(function(a,b){return[b-1]}),eq:k(function(a,b,c){return[0>c?c+b:c]}),even:k(function(a,b){for(var c=0;b>c;c+=2)a.push(c);return a}),odd:k(function(a,b){for(var c=1;b>c;c+=2)a.push(c);return a}),lt:k(function(a,b,c){for(var d=0>c?c+b:c;--d>=0;)a.push(d);return a}),gt:k(function(a,b,c){for(var d=0>c?c+b:c;b>++d;)a.push(d);return a})}},z.pseudos.nth=z.pseudos.eq;for(w in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})z.pseudos[w]=i(w);for(w in{submit:!0,reset:!0})z.pseudos[w]=j(w);l.prototype=z.filters=z.pseudos,z.setFilters=new l,C=c.compile=function(a,b){var c,d=[],e=[],f=T[a+" "];if(!f){for(b||(b=m(a)),c=b.length;c--;)f=s(b[c]),f[N]?d.push(f):e.push(f);f=T(a,t(e,d))}return f},x.sortStable=N.split("").sort(V).join("")===N,x.detectDuplicates=U,F(),x.sortDetached=f(function(a){return 1&a.compareDocumentPosition(G.createElement("div"))}),f(function(a){return a.innerHTML="<a href='#'></a>","#"===a.firstChild.getAttribute("href")})||g("type|href|height|width",function(a,c,d){return d?b:a.getAttribute(c,"type"===c.toLowerCase()?1:2)}),x.attributes&&f(function(a){return a.innerHTML="<input/>",a.firstChild.setAttribute("value",""),""===a.firstChild.getAttribute("value")})||g("value",function(a,c,d){return d||"input"!==a.nodeName.toLowerCase()?b:a.defaultValue}),f(function(a){return null==a.getAttribute("disabled")})||g(db,function(a,c,d){var e;return d?b:(e=a.getAttributeNode(c))&&e.specified?e.value:a[c]===!0?c.toLowerCase():null}),fb.find=c,fb.expr=c.selectors,fb.expr[":"]=fb.expr.pseudos,fb.unique=c.uniqueSort,fb.text=c.getText,fb.isXMLDoc=c.isXML,fb.contains=c.contains}(a);var ob={};fb.Callbacks=function(a){a="string"==typeof a?ob[a]||d(a):fb.extend({},a);var c,e,f,g,h,i,j=[],k=!a.once&&[],l=function(b){for(c=a.memory&&b,e=!0,i=g||0,g=0,h=j.length,f=!0;j&&h>i;i++)if(j[i].apply(b[0],b[1])===!1&&a.stopOnFalse){c=!1;break}f=!1,j&&(k?k.length&&l(k.shift()):c?j=[]:m.disable())},m={add:function(){if(j){var b=j.length;!function d(b){fb.each(b,function(b,c){var e=fb.type(c);"function"===e?a.unique&&m.has(c)||j.push(c):c&&c.length&&"string"!==e&&d(c)})}(arguments),f?h=j.length:c&&(g=b,l(c))}return this},remove:function(){return j&&fb.each(arguments,function(a,b){for(var c;(c=fb.inArray(b,j,c))>-1;)j.splice(c,1),f&&(h>=c&&h--,i>=c&&i--)}),this},has:function(a){return a?fb.inArray(a,j)>-1:!(!j||!j.length)},empty:function(){return j=[],h=0,this},disable:function(){return j=k=c=b,this},disabled:function(){return!j},lock:function(){return k=b,c||m.disable(),this},locked:function(){return!k},fireWith:function(a,b){return!j||e&&!k||(b=b||[],b=[a,b.slice?b.slice():b],f?k.push(b):l(b)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!e}};return m},fb.extend({Deferred:function(a){var b=[["resolve","done",fb.Callbacks("once memory"),"resolved"],["reject","fail",fb.Callbacks("once memory"),"rejected"],["notify","progress",fb.Callbacks("memory")]],c="pending",d={state:function(){return c},always:function(){return e.done(arguments).fail(arguments),this},then:function(){var a=arguments;return fb.Deferred(function(c){fb.each(b,function(b,f){var g=f[0],h=fb.isFunction(a[b])&&a[b];e[f[1]](function(){var a=h&&h.apply(this,arguments);a&&fb.isFunction(a.promise)?a.promise().done(c.resolve).fail(c.reject).progress(c.notify):c[g+"With"](this===d?c.promise():this,h?[a]:arguments)})}),a=null}).promise()},promise:function(a){return null!=a?fb.extend(a,d):d}},e={};return d.pipe=d.then,fb.each(b,function(a,f){var g=f[2],h=f[3];d[f[1]]=g.add,h&&g.add(function(){c=h},b[1^a][2].disable,b[2][2].lock),e[f[0]]=function(){return e[f[0]+"With"](this===e?d:this,arguments),this},e[f[0]+"With"]=g.fireWith}),d.promise(e),a&&a.call(e,e),e},when:function(a){var b,c,d,e=0,f=ab.call(arguments),g=f.length,h=1!==g||a&&fb.isFunction(a.promise)?g:0,i=1===h?a:fb.Deferred(),j=function(a,c,d){return function(e){c[a]=this,d[a]=arguments.length>1?ab.call(arguments):e,d===b?i.notifyWith(c,d):--h||i.resolveWith(c,d)}};if(g>1)for(b=Array(g),c=Array(g),d=Array(g);g>e;e++)f[e]&&fb.isFunction(f[e].promise)?f[e].promise().done(j(e,d,f)).fail(i.reject).progress(j(e,c,b)):--h;return h||i.resolveWith(d,f),i.promise()}}),fb.support=function(b){var c=T.createElement("input"),d=T.createDocumentFragment(),e=T.createElement("div"),f=T.createElement("select"),g=f.appendChild(T.createElement("option"));return c.type?(c.type="checkbox",b.checkOn=""!==c.value,b.optSelected=g.selected,b.reliableMarginRight=!0,b.boxSizingReliable=!0,b.pixelPosition=!1,c.checked=!0,b.noCloneChecked=c.cloneNode(!0).checked,f.disabled=!0,b.optDisabled=!g.disabled,c=T.createElement("input"),c.value="t",c.type="radio",b.radioValue="t"===c.value,c.setAttribute("checked","t"),c.setAttribute("name","t"),d.appendChild(c),b.checkClone=d.cloneNode(!0).cloneNode(!0).lastChild.checked,b.focusinBubbles="onfocusin"in a,e.style.backgroundClip="content-box",e.cloneNode(!0).style.backgroundClip="",b.clearCloneStyle="content-box"===e.style.backgroundClip,fb(function(){var c,d,f="padding:0;margin:0;border:0;display:block;-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box",g=T.getElementsByTagName("body")[0];g&&(c=T.createElement("div"),c.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",g.appendChild(c).appendChild(e),e.innerHTML="",e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%",fb.swap(g,null!=g.style.zoom?{zoom:1}:{},function(){b.boxSizing=4===e.offsetWidth}),a.getComputedStyle&&(b.pixelPosition="1%"!==(a.getComputedStyle(e,null)||{}).top,b.boxSizingReliable="4px"===(a.getComputedStyle(e,null)||{width:"4px"}).width,d=e.appendChild(T.createElement("div")),d.style.cssText=e.style.cssText=f,d.style.marginRight=d.style.width="0",e.style.width="1px",b.reliableMarginRight=!parseFloat((a.getComputedStyle(d,null)||{}).marginRight)),g.removeChild(c))}),b):b}({});var pb,qb,rb=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,sb=/([A-Z])/g;e.uid=1,e.accepts=function(a){return a.nodeType?1===a.nodeType||9===a.nodeType:!0},e.prototype={key:function(a){if(!e.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=e.uid++;try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,fb.extend(a,b)}}return this.cache[c]||(this.cache[c]={}),c},set:function(a,b,c){var d,e=this.key(a),f=this.cache[e];if("string"==typeof b)f[b]=c;else if(fb.isEmptyObject(f))fb.extend(this.cache[e],b);else for(d in b)f[d]=b[d];return f},get:function(a,c){var d=this.cache[this.key(a)];return c===b?d:d[c]},access:function(a,c,d){var e;return c===b||c&&"string"==typeof c&&d===b?(e=this.get(a,c),e!==b?e:this.get(a,fb.camelCase(c))):(this.set(a,c,d),d!==b?d:c)},remove:function(a,c){var d,e,f,g=this.key(a),h=this.cache[g];if(c===b)this.cache[g]={};else{fb.isArray(c)?e=c.concat(c.map(fb.camelCase)):(f=fb.camelCase(c),c in h?e=[c,f]:(e=f,e=e in h?[e]:e.match(hb)||[])),d=e.length;for(;d--;)delete h[e[d]]}},hasData:function(a){return!fb.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}},pb=new e,qb=new e,fb.extend({acceptData:e.accepts,hasData:function(a){return pb.hasData(a)||qb.hasData(a)},data:function(a,b,c){return pb.access(a,b,c)},removeData:function(a,b){pb.remove(a,b)},_data:function(a,b,c){return qb.access(a,b,c)},_removeData:function(a,b){qb.remove(a,b)}}),fb.fn.extend({data:function(a,c){var d,e,g=this[0],h=0,i=null;if(a===b){if(this.length&&(i=pb.get(g),1===g.nodeType&&!qb.get(g,"hasDataAttrs"))){for(d=g.attributes;d.length>h;h++)e=d[h].name,0===e.indexOf("data-")&&(e=fb.camelCase(e.slice(5)),f(g,e,i[e]));qb.set(g,"hasDataAttrs",!0)}return i}return"object"==typeof a?this.each(function(){pb.set(this,a)}):fb.access(this,function(c){var d,e=fb.camelCase(a);if(g&&c===b){if(d=pb.get(g,a),d!==b)return d;if(d=pb.get(g,e),d!==b)return d;if(d=f(g,e,b),d!==b)return d}else this.each(function(){var d=pb.get(this,e);pb.set(this,e,c),-1!==a.indexOf("-")&&d!==b&&pb.set(this,a,c)})},null,c,arguments.length>1,null,!0)},removeData:function(a){return this.each(function(){pb.remove(this,a)})}}),fb.extend({queue:function(a,c,d){var e;return a?(c=(c||"fx")+"queue",e=qb.get(a,c),d&&(!e||fb.isArray(d)?e=qb.access(a,c,fb.makeArray(d)):e.push(d)),e||[]):b},dequeue:function(a,b){b=b||"fx";var c=fb.queue(a,b),d=c.length,e=c.shift(),f=fb._queueHooks(a,b),g=function(){fb.dequeue(a,b)};"inprogress"===e&&(e=c.shift(),d--),e&&("fx"===b&&c.unshift("inprogress"),delete f.stop,e.call(a,g,f)),!d&&f&&f.empty.fire()},_queueHooks:function(a,b){var c=b+"queueHooks";return qb.get(a,c)||qb.access(a,c,{empty:fb.Callbacks("once memory").add(function(){qb.remove(a,[b+"queue",c])})})}}),fb.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),d>arguments.length?fb.queue(this[0],a):c===b?this:this.each(function(){var b=fb.queue(this,a,c);fb._queueHooks(this,a),"fx"===a&&"inprogress"!==b[0]&&fb.dequeue(this,a)})},dequeue:function(a){return this.each(function(){fb.dequeue(this,a)})},delay:function(a,b){return a=fb.fx?fb.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){var d,e=1,f=fb.Deferred(),g=this,h=this.length,i=function(){--e||f.resolveWith(g,[g])};for("string"!=typeof a&&(c=a,a=b),a=a||"fx";h--;)d=qb.get(g[h],a+"queueHooks"),d&&d.empty&&(e++,d.empty.add(i));return i(),f.promise(c)}});var tb,ub,vb=/[\t\r\n\f]/g,wb=/\r/g,xb=/^(?:input|select|textarea|button)$/i;fb.fn.extend({attr:function(a,b){return fb.access(this,fb.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){fb.removeAttr(this,a)})},prop:function(a,b){return fb.access(this,fb.prop,a,b,arguments.length>1)},removeProp:function(a){return this.each(function(){delete this[fb.propFix[a]||a]})},addClass:function(a){var b,c,d,e,f,g=0,h=this.length,i="string"==typeof a&&a;if(fb.isFunction(a))return this.each(function(b){fb(this).addClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(hb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vb," "):" ")){for(f=0;e=b[f++];)0>d.indexOf(" "+e+" ")&&(d+=e+" ");c.className=fb.trim(d)}return this},removeClass:function(a){var b,c,d,e,f,g=0,h=this.length,i=0===arguments.length||"string"==typeof a&&a;if(fb.isFunction(a))return this.each(function(b){fb(this).removeClass(a.call(this,b,this.className))});if(i)for(b=(a||"").match(hb)||[];h>g;g++)if(c=this[g],d=1===c.nodeType&&(c.className?(" "+c.className+" ").replace(vb," "):"")){for(f=0;e=b[f++];)for(;d.indexOf(" "+e+" ")>=0;)d=d.replace(" "+e+" "," ");c.className=a?fb.trim(d):""}return this},toggleClass:function(a,b){var c=typeof a;return"boolean"==typeof b&&"string"===c?b?this.addClass(a):this.removeClass(a):fb.isFunction(a)?this.each(function(c){fb(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var b,d=0,e=fb(this),f=a.match(hb)||[];b=f[d++];)e.hasClass(b)?e.removeClass(b):e.addClass(b);else(c===R||"boolean"===c)&&(this.className&&qb.set(this,"__className__",this.className),this.className=this.className||a===!1?"":qb.get(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(vb," ").indexOf(b)>=0)return!0;return!1},val:function(a){var c,d,e,f=this[0];return arguments.length?(e=fb.isFunction(a),this.each(function(d){var f;1===this.nodeType&&(f=e?a.call(this,d,fb(this).val()):a,null==f?f="":"number"==typeof f?f+="":fb.isArray(f)&&(f=fb.map(f,function(a){return null==a?"":a+""})),c=fb.valHooks[this.type]||fb.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&c.set(this,f,"value")!==b||(this.value=f))})):f?(c=fb.valHooks[f.type]||fb.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,"string"==typeof d?d.replace(wb,""):null==d?"":d)):void 0}}),fb.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){for(var b,c,d=a.options,e=a.selectedIndex,f="select-one"===a.type||0>e,g=f?null:[],h=f?e+1:d.length,i=0>e?h:f?e:0;h>i;i++)if(c=d[i],!(!c.selected&&i!==e||(fb.support.optDisabled?c.disabled:null!==c.getAttribute("disabled"))||c.parentNode.disabled&&fb.nodeName(c.parentNode,"optgroup"))){if(b=fb(c).val(),f)return b;g.push(b)}return g},set:function(a,b){for(var c,d,e=a.options,f=fb.makeArray(b),g=e.length;g--;)d=e[g],(d.selected=fb.inArray(fb(d).val(),f)>=0)&&(c=!0);return c||(a.selectedIndex=-1),f}}},attr:function(a,c,d){var e,f,g=a.nodeType;return a&&3!==g&&8!==g&&2!==g?typeof a.getAttribute===R?fb.prop(a,c,d):(1===g&&fb.isXMLDoc(a)||(c=c.toLowerCase(),e=fb.attrHooks[c]||(fb.expr.match.bool.test(c)?ub:tb)),d===b?e&&"get"in e&&null!==(f=e.get(a,c))?f:(f=fb.find.attr(a,c),null==f?b:f):null!==d?e&&"set"in e&&(f=e.set(a,d,c))!==b?f:(a.setAttribute(c,d+""),d):(fb.removeAttr(a,c),b)):void 0},removeAttr:function(a,b){var c,d,e=0,f=b&&b.match(hb);if(f&&1===a.nodeType)for(;c=f[e++];)d=fb.propFix[c]||c,fb.expr.match.bool.test(c)&&(a[d]=!1),a.removeAttribute(c)},attrHooks:{type:{set:function(a,b){if(!fb.support.radioValue&&"radio"===b&&fb.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(a,c,d){var e,f,g,h=a.nodeType;return a&&3!==h&&8!==h&&2!==h?(g=1!==h||!fb.isXMLDoc(a),g&&(c=fb.propFix[c]||c,f=fb.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]):void 0},propHooks:{tabIndex:{get:function(a){return a.hasAttribute("tabindex")||xb.test(a.nodeName)||a.href?a.tabIndex:-1}}}}),ub={set:function(a,b,c){return b===!1?fb.removeAttr(a,c):a.setAttribute(c,c),c}},fb.each(fb.expr.match.bool.source.match(/\w+/g),function(a,c){var d=fb.expr.attrHandle[c]||fb.find.attr;fb.expr.attrHandle[c]=function(a,c,e){var f=fb.expr.attrHandle[c],g=e?b:(fb.expr.attrHandle[c]=b)!=d(a,c,e)?c.toLowerCase():null;return fb.expr.attrHandle[c]=f,g}}),fb.support.optSelected||(fb.propHooks.selected={get:function(a){var b=a.parentNode;return b&&b.parentNode&&b.parentNode.selectedIndex,null}}),fb.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){fb.propFix[this.toLowerCase()]=this}),fb.each(["radio","checkbox"],function(){fb.valHooks[this]={set:function(a,c){return fb.isArray(c)?a.checked=fb.inArray(fb(a).val(),c)>=0:b}},fb.support.checkOn||(fb.valHooks[this].get=function(a){return null===a.getAttribute("value")?"on":a.value})});var yb=/^key/,zb=/^(?:mouse|contextmenu)|click/,Ab=/^(?:focusinfocus|focusoutblur)$/,Bb=/^([^.]*)(?:\.(.+)|)$/;fb.event={global:{},add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q,r=qb.get(a);if(r){for(d.handler&&(g=d,d=g.handler,f=g.selector),d.guid||(d.guid=fb.guid++),(j=r.events)||(j=r.events={}),(h=r.handle)||(h=r.handle=function(a){return typeof fb===R||a&&fb.event.triggered===a.type?b:fb.event.dispatch.apply(h.elem,arguments)},h.elem=a),c=(c||"").match(hb)||[""],k=c.length;k--;)i=Bb.exec(c[k])||[],o=q=i[1],p=(i[2]||"").split(".").sort(),o&&(m=fb.event.special[o]||{},o=(f?m.delegateType:m.bindType)||o,m=fb.event.special[o]||{},l=fb.extend({type:o,origType:q,data:e,handler:d,guid:d.guid,selector:f,needsContext:f&&fb.expr.match.needsContext.test(f),namespace:p.join(".")},g),(n=j[o])||(n=j[o]=[],n.delegateCount=0,m.setup&&m.setup.call(a,e,p,h)!==!1||a.addEventListener&&a.addEventListener(o,h,!1)),m.add&&(m.add.call(a,l),l.handler.guid||(l.handler.guid=d.guid)),f?n.splice(n.delegateCount++,0,l):n.push(l),fb.event.global[o]=!0);a=null}},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q=qb.hasData(a)&&qb.get(a);if(q&&(i=q.events)){for(b=(b||"").match(hb)||[""],j=b.length;j--;)if(h=Bb.exec(b[j])||[],n=p=h[1],o=(h[2]||"").split(".").sort(),n){for(l=fb.event.special[n]||{},n=(d?l.delegateType:l.bindType)||n,m=i[n]||[],h=h[2]&&RegExp("(^|\\.)"+o.join("\\.(?:.*\\.|)")+"(\\.|$)"),g=f=m.length;f--;)k=m[f],!e&&p!==k.origType||c&&c.guid!==k.guid||h&&!h.test(k.namespace)||d&&d!==k.selector&&("**"!==d||!k.selector)||(m.splice(f,1),k.selector&&m.delegateCount--,l.remove&&l.remove.call(a,k));g&&!m.length&&(l.teardown&&l.teardown.call(a,o,q.handle)!==!1||fb.removeEvent(a,n,q.handle),delete i[n])}else for(n in i)fb.event.remove(a,n+b[j],c,d,!0);fb.isEmptyObject(i)&&(delete q.handle,qb.remove(a,"events"))}},trigger:function(c,d,e,f){var g,h,i,j,k,l,m,n=[e||T],o=db.call(c,"type")?c.type:c,p=db.call(c,"namespace")?c.namespace.split("."):[];if(h=i=e=e||T,3!==e.nodeType&&8!==e.nodeType&&!Ab.test(o+fb.event.triggered)&&(o.indexOf(".")>=0&&(p=o.split("."),o=p.shift(),p.sort()),k=0>o.indexOf(":")&&"on"+o,c=c[fb.expando]?c:new fb.Event(o,"object"==typeof c&&c),c.isTrigger=f?2:3,c.namespace=p.join("."),c.namespace_re=c.namespace?RegExp("(^|\\.)"+p.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,c.result=b,c.target||(c.target=e),d=null==d?[c]:fb.makeArray(d,[c]),m=fb.event.special[o]||{},f||!m.trigger||m.trigger.apply(e,d)!==!1)){if(!f&&!m.noBubble&&!fb.isWindow(e)){for(j=m.delegateType||o,Ab.test(j+o)||(h=h.parentNode);h;h=h.parentNode)n.push(h),i=h;i===(e.ownerDocument||T)&&n.push(i.defaultView||i.parentWindow||a)}for(g=0;(h=n[g++])&&!c.isPropagationStopped();)c.type=g>1?j:m.bindType||o,l=(qb.get(h,"events")||{})[c.type]&&qb.get(h,"handle"),l&&l.apply(h,d),l=k&&h[k],l&&fb.acceptData(h)&&l.apply&&l.apply(h,d)===!1&&c.preventDefault();return c.type=o,f||c.isDefaultPrevented()||m._default&&m._default.apply(n.pop(),d)!==!1||!fb.acceptData(e)||k&&fb.isFunction(e[o])&&!fb.isWindow(e)&&(i=e[k],i&&(e[k]=null),fb.event.triggered=o,e[o](),fb.event.triggered=b,i&&(e[k]=i)),c.result}},dispatch:function(a){a=fb.event.fix(a);var c,d,e,f,g,h=[],i=ab.call(arguments),j=(qb.get(this,"events")||{})[a.type]||[],k=fb.event.special[a.type]||{};if(i[0]=a,a.delegateTarget=this,!k.preDispatch||k.preDispatch.call(this,a)!==!1){for(h=fb.event.handlers.call(this,a,j),c=0;(f=h[c++])&&!a.isPropagationStopped();)for(a.currentTarget=f.elem,d=0;(g=f.handlers[d++])&&!a.isImmediatePropagationStopped();)(!a.namespace_re||a.namespace_re.test(g.namespace))&&(a.handleObj=g,a.data=g.data,e=((fb.event.special[g.origType]||{}).handle||g.handler).apply(f.elem,i),e!==b&&(a.result=e)===!1&&(a.preventDefault(),a.stopPropagation()));return k.postDispatch&&k.postDispatch.call(this,a),a.result}},handlers:function(a,c){var d,e,f,g,h=[],i=c.delegateCount,j=a.target;if(i&&j.nodeType&&(!a.button||"click"!==a.type))for(;j!==this;j=j.parentNode||this)if(j.disabled!==!0||"click"!==a.type){for(e=[],d=0;i>d;d++)g=c[d],f=g.selector+" ",e[f]===b&&(e[f]=g.needsContext?fb(f,this).index(j)>=0:fb.find(f,this,null,[j]).length),e[f]&&e.push(g);e.length&&h.push({elem:j,handlers:e})}return c.length>i&&h.push({elem:this,handlers:c.slice(i)}),h},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button;return null==a.pageX&&null!=c.clientX&&(d=a.target.ownerDocument||T,e=d.documentElement,f=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),a.which||g===b||(a.which=1&g?1:2&g?3:4&g?2:0),a}},fix:function(a){if(a[fb.expando])return a;var b,c,d,e=a.type,f=a,g=this.fixHooks[e];for(g||(this.fixHooks[e]=g=zb.test(e)?this.mouseHooks:yb.test(e)?this.keyHooks:{}),d=g.props?this.props.concat(g.props):this.props,a=new fb.Event(f),b=d.length;b--;)c=d[b],a[c]=f[c];return a.target||(a.target=T),3===a.target.nodeType&&(a.target=a.target.parentNode),g.filter?g.filter(a,f):a},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==i()&&this.focus?(this.focus(),!1):b},delegateType:"focusin"},blur:{trigger:function(){return this===i()&&this.blur?(this.blur(),!1):b},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&fb.nodeName(this,"input")?(this.click(),!1):b},_default:function(a){return fb.nodeName(a.target,"a")}},beforeunload:{postDispatch:function(a){a.result!==b&&(a.originalEvent.returnValue=a.result)}}},simulate:function(a,b,c,d){var e=fb.extend(new fb.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?fb.event.trigger(e,null,b):fb.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},fb.removeEvent=function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)},fb.Event=function(a,c){return this instanceof fb.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.getPreventDefault&&a.getPreventDefault()?g:h):this.type=a,c&&fb.extend(this,c),this.timeStamp=a&&a.timeStamp||fb.now(),this[fb.expando]=!0,b):new fb.Event(a,c)},fb.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var a=this.originalEvent;this.isDefaultPrevented=g,a&&a.preventDefault&&a.preventDefault()},stopPropagation:function(){var a=this.originalEvent;this.isPropagationStopped=g,a&&a.stopPropagation&&a.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=g,this.stopPropagation()}},fb.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){fb.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;return(!e||e!==d&&!fb.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),fb.support.focusinBubbles||fb.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){fb.event.simulate(b,a.target,fb.event.fix(a),!0)};fb.event.special[b]={setup:function(){0===c++&&T.addEventListener(a,d,!0)},teardown:function(){0===--c&&T.removeEventListener(a,d,!0)}}}),fb.fn.extend({on:function(a,c,d,e,f){var g,i;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(i in a)this.on(i,c,d,a[i],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=h;else if(!e)return this;return 1===f&&(g=e,e=function(a){return fb().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=fb.guid++)),this.each(function(){fb.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){var e,f;if(a&&a.preventDefault&&a.handleObj)return e=a.handleObj,fb(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this;if("object"==typeof a){for(f in a)this.off(f,c,a[f]);return this}return(c===!1||"function"==typeof c)&&(d=c,c=b),d===!1&&(d=h),this.each(function(){fb.event.remove(this,a,d,c)})},trigger:function(a,b){return this.each(function(){fb.event.trigger(a,b,this)})},triggerHandler:function(a,c){var d=this[0];return d?fb.event.trigger(a,c,d,!0):b}});var Cb=/^.[^:#\[\.,]*$/,Db=/^(?:parents|prev(?:Until|All))/,Eb=fb.expr.match.needsContext,Fb={children:!0,contents:!0,next:!0,prev:!0};fb.fn.extend({find:function(a){var b,c=[],d=this,e=d.length;if("string"!=typeof a)return this.pushStack(fb(a).filter(function(){for(b=0;e>b;b++)if(fb.contains(d[b],this))return!0}));for(b=0;e>b;b++)fb.find(a,d[b],c);return c=this.pushStack(e>1?fb.unique(c):c),c.selector=this.selector?this.selector+" "+a:a,c},has:function(a){var b=fb(a,this),c=b.length;return this.filter(function(){for(var a=0;c>a;a++)if(fb.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(k(this,a||[],!0))},filter:function(a){return this.pushStack(k(this,a||[],!1))},is:function(a){return!!k(this,"string"==typeof a&&Eb.test(a)?fb(a):a||[],!1).length},closest:function(a,b){for(var c,d=0,e=this.length,f=[],g=Eb.test(a)||"string"!=typeof a?fb(a,b||this.context):0;e>d;d++)for(c=this[d];c&&c!==b;c=c.parentNode)if(11>c.nodeType&&(g?g.index(c)>-1:1===c.nodeType&&fb.find.matchesSelector(c,a))){c=f.push(c);break}return this.pushStack(f.length>1?fb.unique(f):f)},index:function(a){return a?"string"==typeof a?bb.call(fb(a),this[0]):bb.call(this,a.jquery?a[0]:a):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(a,b){var c="string"==typeof a?fb(a,b):fb.makeArray(a&&a.nodeType?[a]:a),d=fb.merge(this.get(),c);return this.pushStack(fb.unique(d))},addBack:function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}}),fb.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return fb.dir(a,"parentNode")},parentsUntil:function(a,b,c){return fb.dir(a,"parentNode",c)},next:function(a){return j(a,"nextSibling")},prev:function(a){return j(a,"previousSibling")},nextAll:function(a){return fb.dir(a,"nextSibling")},prevAll:function(a){return fb.dir(a,"previousSibling")},nextUntil:function(a,b,c){return fb.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return fb.dir(a,"previousSibling",c)},siblings:function(a){return fb.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return fb.sibling(a.firstChild)},contents:function(a){return a.contentDocument||fb.merge([],a.childNodes)}},function(a,b){fb.fn[a]=function(c,d){var e=fb.map(this,b,c);return"Until"!==a.slice(-5)&&(d=c),d&&"string"==typeof d&&(e=fb.filter(d,e)),this.length>1&&(Fb[a]||fb.unique(e),Db.test(a)&&e.reverse()),this.pushStack(e)}}),fb.extend({filter:function(a,b,c){var d=b[0];return c&&(a=":not("+a+")"),1===b.length&&1===d.nodeType?fb.find.matchesSelector(d,a)?[d]:[]:fb.find.matches(a,fb.grep(b,function(a){return 1===a.nodeType}))},dir:function(a,c,d){for(var e=[],f=d!==b;(a=a[c])&&9!==a.nodeType;)if(1===a.nodeType){if(f&&fb(a).is(d))break;e.push(a)}return e},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var Gb=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Hb=/<([\w:]+)/,Ib=/<|&#?\w+;/,Jb=/<(?:script|style|link)/i,Kb=/^(?:checkbox|radio)$/i,Lb=/checked\s*(?:[^=]|=\s*.checked.)/i,Mb=/^$|\/(?:java|ecma)script/i,Nb=/^true\/(.*)/,Ob=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Pb={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};Pb.optgroup=Pb.option,Pb.tbody=Pb.tfoot=Pb.colgroup=Pb.caption=Pb.thead,Pb.th=Pb.td,fb.fn.extend({text:function(a){return fb.access(this,function(a){return a===b?fb.text(this):this.empty().append((this[0]&&this[0].ownerDocument||T).createTextNode(a))},null,a,arguments.length)},append:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=l(this,a);b.appendChild(a)}})},prepend:function(){return this.domManip(arguments,function(a){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var b=l(this,a);b.insertBefore(a,b.firstChild)}})},before:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this)})},after:function(){return this.domManip(arguments,function(a){this.parentNode&&this.parentNode.insertBefore(a,this.nextSibling)})},remove:function(a,b){for(var c,d=a?fb.filter(a,this):this,e=0;null!=(c=d[e]);e++)b||1!==c.nodeType||fb.cleanData(q(c)),c.parentNode&&(b&&fb.contains(c.ownerDocument,c)&&o(q(c,"script")),c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)1===a.nodeType&&(fb.cleanData(q(a,!1)),a.textContent="");return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return fb.clone(this,a,b)})},html:function(a){return fb.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b&&1===c.nodeType)return c.innerHTML;if("string"==typeof a&&!Jb.test(a)&&!Pb[(Hb.exec(a)||["",""])[1].toLowerCase()]){a=a.replace(Gb,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(fb.cleanData(q(c,!1)),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(){var a=fb.map(this,function(a){return[a.nextSibling,a.parentNode]}),b=0;return this.domManip(arguments,function(c){var d=a[b++],e=a[b++];e&&(d&&d.parentNode!==e&&(d=this.nextSibling),fb(this).remove(),e.insertBefore(c,d))},!0),b?this:this.remove()},detach:function(a){return this.remove(a,!0)},domManip:function(a,b,c){a=$.apply([],a);var d,e,f,g,h,i,j=0,k=this.length,l=this,o=k-1,p=a[0],r=fb.isFunction(p);if(r||!(1>=k||"string"!=typeof p||fb.support.checkClone)&&Lb.test(p))return this.each(function(d){var e=l.eq(d);r&&(a[0]=p.call(this,d,e.html())),e.domManip(a,b,c)});if(k&&(d=fb.buildFragment(a,this[0].ownerDocument,!1,!c&&this),e=d.firstChild,1===d.childNodes.length&&(d=e),e)){for(f=fb.map(q(d,"script"),m),g=f.length;k>j;j++)h=d,j!==o&&(h=fb.clone(h,!0,!0),g&&fb.merge(f,q(h,"script"))),b.call(this[j],h,j);if(g)for(i=f[f.length-1].ownerDocument,fb.map(f,n),j=0;g>j;j++)h=f[j],Mb.test(h.type||"")&&!qb.access(h,"globalEval")&&fb.contains(i,h)&&(h.src?fb._evalUrl(h.src):fb.globalEval(h.textContent.replace(Ob,"")))}return this}}),fb.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){fb.fn[a]=function(a){for(var c,d=[],e=fb(a),f=e.length-1,g=0;f>=g;g++)c=g===f?this:this.clone(!0),fb(e[g])[b](c),_.apply(d,c.get());return this.pushStack(d)}}),fb.extend({clone:function(a,b,c){var d,e,f,g,h=a.cloneNode(!0),i=fb.contains(a.ownerDocument,a);if(!(fb.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||fb.isXMLDoc(a)))for(g=q(h),f=q(a),d=0,e=f.length;e>d;d++)r(f[d],g[d]);if(b)if(c)for(f=f||q(a),g=g||q(h),d=0,e=f.length;e>d;d++)p(f[d],g[d]);else p(a,h);return g=q(h,"script"),g.length>0&&o(g,!i&&q(a,"script")),h},buildFragment:function(a,b,c,d){for(var e,f,g,h,i,j,k=0,l=a.length,m=b.createDocumentFragment(),n=[];l>k;k++)if(e=a[k],e||0===e)if("object"===fb.type(e))fb.merge(n,e.nodeType?[e]:e);else if(Ib.test(e)){for(f=f||m.appendChild(b.createElement("div")),g=(Hb.exec(e)||["",""])[1].toLowerCase(),h=Pb[g]||Pb._default,f.innerHTML=h[1]+e.replace(Gb,"<$1></$2>")+h[2],j=h[0];j--;)f=f.lastChild;
fb.merge(n,f.childNodes),f=m.firstChild,f.textContent=""}else n.push(b.createTextNode(e));for(m.textContent="",k=0;e=n[k++];)if((!d||-1===fb.inArray(e,d))&&(i=fb.contains(e.ownerDocument,e),f=q(m.appendChild(e),"script"),i&&o(f),c))for(j=0;e=f[j++];)Mb.test(e.type||"")&&c.push(e);return m},cleanData:function(a){for(var c,d,f,g,h,i,j=fb.event.special,k=0;(d=a[k])!==b;k++){if(e.accepts(d)&&(h=d[qb.expando],h&&(c=qb.cache[h]))){if(f=Object.keys(c.events||{}),f.length)for(i=0;(g=f[i])!==b;i++)j[g]?fb.event.remove(d,g):fb.removeEvent(d,g,c.handle);qb.cache[h]&&delete qb.cache[h]}delete pb.cache[d[pb.expando]]}},_evalUrl:function(a){return fb.ajax({url:a,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),fb.fn.extend({wrapAll:function(a){var b;return fb.isFunction(a)?this.each(function(b){fb(this).wrapAll(a.call(this,b))}):(this[0]&&(b=fb(a,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstElementChild;)a=a.firstElementChild;return a}).append(this)),this)},wrapInner:function(a){return fb.isFunction(a)?this.each(function(b){fb(this).wrapInner(a.call(this,b))}):this.each(function(){var b=fb(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=fb.isFunction(a);return this.each(function(c){fb(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){fb.nodeName(this,"body")||fb(this).replaceWith(this.childNodes)}).end()}});var Qb,Rb,Sb=/^(none|table(?!-c[ea]).+)/,Tb=/^margin/,Ub=RegExp("^("+gb+")(.*)$","i"),Vb=RegExp("^("+gb+")(?!px)[a-z%]+$","i"),Wb=RegExp("^([+-])=("+gb+")","i"),Xb={BODY:"block"},Yb={position:"absolute",visibility:"hidden",display:"block"},Zb={letterSpacing:0,fontWeight:400},$b=["Top","Right","Bottom","Left"],_b=["Webkit","O","Moz","ms"];fb.fn.extend({css:function(a,c){return fb.access(this,function(a,c,d){var e,f,g={},h=0;if(fb.isArray(c)){for(e=u(a),f=c.length;f>h;h++)g[c[h]]=fb.css(a,c[h],!1,e);return g}return d!==b?fb.style(a,c,d):fb.css(a,c)},a,c,arguments.length>1)},show:function(){return v(this,!0)},hide:function(){return v(this)},toggle:function(a){return"boolean"==typeof a?a?this.show():this.hide():this.each(function(){t(this)?fb(this).show():fb(this).hide()})}}),fb.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Qb(a,"opacity");return""===c?"1":c}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h,i=fb.camelCase(c),j=a.style;return c=fb.cssProps[i]||(fb.cssProps[i]=s(j,i)),h=fb.cssHooks[c]||fb.cssHooks[i],d===b?h&&"get"in h&&(f=h.get(a,!1,e))!==b?f:j[c]:(g=typeof d,"string"===g&&(f=Wb.exec(d))&&(d=(f[1]+1)*f[2]+parseFloat(fb.css(a,c)),g="number"),null==d||"number"===g&&isNaN(d)||("number"!==g||fb.cssNumber[i]||(d+="px"),fb.support.clearCloneStyle||""!==d||0!==c.indexOf("background")||(j[c]="inherit"),h&&"set"in h&&(d=h.set(a,d,e))===b||(j[c]=d)),b)}},css:function(a,c,d,e){var f,g,h,i=fb.camelCase(c);return c=fb.cssProps[i]||(fb.cssProps[i]=s(a.style,i)),h=fb.cssHooks[c]||fb.cssHooks[i],h&&"get"in h&&(f=h.get(a,!0,d)),f===b&&(f=Qb(a,c,e)),"normal"===f&&c in Zb&&(f=Zb[c]),""===d||d?(g=parseFloat(f),d===!0||fb.isNumeric(g)?g||0:f):f}}),Qb=function(a,c,d){var e,f,g,h=d||u(a),i=h?h.getPropertyValue(c)||h[c]:b,j=a.style;return h&&(""!==i||fb.contains(a.ownerDocument,a)||(i=fb.style(a,c)),Vb.test(i)&&Tb.test(c)&&(e=j.width,f=j.minWidth,g=j.maxWidth,j.minWidth=j.maxWidth=j.width=i,i=h.width,j.width=e,j.minWidth=f,j.maxWidth=g)),i},fb.each(["height","width"],function(a,c){fb.cssHooks[c]={get:function(a,d,e){return d?0===a.offsetWidth&&Sb.test(fb.css(a,"display"))?fb.swap(a,Yb,function(){return y(a,c,e)}):y(a,c,e):b},set:function(a,b,d){var e=d&&u(a);return w(a,b,d?x(a,c,d,fb.support.boxSizing&&"border-box"===fb.css(a,"boxSizing",!1,e),e):0)}}}),fb(function(){fb.support.reliableMarginRight||(fb.cssHooks.marginRight={get:function(a,c){return c?fb.swap(a,{display:"inline-block"},Qb,[a,"marginRight"]):b}}),!fb.support.pixelPosition&&fb.fn.position&&fb.each(["top","left"],function(a,c){fb.cssHooks[c]={get:function(a,d){return d?(d=Qb(a,c),Vb.test(d)?fb(a).position()[c]+"px":d):b}}})}),fb.expr&&fb.expr.filters&&(fb.expr.filters.hidden=function(a){return 0>=a.offsetWidth&&0>=a.offsetHeight},fb.expr.filters.visible=function(a){return!fb.expr.filters.hidden(a)}),fb.each({margin:"",padding:"",border:"Width"},function(a,b){fb.cssHooks[a+b]={expand:function(c){for(var d=0,e={},f="string"==typeof c?c.split(" "):[c];4>d;d++)e[a+$b[d]+b]=f[d]||f[d-2]||f[0];return e}},Tb.test(a)||(fb.cssHooks[a+b].set=w)});var ac=/%20/g,bc=/\[\]$/,cc=/\r?\n/g,dc=/^(?:submit|button|image|reset|file)$/i,ec=/^(?:input|select|textarea|keygen)/i;fb.fn.extend({serialize:function(){return fb.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var a=fb.prop(this,"elements");return a?fb.makeArray(a):this}).filter(function(){var a=this.type;return this.name&&!fb(this).is(":disabled")&&ec.test(this.nodeName)&&!dc.test(a)&&(this.checked||!Kb.test(a))}).map(function(a,b){var c=fb(this).val();return null==c?null:fb.isArray(c)?fb.map(c,function(a){return{name:b.name,value:a.replace(cc,"\r\n")}}):{name:b.name,value:c.replace(cc,"\r\n")}}).get()}}),fb.param=function(a,c){var d,e=[],f=function(a,b){b=fb.isFunction(b)?b():null==b?"":b,e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=fb.ajaxSettings&&fb.ajaxSettings.traditional),fb.isArray(a)||a.jquery&&!fb.isPlainObject(a))fb.each(a,function(){f(this.name,this.value)});else for(d in a)B(d,a[d],c,f);return e.join("&").replace(ac,"+")},fb.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){fb.fn[b]=function(a,c){return arguments.length>0?this.on(b,null,a,c):this.trigger(b)}}),fb.fn.extend({hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1===arguments.length?this.off(a,"**"):this.off(b,a||"**",c)}});var fc,gc,hc=fb.now(),ic=/\?/,jc=/#.*$/,kc=/([?&])_=[^&]*/,lc=/^(.*?):[ \t]*([^\r\n]*)$/gm,mc=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,nc=/^(?:GET|HEAD)$/,oc=/^\/\//,pc=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,qc=fb.fn.load,rc={},sc={},tc="*/".concat("*");try{gc=S.href}catch(uc){gc=T.createElement("a"),gc.href="",gc=gc.href}fc=pc.exec(gc.toLowerCase())||[],fb.fn.load=function(a,c,d){if("string"!=typeof a&&qc)return qc.apply(this,arguments);var e,f,g,h=this,i=a.indexOf(" ");return i>=0&&(e=a.slice(i),a=a.slice(0,i)),fb.isFunction(c)?(d=c,c=b):c&&"object"==typeof c&&(f="POST"),h.length>0&&fb.ajax({url:a,type:f,dataType:"html",data:c}).done(function(a){g=arguments,h.html(e?fb("<div>").append(fb.parseHTML(a)).find(e):a)}).complete(d&&function(a,b){h.each(d,g||[a.responseText,b,a])}),this},fb.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(a,b){fb.fn[b]=function(a){return this.on(b,a)}}),fb.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gc,type:"GET",isLocal:mc.test(fc[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":tc,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":fb.parseJSON,"text xml":fb.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(a,b){return b?E(E(a,fb.ajaxSettings),b):E(fb.ajaxSettings,a)},ajaxPrefilter:C(rc),ajaxTransport:C(sc),ajax:function(a,c){function d(a,c,d,h){var j,l,s,t,v,x=c;2!==u&&(u=2,i&&clearTimeout(i),e=b,g=h||"",w.readyState=a>0?4:0,j=a>=200&&300>a||304===a,d&&(t=F(m,w,d)),t=G(m,t,w,j),j?(m.ifModified&&(v=w.getResponseHeader("Last-Modified"),v&&(fb.lastModified[f]=v),v=w.getResponseHeader("etag"),v&&(fb.etag[f]=v)),204===a||"HEAD"===m.type?x="nocontent":304===a?x="notmodified":(x=t.state,l=t.data,s=t.error,j=!s)):(s=x,(a||!x)&&(x="error",0>a&&(a=0))),w.status=a,w.statusText=(c||x)+"",j?p.resolveWith(n,[l,x,w]):p.rejectWith(n,[w,x,s]),w.statusCode(r),r=b,k&&o.trigger(j?"ajaxSuccess":"ajaxError",[w,m,j?l:s]),q.fireWith(n,[w,x]),k&&(o.trigger("ajaxComplete",[w,m]),--fb.active||fb.event.trigger("ajaxStop")))}"object"==typeof a&&(c=a,a=b),c=c||{};var e,f,g,h,i,j,k,l,m=fb.ajaxSetup({},c),n=m.context||m,o=m.context&&(n.nodeType||n.jquery)?fb(n):fb.event,p=fb.Deferred(),q=fb.Callbacks("once memory"),r=m.statusCode||{},s={},t={},u=0,v="canceled",w={readyState:0,getResponseHeader:function(a){var b;if(2===u){if(!h)for(h={};b=lc.exec(g);)h[b[1].toLowerCase()]=b[2];b=h[a.toLowerCase()]}return null==b?null:b},getAllResponseHeaders:function(){return 2===u?g:null},setRequestHeader:function(a,b){var c=a.toLowerCase();return u||(a=t[c]=t[c]||a,s[a]=b),this},overrideMimeType:function(a){return u||(m.mimeType=a),this},statusCode:function(a){var b;if(a)if(2>u)for(b in a)r[b]=[r[b],a[b]];else w.always(a[w.status]);return this},abort:function(a){var b=a||v;return e&&e.abort(b),d(0,b),this}};if(p.promise(w).complete=q.add,w.success=w.done,w.error=w.fail,m.url=((a||m.url||gc)+"").replace(jc,"").replace(oc,fc[1]+"//"),m.type=c.method||c.type||m.method||m.type,m.dataTypes=fb.trim(m.dataType||"*").toLowerCase().match(hb)||[""],null==m.crossDomain&&(j=pc.exec(m.url.toLowerCase()),m.crossDomain=!(!j||j[1]===fc[1]&&j[2]===fc[2]&&(j[3]||("http:"===j[1]?"80":"443"))===(fc[3]||("http:"===fc[1]?"80":"443")))),m.data&&m.processData&&"string"!=typeof m.data&&(m.data=fb.param(m.data,m.traditional)),D(rc,m,c,w),2===u)return w;k=m.global,k&&0===fb.active++&&fb.event.trigger("ajaxStart"),m.type=m.type.toUpperCase(),m.hasContent=!nc.test(m.type),f=m.url,m.hasContent||(m.data&&(f=m.url+=(ic.test(f)?"&":"?")+m.data,delete m.data),m.cache===!1&&(m.url=kc.test(f)?f.replace(kc,"$1_="+hc++):f+(ic.test(f)?"&":"?")+"_="+hc++)),m.ifModified&&(fb.lastModified[f]&&w.setRequestHeader("If-Modified-Since",fb.lastModified[f]),fb.etag[f]&&w.setRequestHeader("If-None-Match",fb.etag[f])),(m.data&&m.hasContent&&m.contentType!==!1||c.contentType)&&w.setRequestHeader("Content-Type",m.contentType),w.setRequestHeader("Accept",m.dataTypes[0]&&m.accepts[m.dataTypes[0]]?m.accepts[m.dataTypes[0]]+("*"!==m.dataTypes[0]?", "+tc+"; q=0.01":""):m.accepts["*"]);for(l in m.headers)w.setRequestHeader(l,m.headers[l]);if(m.beforeSend&&(m.beforeSend.call(n,w,m)===!1||2===u))return w.abort();v="abort";for(l in{success:1,error:1,complete:1})w[l](m[l]);if(e=D(sc,m,c,w)){w.readyState=1,k&&o.trigger("ajaxSend",[w,m]),m.async&&m.timeout>0&&(i=setTimeout(function(){w.abort("timeout")},m.timeout));try{u=1,e.send(s,d)}catch(x){if(!(2>u))throw x;d(-1,x)}}else d(-1,"No Transport");return w},getJSON:function(a,b,c){return fb.get(a,b,c,"json")},getScript:function(a,c){return fb.get(a,b,c,"script")}}),fb.each(["get","post"],function(a,c){fb[c]=function(a,d,e,f){return fb.isFunction(d)&&(f=f||e,e=d,d=b),fb.ajax({url:a,type:c,dataType:f,data:d,success:e})}}),fb.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(a){return fb.globalEval(a),a}}}),fb.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET")}),fb.ajaxTransport("script",function(a){if(a.crossDomain){var b,c;return{send:function(d,e){b=fb("<script>").prop({async:!0,charset:a.scriptCharset,src:a.url}).on("load error",c=function(a){b.remove(),c=null,a&&e("error"===a.type?404:200,a.type)}),T.head.appendChild(b[0])},abort:function(){c&&c()}}}});var vc=[],wc=/(=)\?(?=&|$)|\?\?/;fb.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var a=vc.pop()||fb.expando+"_"+hc++;return this[a]=!0,a}}),fb.ajaxPrefilter("json jsonp",function(c,d,e){var f,g,h,i=c.jsonp!==!1&&(wc.test(c.url)?"url":"string"==typeof c.data&&!(c.contentType||"").indexOf("application/x-www-form-urlencoded")&&wc.test(c.data)&&"data");return i||"jsonp"===c.dataTypes[0]?(f=c.jsonpCallback=fb.isFunction(c.jsonpCallback)?c.jsonpCallback():c.jsonpCallback,i?c[i]=c[i].replace(wc,"$1"+f):c.jsonp!==!1&&(c.url+=(ic.test(c.url)?"&":"?")+c.jsonp+"="+f),c.converters["script json"]=function(){return h||fb.error(f+" was not called"),h[0]},c.dataTypes[0]="json",g=a[f],a[f]=function(){h=arguments},e.always(function(){a[f]=g,c[f]&&(c.jsonpCallback=d.jsonpCallback,vc.push(f)),h&&fb.isFunction(g)&&g(h[0]),h=g=b}),"script"):b}),fb.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(a){}};var xc=fb.ajaxSettings.xhr(),yc={0:200,1223:204},zc=0,Ac={};a.ActiveXObject&&fb(a).on("unload",function(){for(var a in Ac)Ac[a]();Ac=b}),fb.support.cors=!!xc&&"withCredentials"in xc,fb.support.ajax=xc=!!xc,fb.ajaxTransport(function(a){var c;return fb.support.cors||xc&&!a.crossDomain?{send:function(d,e){var f,g,h=a.xhr();if(h.open(a.type,a.url,a.async,a.username,a.password),a.xhrFields)for(f in a.xhrFields)h[f]=a.xhrFields[f];a.mimeType&&h.overrideMimeType&&h.overrideMimeType(a.mimeType),a.crossDomain||d["X-Requested-With"]||(d["X-Requested-With"]="XMLHttpRequest");for(f in d)h.setRequestHeader(f,d[f]);c=function(a){return function(){c&&(delete Ac[g],c=h.onload=h.onerror=null,"abort"===a?h.abort():"error"===a?e(h.status||404,h.statusText):e(yc[h.status]||h.status,h.statusText,"string"==typeof h.responseText?{text:h.responseText}:b,h.getAllResponseHeaders()))}},h.onload=c(),h.onerror=c("error"),c=Ac[g=zc++]=c("abort"),h.send(a.hasContent&&a.data||null)},abort:function(){c&&c()}}:b});var Bc,Cc,Dc=/^(?:toggle|show|hide)$/,Ec=RegExp("^(?:([+-])=|)("+gb+")([a-z%]*)$","i"),Fc=/queueHooks$/,Gc=[L],Hc={"*":[function(a,b){var c=this.createTween(a,b),d=c.cur(),e=Ec.exec(b),f=e&&e[3]||(fb.cssNumber[a]?"":"px"),g=(fb.cssNumber[a]||"px"!==f&&+d)&&Ec.exec(fb.css(c.elem,a)),h=1,i=20;if(g&&g[3]!==f){f=f||g[3],e=e||[],g=+d||1;do h=h||".5",g/=h,fb.style(c.elem,a,g+f);while(h!==(h=c.cur()/d)&&1!==h&&--i)}return e&&(g=c.start=+g||+d||0,c.unit=f,c.end=e[1]?g+(e[1]+1)*e[2]:+e[2]),c}]};fb.Animation=fb.extend(J,{tweener:function(a,b){fb.isFunction(a)?(b=a,a=["*"]):a=a.split(" ");for(var c,d=0,e=a.length;e>d;d++)c=a[d],Hc[c]=Hc[c]||[],Hc[c].unshift(b)},prefilter:function(a,b){b?Gc.unshift(a):Gc.push(a)}}),fb.Tween=M,M.prototype={constructor:M,init:function(a,b,c,d,e,f){this.elem=a,this.prop=c,this.easing=e||"swing",this.options=b,this.start=this.now=this.cur(),this.end=d,this.unit=f||(fb.cssNumber[c]?"":"px")},cur:function(){var a=M.propHooks[this.prop];return a&&a.get?a.get(this):M.propHooks._default.get(this)},run:function(a){var b,c=M.propHooks[this.prop];return this.pos=b=this.options.duration?fb.easing[this.easing](a,this.options.duration*a,0,1,this.options.duration):a,this.now=(this.end-this.start)*b+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),c&&c.set?c.set(this):M.propHooks._default.set(this),this}},M.prototype.init.prototype=M.prototype,M.propHooks={_default:{get:function(a){var b;return null==a.elem[a.prop]||a.elem.style&&null!=a.elem.style[a.prop]?(b=fb.css(a.elem,a.prop,""),b&&"auto"!==b?b:0):a.elem[a.prop]},set:function(a){fb.fx.step[a.prop]?fb.fx.step[a.prop](a):a.elem.style&&(null!=a.elem.style[fb.cssProps[a.prop]]||fb.cssHooks[a.prop])?fb.style(a.elem,a.prop,a.now+a.unit):a.elem[a.prop]=a.now}}},M.propHooks.scrollTop=M.propHooks.scrollLeft={set:function(a){a.elem.nodeType&&a.elem.parentNode&&(a.elem[a.prop]=a.now)}},fb.each(["toggle","show","hide"],function(a,b){var c=fb.fn[b];fb.fn[b]=function(a,d,e){return null==a||"boolean"==typeof a?c.apply(this,arguments):this.animate(N(b,!0),a,d,e)}}),fb.fn.extend({fadeTo:function(a,b,c,d){return this.filter(t).css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,d){var e=fb.isEmptyObject(a),f=fb.speed(b,c,d),g=function(){var b=J(this,fb.extend({},a),f);(e||qb.get(this,"finish"))&&b.stop(!0)};return g.finish=g,e||f.queue===!1?this.each(g):this.queue(f.queue,g)},stop:function(a,c,d){var e=function(a){var b=a.stop;delete a.stop,b(d)};return"string"!=typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){var b=!0,c=null!=a&&a+"queueHooks",f=fb.timers,g=qb.get(this);if(c)g[c]&&g[c].stop&&e(g[c]);else for(c in g)g[c]&&g[c].stop&&Fc.test(c)&&e(g[c]);for(c=f.length;c--;)f[c].elem!==this||null!=a&&f[c].queue!==a||(f[c].anim.stop(d),b=!1,f.splice(c,1));(b||!d)&&fb.dequeue(this,a)})},finish:function(a){return a!==!1&&(a=a||"fx"),this.each(function(){var b,c=qb.get(this),d=c[a+"queue"],e=c[a+"queueHooks"],f=fb.timers,g=d?d.length:0;for(c.finish=!0,fb.queue(this,a,[]),e&&e.stop&&e.stop.call(this,!0),b=f.length;b--;)f[b].elem===this&&f[b].queue===a&&(f[b].anim.stop(!0),f.splice(b,1));for(b=0;g>b;b++)d[b]&&d[b].finish&&d[b].finish.call(this);delete c.finish})}}),fb.each({slideDown:N("show"),slideUp:N("hide"),slideToggle:N("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){fb.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),fb.speed=function(a,b,c){var d=a&&"object"==typeof a?fb.extend({},a):{complete:c||!c&&b||fb.isFunction(a)&&a,duration:a,easing:c&&b||b&&!fb.isFunction(b)&&b};return d.duration=fb.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in fb.fx.speeds?fb.fx.speeds[d.duration]:fb.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(){fb.isFunction(d.old)&&d.old.call(this),d.queue&&fb.dequeue(this,d.queue)},d},fb.easing={linear:function(a){return a},swing:function(a){return.5-Math.cos(a*Math.PI)/2}},fb.timers=[],fb.fx=M.prototype.init,fb.fx.tick=function(){var a,c=fb.timers,d=0;for(Bc=fb.now();c.length>d;d++)a=c[d],a()||c[d]!==a||c.splice(d--,1);c.length||fb.fx.stop(),Bc=b},fb.fx.timer=function(a){a()&&fb.timers.push(a)&&fb.fx.start()},fb.fx.interval=13,fb.fx.start=function(){Cc||(Cc=setInterval(fb.fx.tick,fb.fx.interval))},fb.fx.stop=function(){clearInterval(Cc),Cc=null},fb.fx.speeds={slow:600,fast:200,_default:400},fb.fx.step={},fb.expr&&fb.expr.filters&&(fb.expr.filters.animated=function(a){return fb.grep(fb.timers,function(b){return a===b.elem}).length}),fb.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){fb.offset.setOffset(this,a,b)});var c,d,e=this[0],f={top:0,left:0},g=e&&e.ownerDocument;return g?(c=g.documentElement,fb.contains(c,e)?(typeof e.getBoundingClientRect!==R&&(f=e.getBoundingClientRect()),d=O(g),{top:f.top+d.pageYOffset-c.clientTop,left:f.left+d.pageXOffset-c.clientLeft}):f):void 0},fb.offset={setOffset:function(a,b,c){var d,e,f,g,h,i,j,k=fb.css(a,"position"),l=fb(a),m={};"static"===k&&(a.style.position="relative"),h=l.offset(),f=fb.css(a,"top"),i=fb.css(a,"left"),j=("absolute"===k||"fixed"===k)&&(f+i).indexOf("auto")>-1,j?(d=l.position(),g=d.top,e=d.left):(g=parseFloat(f)||0,e=parseFloat(i)||0),fb.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(m.top=b.top-h.top+g),null!=b.left&&(m.left=b.left-h.left+e),"using"in b?b.using.call(a,m):l.css(m)}},fb.fn.extend({position:function(){if(this[0]){var a,b,c=this[0],d={top:0,left:0};return"fixed"===fb.css(c,"position")?b=c.getBoundingClientRect():(a=this.offsetParent(),b=this.offset(),fb.nodeName(a[0],"html")||(d=a.offset()),d.top+=fb.css(a[0],"borderTopWidth",!0),d.left+=fb.css(a[0],"borderLeftWidth",!0)),{top:b.top-d.top-fb.css(c,"marginTop",!0),left:b.left-d.left-fb.css(c,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||U;a&&!fb.nodeName(a,"html")&&"static"===fb.css(a,"position");)a=a.offsetParent;return a||U})}}),fb.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(c,d){var e="pageYOffset"===d;fb.fn[c]=function(f){return fb.access(this,function(c,f,g){var h=O(c);return g===b?h?h[d]:c[f]:(h?h.scrollTo(e?a.pageXOffset:g,e?g:a.pageYOffset):c[f]=g,b)},c,f,arguments.length,null)}}),fb.each({Height:"height",Width:"width"},function(a,c){fb.each({padding:"inner"+a,content:c,"":"outer"+a},function(d,e){fb.fn[e]=function(e,f){var g=arguments.length&&(d||"boolean"!=typeof e),h=d||(e===!0||f===!0?"margin":"border");return fb.access(this,function(c,d,e){var f;return fb.isWindow(c)?c.document.documentElement["client"+a]:9===c.nodeType?(f=c.documentElement,Math.max(c.body["scroll"+a],f["scroll"+a],c.body["offset"+a],f["offset"+a],f["client"+a])):e===b?fb.css(c,d,h):fb.style(c,d,e,h)},c,g?e:b,g,null)}})}),fb.fn.size=function(){return this.length},fb.fn.andSelf=fb.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=fb:"function"==typeof define&&define.amd&&define("jquery",[],function(){return fb}),"object"==typeof a&&"object"==typeof a.document&&(a.jQuery=a.$=fb)}(window),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,b.href&&f&&"map"===e.nodeName.toLowerCase()?(g=a("img[usemap=#"+f+"]")[0],!!g&&d(g)):!1):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.3",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(d=f.css("position"),("absolute"===d||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;e.length>d;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(f){}e(b)},a.widget=function(c,d,e){var f,g,h,i,j={},k=c.split(".")[0];c=c.split(".")[1],f=k+"-"+c,e||(e=d,d=a.Widget),a.expr[":"][f.toLowerCase()]=function(b){return!!a.data(b,f)},a[k]=a[k]||{},g=a[k][c],h=a[k][c]=function(a,c){return this._createWidget?(arguments.length&&this._createWidget(a,c),b):new h(a,c)},a.extend(h,g,{version:e.version,_proto:a.extend({},e),_childConstructors:[]}),i=new d,i.options=a.widget.extend({},i.options),a.each(e,function(c,e){return a.isFunction(e)?(j[c]=function(){var a=function(){return d.prototype[c].apply(this,arguments)},b=function(a){return d.prototype[c].apply(this,a)};return function(){var c,d=this._super,f=this._superApply;return this._super=a,this._superApply=b,c=e.apply(this,arguments),this._super=d,this._superApply=f,c}}(),b):(j[c]=e,b)}),h.prototype=a.widget.extend(i,{widgetEventPrefix:g?i.widgetEventPrefix:c},j,{constructor:h,namespace:k,widgetName:c,widgetFullName:f}),g?(a.each(g._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,h,c._proto)}),delete g._childConstructors):d._childConstructors.push(h),a.widget.bridge(c,h)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;i>h;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(c[e]=a.isPlainObject(f)?a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):b):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; "+"attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;e.length-1>g;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),d===b)return f[c]===b?null:f[c];f[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(c,d,e){var f,g=this;"boolean"!=typeof c&&(e=d,d=c,c=!1),e?(d=f=a(d),this.bindings=this.bindings.add(d)):(e=d,d=this.element,f=this.widget()),a.each(e,function(e,h){function i(){return c||g.options.disabled!==!0&&!a(this).hasClass("ui-state-disabled")?("string"==typeof h?g[h]:h).apply(g,arguments):b}"string"!=typeof h&&(i.guid=h.guid=h.guid||i.guid||a.guid++);var j=e.match(/^(\w+)\s*(.*)$/),k=j[1]+g.eventNamespace,l=j[2];l?f.delegate(l,k,i):d.bind(k,i)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&g.apply(this.element[0],[c].concat(d))===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?e===!0||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a){var b=!1;a(document).mouseup(function(){b=!1}),a.widget("ui.mouse",{version:"1.10.3",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){return!0===a.data(c.target,b.widgetName+".preventClickEvent")?(a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1):void 0
}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(c){if(!b){this._mouseStarted&&this._mouseUp(c),this._mouseDownEvent=c;var d=this,e=1===c.which,f="string"==typeof this.options.cancel&&c.target.nodeName?a(c.target).closest(this.options.cancel).length:!1;return e&&!f&&this._mouseCapture(c)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(c)&&this._mouseDelayMet(c)&&(this._mouseStarted=this._mouseStart(c)!==!1,!this._mouseStarted)?(c.preventDefault(),!0):(!0===a.data(c.target,this.widgetName+".preventClickEvent")&&a.removeData(c.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),c.preventDefault(),b=!0,!0)):!0}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||9>document.documentMode)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a){a.widget("ui.draggable",a.ui.mouse,{version:"1.10.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(b){var c=this.options;return this.helper||c.disabled||a(b.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(b),this.handle?(a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(b){var c=this.options;return this.helper=this._createHelper(b),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),this._setContainment(),this._trigger("start",b)===!1?(this._clear(),!1):(this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b),!0)},_mouseDrag:function(b,c){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1)return this._mouseUp({}),!1;this.position=d.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),!1},_mouseStop:function(b){var c=this,d=!1;return a.ui.ddmanager&&!this.options.dropBehaviour&&(d=a.ui.ddmanager.drop(this,b)),this.dropped&&(d=this.dropped,this.dropped=!1),"original"!==this.options.helper||a.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!d||"valid"===this.options.revert&&d||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,d)?a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){c._trigger("stop",b)!==!1&&c._clear()}):this._trigger("stop",b)!==!1&&this._clear(),!1):!1},_mouseUp:function(b){return a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b),a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(b){return this.options.handle?!!a(b.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):"clone"===c.helper?this.element.clone().removeAttr("id"):this.element;return d.parents("body").length||d.appendTo("parent"===c.appendTo?this.element[0].parentNode:c.appendTo),d[0]===this.element[0]||/(fixed|absolute)/.test(d.css("position"))||d.css("position","absolute"),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;return e.containment?"window"===e.containment?(this.containment=[a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,a(window).scrollLeft()+a(window).width()-this.helperProportions.width-this.margins.left,a(window).scrollTop()+(a(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):"document"===e.containment?(this.containment=[0,0,a(document).width()-this.helperProportions.width-this.margins.left,(a(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top],void 0):e.containment.constructor===Array?(this.containment=e.containment,void 0):("parent"===e.containment&&(e.containment=this.helper[0].parentNode),c=a(e.containment),d=c[0],d&&(b="hidden"!==c.css("overflow"),this.containment=[(parseInt(c.css("borderLeftWidth"),10)||0)+(parseInt(c.css("paddingLeft"),10)||0),(parseInt(c.css("borderTopWidth"),10)||0)+(parseInt(c.css("paddingTop"),10)||0),(b?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(c.css("borderRightWidth"),10)||0)-(parseInt(c.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(b?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(c.css("borderBottomWidth"),10)||0)-(parseInt(c.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c),void 0):(this.containment=null,void 0)},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:e.scrollTop(),left:e.scrollLeft()}),{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*d}},_generatePosition:function(b){var c,d,e,f,g=this.options,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=b.pageX,j=b.pageY;return this.offset.scroll||(this.offset.scroll={top:h.scrollTop(),left:h.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(d=this.relative_container.offset(),c=[this.containment[0]+d.left,this.containment[1]+d.top,this.containment[2]+d.left,this.containment[3]+d.top]):c=this.containment,b.pageX-this.offset.click.left<c[0]&&(i=c[0]+this.offset.click.left),b.pageY-this.offset.click.top<c[1]&&(j=c[1]+this.offset.click.top),b.pageX-this.offset.click.left>c[2]&&(i=c[2]+this.offset.click.left),b.pageY-this.offset.click.top>c[3]&&(j=c[3]+this.offset.click.top)),g.grid&&(e=g.grid[1]?this.originalPageY+Math.round((j-this.originalPageY)/g.grid[1])*g.grid[1]:this.originalPageY,j=c?e-this.offset.click.top>=c[1]||e-this.offset.click.top>c[3]?e:e-this.offset.click.top>=c[1]?e-g.grid[1]:e+g.grid[1]:e,f=g.grid[0]?this.originalPageX+Math.round((i-this.originalPageX)/g.grid[0])*g.grid[0]:this.originalPageX,i=c?f-this.offset.click.left>=c[0]||f-this.offset.click.left>c[2]?f:f-this.offset.click.left>=c[0]?f-g.grid[0]:f+g.grid[0]:f)),{top:j-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){return d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),"drag"===b&&(this.positionAbs=this._convertPositionTo("absolute")),a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("ui-draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"ui-sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("ui-draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,"original"===d.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("ui-draggable"),e=this;a.each(d.sortables,function(){var f=!1,g=this;this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(f=!0,a.each(d.sortables,function(){return this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this!==g&&this.instance._intersectsWith(this.instance.containerCache)&&a.contains(g.instance.element[0],this.instance.element[0])&&(f=!1),f})),f?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(){var b=a("body"),c=a(this).data("ui-draggable").options;b.css("cursor")&&(c._cursor=b.css("cursor")),b.css("cursor",c.cursor)},stop:function(){var b=a(this).data("ui-draggable").options;b._cursor&&a("body").css("cursor",b._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(){var b=a(this).data("ui-draggable");b.scrollParent[0]!==document&&"HTML"!==b.scrollParent[0].tagName&&(b.overflowOffset=b.scrollParent.offset())},drag:function(b){var c=a(this).data("ui-draggable"),d=c.options,e=!1;c.scrollParent[0]!==document&&"HTML"!==c.scrollParent[0].tagName?(d.axis&&"x"===d.axis||(c.overflowOffset.top+c.scrollParent[0].offsetHeight-b.pageY<d.scrollSensitivity?c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop+d.scrollSpeed:b.pageY-c.overflowOffset.top<d.scrollSensitivity&&(c.scrollParent[0].scrollTop=e=c.scrollParent[0].scrollTop-d.scrollSpeed)),d.axis&&"y"===d.axis||(c.overflowOffset.left+c.scrollParent[0].offsetWidth-b.pageX<d.scrollSensitivity?c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft+d.scrollSpeed:b.pageX-c.overflowOffset.left<d.scrollSensitivity&&(c.scrollParent[0].scrollLeft=e=c.scrollParent[0].scrollLeft-d.scrollSpeed))):(d.axis&&"x"===d.axis||(b.pageY-a(document).scrollTop()<d.scrollSensitivity?e=a(document).scrollTop(a(document).scrollTop()-d.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<d.scrollSensitivity&&(e=a(document).scrollTop(a(document).scrollTop()+d.scrollSpeed))),d.axis&&"y"===d.axis||(b.pageX-a(document).scrollLeft()<d.scrollSensitivity?e=a(document).scrollLeft(a(document).scrollLeft()-d.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<d.scrollSensitivity&&(e=a(document).scrollLeft(a(document).scrollLeft()+d.scrollSpeed)))),e!==!1&&a.ui.ddmanager&&!d.dropBehaviour&&a.ui.ddmanager.prepareOffsets(c,b)}}),a.ui.plugin.add("draggable","snap",{start:function(){var b=a(this).data("ui-draggable"),c=b.options;b.snapElements=[],a(c.snap.constructor!==String?c.snap.items||":data(ui-draggable)":c.snap).each(function(){var c=a(this),d=c.offset();this!==b.element[0]&&b.snapElements.push({item:this,width:c.outerWidth(),height:c.outerHeight(),top:d.top,left:d.left})})},drag:function(b,c){var d,e,f,g,h,i,j,k,l,m,n=a(this).data("ui-draggable"),o=n.options,p=o.snapTolerance,q=c.offset.left,r=q+n.helperProportions.width,s=c.offset.top,t=s+n.helperProportions.height;for(l=n.snapElements.length-1;l>=0;l--)h=n.snapElements[l].left,i=h+n.snapElements[l].width,j=n.snapElements[l].top,k=j+n.snapElements[l].height,h-p>r||q>i+p||j-p>t||s>k+p||!a.contains(n.snapElements[l].item.ownerDocument,n.snapElements[l].item)?(n.snapElements[l].snapping&&n.options.snap.release&&n.options.snap.release.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=!1):("inner"!==o.snapMode&&(d=p>=Math.abs(j-t),e=p>=Math.abs(k-s),f=p>=Math.abs(h-r),g=p>=Math.abs(i-q),d&&(c.position.top=n._convertPositionTo("relative",{top:j-n.helperProportions.height,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h-n.helperProportions.width}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i}).left-n.margins.left)),m=d||e||f||g,"outer"!==o.snapMode&&(d=p>=Math.abs(j-s),e=p>=Math.abs(k-t),f=p>=Math.abs(h-q),g=p>=Math.abs(i-r),d&&(c.position.top=n._convertPositionTo("relative",{top:j,left:0}).top-n.margins.top),e&&(c.position.top=n._convertPositionTo("relative",{top:k-n.helperProportions.height,left:0}).top-n.margins.top),f&&(c.position.left=n._convertPositionTo("relative",{top:0,left:h}).left-n.margins.left),g&&(c.position.left=n._convertPositionTo("relative",{top:0,left:i-n.helperProportions.width}).left-n.margins.left)),!n.snapElements[l].snapping&&(d||e||f||g||m)&&n.options.snap.snap&&n.options.snap.snap.call(n.element,b,a.extend(n._uiHash(),{snapItem:n.snapElements[l].item})),n.snapElements[l].snapping=d||e||f||g||m)}}),a.ui.plugin.add("draggable","stack",{start:function(){var b,c=this.data("ui-draggable").options,d=a.makeArray(a(c.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});d.length&&(b=parseInt(a(d[0]).css("zIndex"),10)||0,a(d).each(function(c){a(this).css("zIndex",b+c)}),this.css("zIndex",b+d.length))}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("ui-draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("ui-draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})}(jQuery),function(a){function b(a,b,c){return a>b&&b+c>a}a.widget("ui.droppable",{version:"1.10.3",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var b=this.options,c=b.accept;this.isover=!1,this.isout=!0,this.accept=a.isFunction(c)?c:function(a){return a.is(c)},this.proportions={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight},a.ui.ddmanager.droppables[b.scope]=a.ui.ddmanager.droppables[b.scope]||[],a.ui.ddmanager.droppables[b.scope].push(this),b.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var b=0,c=a.ui.ddmanager.droppables[this.options.scope];c.length>b;b++)c[b]===this&&c.splice(b,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(b,c){"accept"===b&&(this.accept=a.isFunction(c)?c:function(a){return a.is(c)}),a.Widget.prototype._setOption.apply(this,arguments)},_activate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),c&&this._trigger("activate",b,this.ui(c))},_deactivate:function(b){var c=a.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),c&&this._trigger("deactivate",b,this.ui(c))},_over:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",b,this.ui(c)))},_out:function(b){var c=a.ui.ddmanager.current;c&&(c.currentItem||c.element)[0]!==this.element[0]&&this.accept.call(this.element[0],c.currentItem||c.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",b,this.ui(c)))},_drop:function(b,c){var d=c||a.ui.ddmanager.current,e=!1;return d&&(d.currentItem||d.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var b=a.data(this,"ui-droppable");return b.options.greedy&&!b.options.disabled&&b.options.scope===d.options.scope&&b.accept.call(b.element[0],d.currentItem||d.element)&&a.ui.intersect(d,a.extend(b,{offset:b.element.offset()}),b.options.tolerance)?(e=!0,!1):void 0}),e?!1:this.accept.call(this.element[0],d.currentItem||d.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",b,this.ui(d)),this.element):!1):!1},ui:function(a){return{draggable:a.currentItem||a.element,helper:a.helper,position:a.position,offset:a.positionAbs}}}),a.ui.intersect=function(a,c,d){if(!c.offset)return!1;var e,f,g=(a.positionAbs||a.position.absolute).left,h=g+a.helperProportions.width,i=(a.positionAbs||a.position.absolute).top,j=i+a.helperProportions.height,k=c.offset.left,l=k+c.proportions.width,m=c.offset.top,n=m+c.proportions.height;switch(d){case"fit":return g>=k&&l>=h&&i>=m&&n>=j;case"intersect":return g+a.helperProportions.width/2>k&&l>h-a.helperProportions.width/2&&i+a.helperProportions.height/2>m&&n>j-a.helperProportions.height/2;case"pointer":return e=(a.positionAbs||a.position.absolute).left+(a.clickOffset||a.offset.click).left,f=(a.positionAbs||a.position.absolute).top+(a.clickOffset||a.offset.click).top,b(f,m,c.proportions.height)&&b(e,k,c.proportions.width);case"touch":return(i>=m&&n>=i||j>=m&&n>=j||m>i&&j>n)&&(g>=k&&l>=g||h>=k&&l>=h||k>g&&h>l);default:return!1}},a.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(b,c){var d,e,f=a.ui.ddmanager.droppables[b.options.scope]||[],g=c?c.type:null,h=(b.currentItem||b.element).find(":data(ui-droppable)").addBack();a:for(d=0;f.length>d;d++)if(!(f[d].options.disabled||b&&!f[d].accept.call(f[d].element[0],b.currentItem||b.element))){for(e=0;h.length>e;e++)if(h[e]===f[d].element[0]){f[d].proportions.height=0;continue a}f[d].visible="none"!==f[d].element.css("display"),f[d].visible&&("mousedown"===g&&f[d]._activate.call(f[d],c),f[d].offset=f[d].element.offset(),f[d].proportions={width:f[d].element[0].offsetWidth,height:f[d].element[0].offsetHeight})}},drop:function(b,c){var d=!1;return a.each((a.ui.ddmanager.droppables[b.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&a.ui.intersect(b,this,this.options.tolerance)&&(d=this._drop.call(this,c)||d),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],b.currentItem||b.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,c)))}),d},dragStart:function(b,c){b.element.parentsUntil("body").bind("scroll.droppable",function(){b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)})},drag:function(b,c){b.options.refreshPositions&&a.ui.ddmanager.prepareOffsets(b,c),a.each(a.ui.ddmanager.droppables[b.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var d,e,f,g=a.ui.intersect(b,this,this.options.tolerance),h=!g&&this.isover?"isout":g&&!this.isover?"isover":null;h&&(this.options.greedy&&(e=this.options.scope,f=this.element.parents(":data(ui-droppable)").filter(function(){return a.data(this,"ui-droppable").options.scope===e}),f.length&&(d=a.data(f[0],"ui-droppable"),d.greedyChild="isover"===h)),d&&"isover"===h&&(d.isover=!1,d.isout=!0,d._out.call(d,c)),this[h]=!0,this["isout"===h?"isover":"isout"]=!1,this["isover"===h?"_over":"_out"].call(this,c),d&&"isout"===h&&(d.isout=!1,d.isover=!0,d._over.call(d,c)))}})},dragStop:function(b,c){b.element.parentsUntil("body").unbind("scroll.droppable"),b.options.refreshPositions||a.ui.ddmanager.prepareOffsets(b,c)}}}(jQuery),!function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=Function.prototype,g=d.push,h=d.slice,i=d.concat,j=e.toString,k=e.hasOwnProperty,l=d.forEach,m=d.map,n=d.reduce,o=d.reduceRight,p=d.filter,q=d.every,r=d.some,s=d.indexOf,t=d.lastIndexOf,u=Array.isArray,v=Object.keys,w=f.bind,x=function(a){return a instanceof x?a:this instanceof x?(this._wrapped=a,void 0):new x(a)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=x),exports._=x):a._=x,x.VERSION="1.5.0";var y=x.each=x.forEach=function(a,b,d){if(null!=a)if(l&&a.forEach===l)a.forEach(b,d);else if(a.length===+a.length){for(var e=0,f=a.length;f>e;e++)if(b.call(d,a[e],e,a)===c)return}else for(var g in a)if(x.has(a,g)&&b.call(d,a[g],g,a)===c)return};x.map=x.collect=function(a,b,c){var d=[];return null==a?d:m&&a.map===m?a.map(b,c):(y(a,function(a,e,f){d.push(b.call(c,a,e,f))}),d)};var z="Reduce of empty array with no initial value";x.reduce=x.foldl=x.inject=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),n&&a.reduce===n)return d&&(b=x.bind(b,d)),e?a.reduce(b,c):a.reduce(b);if(y(a,function(a,f,g){e?c=b.call(d,c,a,f,g):(c=a,e=!0)}),!e)throw new TypeError(z);return c},x.reduceRight=x.foldr=function(a,b,c,d){var e=arguments.length>2;if(null==a&&(a=[]),o&&a.reduceRight===o)return d&&(b=x.bind(b,d)),e?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f){var g=x.keys(a);f=g.length}if(y(a,function(h,i,j){i=g?g[--f]:--f,e?c=b.call(d,c,a[i],i,j):(c=a[i],e=!0)}),!e)throw new TypeError(z);return c},x.find=x.detect=function(a,b,c){var d;return A(a,function(a,e,f){return b.call(c,a,e,f)?(d=a,!0):void 0}),d},x.filter=x.select=function(a,b,c){var d=[];return null==a?d:p&&a.filter===p?a.filter(b,c):(y(a,function(a,e,f){b.call(c,a,e,f)&&d.push(a)}),d)},x.reject=function(a,b,c){return x.filter(a,function(a,d,e){return!b.call(c,a,d,e)},c)},x.every=x.all=function(a,b,d){b||(b=x.identity);var e=!0;return null==a?e:q&&a.every===q?a.every(b,d):(y(a,function(a,f,g){return(e=e&&b.call(d,a,f,g))?void 0:c}),!!e)};var A=x.some=x.any=function(a,b,d){b||(b=x.identity);var e=!1;return null==a?e:r&&a.some===r?a.some(b,d):(y(a,function(a,f,g){return e||(e=b.call(d,a,f,g))?c:void 0}),!!e)};x.contains=x.include=function(a,b){return null==a?!1:s&&a.indexOf===s?-1!=a.indexOf(b):A(a,function(a){return a===b})},x.invoke=function(a,b){var c=h.call(arguments,2),d=x.isFunction(b);return x.map(a,function(a){return(d?b:a[b]).apply(a,c)})},x.pluck=function(a,b){return x.map(a,function(a){return a[b]})},x.where=function(a,b,c){return x.isEmpty(b)?c?void 0:[]:x[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})},x.findWhere=function(a,b){return x.where(a,b,!0)},x.max=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.max.apply(Math,a);if(!b&&x.isEmpty(a))return-1/0;var d={computed:-1/0,value:-1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g>d.computed&&(d={value:a,computed:g})}),d.value},x.min=function(a,b,c){if(!b&&x.isArray(a)&&a[0]===+a[0]&&a.length<65535)return Math.min.apply(Math,a);if(!b&&x.isEmpty(a))return 1/0;var d={computed:1/0,value:1/0};return y(a,function(a,e,f){var g=b?b.call(c,a,e,f):a;g<d.computed&&(d={value:a,computed:g})}),d.value},x.shuffle=function(a){var b,c=0,d=[];return y(a,function(a){b=x.random(c++),d[c-1]=d[b],d[b]=a}),d};var B=function(a){return x.isFunction(a)?a:function(b){return b[a]}};x.sortBy=function(a,b,c){var d=B(b);return x.pluck(x.map(a,function(a,b,e){return{value:a,index:b,criteria:d.call(c,a,b,e)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(d>c||void 0===d)return-1}return a.index<b.index?-1:1}),"value")};var C=function(a,b,c,d){var e={},f=B(null==b?x.identity:b);return y(a,function(b,g){var h=f.call(c,b,g,a);d(e,h,b)}),e};x.groupBy=function(a,b,c){return C(a,b,c,function(a,b,c){(x.has(a,b)?a[b]:a[b]=[]).push(c)})},x.countBy=function(a,b,c){return C(a,b,c,function(a,b){x.has(a,b)||(a[b]=0),a[b]++})},x.sortedIndex=function(a,b,c,d){c=null==c?x.identity:B(c);for(var e=c.call(d,b),f=0,g=a.length;g>f;){var h=f+g>>>1;c.call(d,a[h])<e?f=h+1:g=h}return f},x.toArray=function(a){return a?x.isArray(a)?h.call(a):a.length===+a.length?x.map(a,x.identity):x.values(a):[]},x.size=function(a){return null==a?0:a.length===+a.length?a.length:x.keys(a).length},x.first=x.head=x.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:h.call(a,0,b)},x.initial=function(a,b,c){return h.call(a,0,a.length-(null==b||c?1:b))},x.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))},x.rest=x.tail=x.drop=function(a,b,c){return h.call(a,null==b||c?1:b)},x.compact=function(a){return x.filter(a,x.identity)};var D=function(a,b,c){return b&&x.every(a,x.isArray)?i.apply(c,a):(y(a,function(a){x.isArray(a)||x.isArguments(a)?b?g.apply(c,a):D(a,b,c):c.push(a)}),c)};x.flatten=function(a,b){return D(a,b,[])},x.without=function(a){return x.difference(a,h.call(arguments,1))},x.uniq=x.unique=function(a,b,c,d){x.isFunction(b)&&(d=c,c=b,b=!1);var e=c?x.map(a,c,d):a,f=[],g=[];return y(e,function(c,d){(b?d&&g[g.length-1]===c:x.contains(g,c))||(g.push(c),f.push(a[d]))}),f},x.union=function(){return x.uniq(x.flatten(arguments,!0))},x.intersection=function(a){var b=h.call(arguments,1);return x.filter(x.uniq(a),function(a){return x.every(b,function(b){return x.indexOf(b,a)>=0})})},x.difference=function(a){var b=i.apply(d,h.call(arguments,1));return x.filter(a,function(a){return!x.contains(b,a)})},x.zip=function(){return x.unzip.apply(x,h.call(arguments))},x.unzip=function(){for(var a=x.max(x.pluck(arguments,"length").concat(0)),b=new Array(a),c=0;a>c;c++)b[c]=x.pluck(arguments,""+c);
return b},x.object=function(a,b){if(null==a)return{};for(var c={},d=0,e=a.length;e>d;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c},x.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c){if("number"!=typeof c)return d=x.sortedIndex(a,b),a[d]===b?d:-1;d=0>c?Math.max(0,e+c):c}if(s&&a.indexOf===s)return a.indexOf(b,c);for(;e>d;d++)if(a[d]===b)return d;return-1},x.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(t&&a.lastIndexOf===t)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(var e=d?c:a.length;e--;)if(a[e]===b)return e;return-1},x.range=function(a,b,c){arguments.length<=1&&(b=a||0,a=0),c=arguments[2]||1;for(var d=Math.max(Math.ceil((b-a)/c),0),e=0,f=new Array(d);d>e;)f[e++]=a,a+=c;return f};var E=function(){};x.bind=function(a,b){var c,d;if(w&&a.bind===w)return w.apply(a,h.call(arguments,1));if(!x.isFunction(a))throw new TypeError;return c=h.call(arguments,2),d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));E.prototype=a.prototype;var e=new E;E.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}},x.partial=function(a){var b=h.call(arguments,1);return function(){return a.apply(this,b.concat(h.call(arguments)))}},x.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw new Error("bindAll must be passed function names");return y(b,function(b){a[b]=x.bind(a[b],a)}),a},x.memoize=function(a,b){var c={};return b||(b=x.identity),function(){var d=b.apply(this,arguments);return x.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}},x.delay=function(a,b){var c=h.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)},x.defer=function(a){return x.delay.apply(x,[a,1].concat(h.call(arguments,1)))},x.throttle=function(a,b,c){var d,e,f,g=null,h=0;c||(c={});var i=function(){h=new Date,g=null,f=a.apply(d,e)};return function(){var j=new Date;h||c.leading!==!1||(h=j);var k=b-(j-h);return d=this,e=arguments,0>=k?(clearTimeout(g),g=null,h=j,f=a.apply(d,e)):g||c.trailing===!1||(g=setTimeout(i,k)),f}},x.debounce=function(a,b,c){var d,e=null;return function(){var f=this,g=arguments,h=function(){e=null,c||(d=a.apply(f,g))},i=c&&!e;return clearTimeout(e),e=setTimeout(h,b),i&&(d=a.apply(f,g)),d}},x.once=function(a){var b,c=!1;return function(){return c?b:(c=!0,b=a.apply(this,arguments),a=null,b)}},x.wrap=function(a,b){return function(){var c=[a];return g.apply(c,arguments),b.apply(this,c)}},x.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;c>=0;c--)b=[a[c].apply(this,b)];return b[0]}},x.after=function(a,b){return function(){return--a<1?b.apply(this,arguments):void 0}},x.keys=v||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[];for(var c in a)x.has(a,c)&&b.push(c);return b},x.values=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push(a[c]);return b},x.pairs=function(a){var b=[];for(var c in a)x.has(a,c)&&b.push([c,a[c]]);return b},x.invert=function(a){var b={};for(var c in a)x.has(a,c)&&(b[a[c]]=c);return b},x.functions=x.methods=function(a){var b=[];for(var c in a)x.isFunction(a[c])&&b.push(c);return b.sort()},x.extend=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]}),a},x.pick=function(a){var b={},c=i.apply(d,h.call(arguments,1));return y(c,function(c){c in a&&(b[c]=a[c])}),b},x.omit=function(a){var b={},c=i.apply(d,h.call(arguments,1));for(var e in a)x.contains(c,e)||(b[e]=a[e]);return b},x.defaults=function(a){return y(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a},x.clone=function(a){return x.isObject(a)?x.isArray(a)?a.slice():x.extend({},a):a},x.tap=function(a,b){return b(a),a};var F=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof x&&(a=a._wrapped),b instanceof x&&(b=b._wrapped);var e=j.call(a);if(e!=j.call(b))return!1;switch(e){case"[object String]":return a==String(b);case"[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case"[object Date]":case"[object Boolean]":return+a==+b;case"[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var g=a.constructor,h=b.constructor;if(g!==h&&!(x.isFunction(g)&&g instanceof g&&x.isFunction(h)&&h instanceof h))return!1;c.push(a),d.push(b);var i=0,k=!0;if("[object Array]"==e){if(i=a.length,k=i==b.length)for(;i--&&(k=F(a[i],b[i],c,d)););}else{for(var l in a)if(x.has(a,l)&&(i++,!(k=x.has(b,l)&&F(a[l],b[l],c,d))))break;if(k){for(l in b)if(x.has(b,l)&&!i--)break;k=!i}}return c.pop(),d.pop(),k};x.isEqual=function(a,b){return F(a,b,[],[])},x.isEmpty=function(a){if(null==a)return!0;if(x.isArray(a)||x.isString(a))return 0===a.length;for(var b in a)if(x.has(a,b))return!1;return!0},x.isElement=function(a){return!(!a||1!==a.nodeType)},x.isArray=u||function(a){return"[object Array]"==j.call(a)},x.isObject=function(a){return a===Object(a)},y(["Arguments","Function","String","Number","Date","RegExp"],function(a){x["is"+a]=function(b){return j.call(b)=="[object "+a+"]"}}),x.isArguments(arguments)||(x.isArguments=function(a){return!(!a||!x.has(a,"callee"))}),"function"!=typeof/./&&(x.isFunction=function(a){return"function"==typeof a}),x.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))},x.isNaN=function(a){return x.isNumber(a)&&a!=+a},x.isBoolean=function(a){return a===!0||a===!1||"[object Boolean]"==j.call(a)},x.isNull=function(a){return null===a},x.isUndefined=function(a){return void 0===a},x.has=function(a,b){return k.call(a,b)},x.noConflict=function(){return a._=b,this},x.identity=function(a){return a},x.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;a>e;e++)d[e]=b.call(c,e);return d},x.random=function(a,b){return null==b&&(b=a,a=0),a+Math.floor(Math.random()*(b-a+1))};var G={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"}};G.unescape=x.invert(G.escape);var H={escape:new RegExp("["+x.keys(G.escape).join("")+"]","g"),unescape:new RegExp("("+x.keys(G.unescape).join("|")+")","g")};x.each(["escape","unescape"],function(a){x[a]=function(b){return null==b?"":(""+b).replace(H[a],function(b){return G[a][b]})}}),x.result=function(a,b){if(null==a)return void 0;var c=a[b];return x.isFunction(c)?c.call(a):c},x.mixin=function(a){y(x.functions(a),function(b){var c=x[b]=a[b];x.prototype[b]=function(){var a=[this._wrapped];return g.apply(a,arguments),M.call(this,c.apply(x,a))}})};var I=0;x.uniqueId=function(a){var b=++I+"";return a?a+b:b},x.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var J=/(.)^/,K={"'":"'","\\":"\\","\r":"r","\n":"n","  ":"t","\u2028":"u2028","\u2029":"u2029"},L=/\\|'|\r|\n|\t|\u2028|\u2029/g;x.template=function(a,b,c){var d;c=x.defaults({},c,x.templateSettings);var e=new RegExp([(c.escape||J).source,(c.interpolate||J).source,(c.evaluate||J).source].join("|")+"|$","g"),f=0,g="__p+='";a.replace(e,function(b,c,d,e,h){return g+=a.slice(f,h).replace(L,function(a){return"\\"+K[a]}),c&&(g+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'"),d&&(g+="'+\n((__t=("+d+"))==null?'':__t)+\n'"),e&&(g+="';\n"+e+"\n__p+='"),f=h+b.length,b}),g+="';\n",c.variable||(g="with(obj||{}){\n"+g+"}\n"),g="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+g+"return __p;\n";try{d=new Function(c.variable||"obj","_",g)}catch(h){throw h.source=g,h}if(b)return d(b,x);var i=function(a){return d.call(this,a,x)};return i.source="function("+(c.variable||"obj")+"){\n"+g+"}",i},x.chain=function(a){return x(a).chain()};var M=function(a){return this._chain?x(a).chain():a};x.mixin(x),y(["pop","push","reverse","shift","sort","splice","unshift"],function(a){var b=d[a];x.prototype[a]=function(){var c=this._wrapped;return b.apply(c,arguments),"shift"!=a&&"splice"!=a||0!==c.length||delete c[0],M.call(this,c)}}),y(["concat","join","slice"],function(a){var b=d[a];x.prototype[a]=function(){return M.call(this,b.apply(this._wrapped,arguments))}}),x.extend(x.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}})}.call(this),eval(function(a,b,c,d,e,f){if(e=function(a){return(b>a?"":e(parseInt(a/b)))+((a%=b)>35?String.fromCharCode(a+29):a.toString(36))},!"".replace(/^/,String)){for(;c--;)f[e(c)]=d[c]||e(c);d=[function(a){return f[a]}],e=function(){return"\\w+"},c=1}for(;c--;)d[c]&&(a=a.replace(new RegExp("\\b"+e(c)+"\\b","g"),d[c]));return a}("9 17={3i:'0.1.3',16:1e-6};l v(){}v.23={e:l(i){8(i<1||i>7.4.q)?w:7.4[i-1]},2R:l(){8 7.4.q},1u:l(){8 F.1x(7.2u(7))},24:l(a){9 n=7.4.q;9 V=a.4||a;o(n!=V.q){8 1L}J{o(F.13(7.4[n-1]-V[n-1])>17.16){8 1L}}H(--n);8 2x},1q:l(){8 v.u(7.4)},1b:l(a){9 b=[];7.28(l(x,i){b.19(a(x,i))});8 v.u(b)},28:l(a){9 n=7.4.q,k=n,i;J{i=k-n;a(7.4[i],i+1)}H(--n)},2q:l(){9 r=7.1u();o(r===0){8 7.1q()}8 7.1b(l(x){8 x/r})},1C:l(a){9 V=a.4||a;9 n=7.4.q,k=n,i;o(n!=V.q){8 w}9 b=0,1D=0,1F=0;7.28(l(x,i){b+=x*V[i-1];1D+=x*x;1F+=V[i-1]*V[i-1]});1D=F.1x(1D);1F=F.1x(1F);o(1D*1F===0){8 w}9 c=b/(1D*1F);o(c<-1){c=-1}o(c>1){c=1}8 F.37(c)},1m:l(a){9 b=7.1C(a);8(b===w)?w:(b<=17.16)},34:l(a){9 b=7.1C(a);8(b===w)?w:(F.13(b-F.1A)<=17.16)},2k:l(a){9 b=7.2u(a);8(b===w)?w:(F.13(b)<=17.16)},2j:l(a){9 V=a.4||a;o(7.4.q!=V.q){8 w}8 7.1b(l(x,i){8 x+V[i-1]})},2C:l(a){9 V=a.4||a;o(7.4.q!=V.q){8 w}8 7.1b(l(x,i){8 x-V[i-1]})},22:l(k){8 7.1b(l(x){8 x*k})},x:l(k){8 7.22(k)},2u:l(a){9 V=a.4||a;9 i,2g=0,n=7.4.q;o(n!=V.q){8 w}J{2g+=7.4[n-1]*V[n-1]}H(--n);8 2g},2f:l(a){9 B=a.4||a;o(7.4.q!=3||B.q!=3){8 w}9 A=7.4;8 v.u([(A[1]*B[2])-(A[2]*B[1]),(A[2]*B[0])-(A[0]*B[2]),(A[0]*B[1])-(A[1]*B[0])])},2A:l(){9 m=0,n=7.4.q,k=n,i;J{i=k-n;o(F.13(7.4[i])>F.13(m)){m=7.4[i]}}H(--n);8 m},2Z:l(x){9 a=w,n=7.4.q,k=n,i;J{i=k-n;o(a===w&&7.4[i]==x){a=i+1}}H(--n);8 a},3g:l(){8 S.2X(7.4)},2d:l(){8 7.1b(l(x){8 F.2d(x)})},2V:l(x){8 7.1b(l(y){8(F.13(y-x)<=17.16)?x:y})},1o:l(a){o(a.K){8 a.1o(7)}9 V=a.4||a;o(V.q!=7.4.q){8 w}9 b=0,2b;7.28(l(x,i){2b=x-V[i-1];b+=2b*2b});8 F.1x(b)},3a:l(a){8 a.1h(7)},2T:l(a){8 a.1h(7)},1V:l(t,a){9 V,R,x,y,z;2S(7.4.q){27 2:V=a.4||a;o(V.q!=2){8 w}R=S.1R(t).4;x=7.4[0]-V[0];y=7.4[1]-V[1];8 v.u([V[0]+R[0][0]*x+R[0][1]*y,V[1]+R[1][0]*x+R[1][1]*y]);1I;27 3:o(!a.U){8 w}9 C=a.1r(7).4;R=S.1R(t,a.U).4;x=7.4[0]-C[0];y=7.4[1]-C[1];z=7.4[2]-C[2];8 v.u([C[0]+R[0][0]*x+R[0][1]*y+R[0][2]*z,C[1]+R[1][0]*x+R[1][1]*y+R[1][2]*z,C[2]+R[2][0]*x+R[2][1]*y+R[2][2]*z]);1I;2P:8 w}},1t:l(a){o(a.K){9 P=7.4.2O();9 C=a.1r(P).4;8 v.u([C[0]+(C[0]-P[0]),C[1]+(C[1]-P[1]),C[2]+(C[2]-(P[2]||0))])}1d{9 Q=a.4||a;o(7.4.q!=Q.q){8 w}8 7.1b(l(x,i){8 Q[i-1]+(Q[i-1]-x)})}},1N:l(){9 V=7.1q();2S(V.4.q){27 3:1I;27 2:V.4.19(0);1I;2P:8 w}8 V},2n:l(){8'['+7.4.2K(', ')+']'},26:l(a){7.4=(a.4||a).2O();8 7}};v.u=l(a){9 V=25 v();8 V.26(a)};v.i=v.u([1,0,0]);v.j=v.u([0,1,0]);v.k=v.u([0,0,1]);v.2J=l(n){9 a=[];J{a.19(F.2F())}H(--n);8 v.u(a)};v.1j=l(n){9 a=[];J{a.19(0)}H(--n);8 v.u(a)};l S(){}S.23={e:l(i,j){o(i<1||i>7.4.q||j<1||j>7.4[0].q){8 w}8 7.4[i-1][j-1]},33:l(i){o(i>7.4.q){8 w}8 v.u(7.4[i-1])},2E:l(j){o(j>7.4[0].q){8 w}9 a=[],n=7.4.q,k=n,i;J{i=k-n;a.19(7.4[i][j-1])}H(--n);8 v.u(a)},2R:l(){8{2D:7.4.q,1p:7.4[0].q}},2D:l(){8 7.4.q},1p:l(){8 7.4[0].q},24:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(7.4.q!=M.q||7.4[0].q!=M[0].q){8 1L}9 b=7.4.q,15=b,i,G,10=7.4[0].q,j;J{i=15-b;G=10;J{j=10-G;o(F.13(7.4[i][j]-M[i][j])>17.16){8 1L}}H(--G)}H(--b);8 2x},1q:l(){8 S.u(7.4)},1b:l(a){9 b=[],12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;b[i]=[];J{j=10-G;b[i][j]=a(7.4[i][j],i+1,j+1)}H(--G)}H(--12);8 S.u(b)},2i:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}8(7.4.q==M.q&&7.4[0].q==M[0].q)},2j:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(!7.2i(M)){8 w}8 7.1b(l(x,i,j){8 x+M[i-1][j-1]})},2C:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(!7.2i(M)){8 w}8 7.1b(l(x,i,j){8 x-M[i-1][j-1]})},2B:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}8(7.4[0].q==M.q)},22:l(a){o(!a.4){8 7.1b(l(x){8 x*a})}9 b=a.1u?2x:1L;9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}o(!7.2B(M)){8 w}9 d=7.4.q,15=d,i,G,10=M[0].q,j;9 e=7.4[0].q,4=[],21,20,c;J{i=15-d;4[i]=[];G=10;J{j=10-G;21=0;20=e;J{c=e-20;21+=7.4[i][c]*M[c][j]}H(--20);4[i][j]=21}H(--G)}H(--d);9 M=S.u(4);8 b?M.2E(1):M},x:l(a){8 7.22(a)},32:l(a,b,c,d){9 e=[],12=c,i,G,j;9 f=7.4.q,1p=7.4[0].q;J{i=c-12;e[i]=[];G=d;J{j=d-G;e[i][j]=7.4[(a+i-1)%f][(b+j-1)%1p]}H(--G)}H(--12);8 S.u(e)},31:l(){9 a=7.4.q,1p=7.4[0].q;9 b=[],12=1p,i,G,j;J{i=1p-12;b[i]=[];G=a;J{j=a-G;b[i][j]=7.4[j][i]}H(--G)}H(--12);8 S.u(b)},1y:l(){8(7.4.q==7.4[0].q)},2A:l(){9 m=0,12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;J{j=10-G;o(F.13(7.4[i][j])>F.13(m)){m=7.4[i][j]}}H(--G)}H(--12);8 m},2Z:l(x){9 a=w,12=7.4.q,15=12,i,G,10=7.4[0].q,j;J{i=15-12;G=10;J{j=10-G;o(7.4[i][j]==x){8{i:i+1,j:j+1}}}H(--G)}H(--12);8 w},30:l(){o(!7.1y){8 w}9 a=[],n=7.4.q,k=n,i;J{i=k-n;a.19(7.4[i][i])}H(--n);8 v.u(a)},1K:l(){9 M=7.1q(),1c;9 n=7.4.q,k=n,i,1s,1n=7.4[0].q,p;J{i=k-n;o(M.4[i][i]==0){2e(j=i+1;j<k;j++){o(M.4[j][i]!=0){1c=[];1s=1n;J{p=1n-1s;1c.19(M.4[i][p]+M.4[j][p])}H(--1s);M.4[i]=1c;1I}}}o(M.4[i][i]!=0){2e(j=i+1;j<k;j++){9 a=M.4[j][i]/M.4[i][i];1c=[];1s=1n;J{p=1n-1s;1c.19(p<=i?0:M.4[j][p]-M.4[i][p]*a)}H(--1s);M.4[j]=1c}}}H(--n);8 M},3h:l(){8 7.1K()},2z:l(){o(!7.1y()){8 w}9 M=7.1K();9 a=M.4[0][0],n=M.4.q-1,k=n,i;J{i=k-n+1;a=a*M.4[i][i]}H(--n);8 a},3f:l(){8 7.2z()},2y:l(){8(7.1y()&&7.2z()===0)},2Y:l(){o(!7.1y()){8 w}9 a=7.4[0][0],n=7.4.q-1,k=n,i;J{i=k-n+1;a+=7.4[i][i]}H(--n);8 a},3e:l(){8 7.2Y()},1Y:l(){9 M=7.1K(),1Y=0;9 a=7.4.q,15=a,i,G,10=7.4[0].q,j;J{i=15-a;G=10;J{j=10-G;o(F.13(M.4[i][j])>17.16){1Y++;1I}}H(--G)}H(--a);8 1Y},3d:l(){8 7.1Y()},2W:l(a){9 M=a.4||a;o(1g(M[0][0])=='1f'){M=S.u(M).4}9 T=7.1q(),1p=T.4[0].q;9 b=T.4.q,15=b,i,G,10=M[0].q,j;o(b!=M.q){8 w}J{i=15-b;G=10;J{j=10-G;T.4[i][1p+j]=M[i][j]}H(--G)}H(--b);8 T},2w:l(){o(!7.1y()||7.2y()){8 w}9 a=7.4.q,15=a,i,j;9 M=7.2W(S.I(a)).1K();9 b,1n=M.4[0].q,p,1c,2v;9 c=[],2c;J{i=a-1;1c=[];b=1n;c[i]=[];2v=M.4[i][i];J{p=1n-b;2c=M.4[i][p]/2v;1c.19(2c);o(p>=15){c[i].19(2c)}}H(--b);M.4[i]=1c;2e(j=0;j<i;j++){1c=[];b=1n;J{p=1n-b;1c.19(M.4[j][p]-M.4[i][p]*M.4[j][i])}H(--b);M.4[j]=1c}}H(--a);8 S.u(c)},3c:l(){8 7.2w()},2d:l(){8 7.1b(l(x){8 F.2d(x)})},2V:l(x){8 7.1b(l(p){8(F.13(p-x)<=17.16)?x:p})},2n:l(){9 a=[];9 n=7.4.q,k=n,i;J{i=k-n;a.19(v.u(7.4[i]).2n())}H(--n);8 a.2K('\\n')},26:l(a){9 i,4=a.4||a;o(1g(4[0][0])!='1f'){9 b=4.q,15=b,G,10,j;7.4=[];J{i=15-b;G=4[i].q;10=G;7.4[i]=[];J{j=10-G;7.4[i][j]=4[i][j]}H(--G)}H(--b);8 7}9 n=4.q,k=n;7.4=[];J{i=k-n;7.4.19([4[i]])}H(--n);8 7}};S.u=l(a){9 M=25 S();8 M.26(a)};S.I=l(n){9 a=[],k=n,i,G,j;J{i=k-n;a[i]=[];G=k;J{j=k-G;a[i][j]=(i==j)?1:0}H(--G)}H(--n);8 S.u(a)};S.2X=l(a){9 n=a.q,k=n,i;9 M=S.I(n);J{i=k-n;M.4[i][i]=a[i]}H(--n);8 M};S.1R=l(b,a){o(!a){8 S.u([[F.1H(b),-F.1G(b)],[F.1G(b),F.1H(b)]])}9 d=a.1q();o(d.4.q!=3){8 w}9 e=d.1u();9 x=d.4[0]/e,y=d.4[1]/e,z=d.4[2]/e;9 s=F.1G(b),c=F.1H(b),t=1-c;8 S.u([[t*x*x+c,t*x*y-s*z,t*x*z+s*y],[t*x*y+s*z,t*y*y+c,t*y*z-s*x],[t*x*z-s*y,t*y*z+s*x,t*z*z+c]])};S.3b=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[1,0,0],[0,c,-s],[0,s,c]])};S.39=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[c,0,s],[0,1,0],[-s,0,c]])};S.38=l(t){9 c=F.1H(t),s=F.1G(t);8 S.u([[c,-s,0],[s,c,0],[0,0,1]])};S.2J=l(n,m){8 S.1j(n,m).1b(l(){8 F.2F()})};S.1j=l(n,m){9 a=[],12=n,i,G,j;J{i=n-12;a[i]=[];G=m;J{j=m-G;a[i][j]=0}H(--G)}H(--12);8 S.u(a)};l 14(){}14.23={24:l(a){8(7.1m(a)&&7.1h(a.K))},1q:l(){8 14.u(7.K,7.U)},2U:l(a){9 V=a.4||a;8 14.u([7.K.4[0]+V[0],7.K.4[1]+V[1],7.K.4[2]+(V[2]||0)],7.U)},1m:l(a){o(a.W){8 a.1m(7)}9 b=7.U.1C(a.U);8(F.13(b)<=17.16||F.13(b-F.1A)<=17.16)},1o:l(a){o(a.W){8 a.1o(7)}o(a.U){o(7.1m(a)){8 7.1o(a.K)}9 N=7.U.2f(a.U).2q().4;9 A=7.K.4,B=a.K.4;8 F.13((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}1d{9 P=a.4||a;9 A=7.K.4,D=7.U.4;9 b=P[0]-A[0],2a=P[1]-A[1],29=(P[2]||0)-A[2];9 c=F.1x(b*b+2a*2a+29*29);o(c===0)8 0;9 d=(b*D[0]+2a*D[1]+29*D[2])/c;9 e=1-d*d;8 F.13(c*F.1x(e<0?0:e))}},1h:l(a){9 b=7.1o(a);8(b!==w&&b<=17.16)},2T:l(a){8 a.1h(7)},1v:l(a){o(a.W){8 a.1v(7)}8(!7.1m(a)&&7.1o(a)<=17.16)},1U:l(a){o(a.W){8 a.1U(7)}o(!7.1v(a)){8 w}9 P=7.K.4,X=7.U.4,Q=a.K.4,Y=a.U.4;9 b=X[0],1z=X[1],1B=X[2],1T=Y[0],1S=Y[1],1M=Y[2];9 c=P[0]-Q[0],2s=P[1]-Q[1],2r=P[2]-Q[2];9 d=-b*c-1z*2s-1B*2r;9 e=1T*c+1S*2s+1M*2r;9 f=b*b+1z*1z+1B*1B;9 g=1T*1T+1S*1S+1M*1M;9 h=b*1T+1z*1S+1B*1M;9 k=(d*g/f+h*e)/(g-h*h);8 v.u([P[0]+k*b,P[1]+k*1z,P[2]+k*1B])},1r:l(a){o(a.U){o(7.1v(a)){8 7.1U(a)}o(7.1m(a)){8 w}9 D=7.U.4,E=a.U.4;9 b=D[0],1l=D[1],1k=D[2],1P=E[0],1O=E[1],1Q=E[2];9 x=(1k*1P-b*1Q),y=(b*1O-1l*1P),z=(1l*1Q-1k*1O);9 N=v.u([x*1Q-y*1O,y*1P-z*1Q,z*1O-x*1P]);9 P=11.u(a.K,N);8 P.1U(7)}1d{9 P=a.4||a;o(7.1h(P)){8 v.u(P)}9 A=7.K.4,D=7.U.4;9 b=D[0],1l=D[1],1k=D[2],1w=A[0],18=A[1],1a=A[2];9 x=b*(P[1]-18)-1l*(P[0]-1w),y=1l*((P[2]||0)-1a)-1k*(P[1]-18),z=1k*(P[0]-1w)-b*((P[2]||0)-1a);9 V=v.u([1l*x-1k*z,1k*y-b*x,b*z-1l*y]);9 k=7.1o(P)/V.1u();8 v.u([P[0]+V.4[0]*k,P[1]+V.4[1]*k,(P[2]||0)+V.4[2]*k])}},1V:l(t,a){o(1g(a.U)=='1f'){a=14.u(a.1N(),v.k)}9 R=S.1R(t,a.U).4;9 C=a.1r(7.K).4;9 A=7.K.4,D=7.U.4;9 b=C[0],1E=C[1],1J=C[2],1w=A[0],18=A[1],1a=A[2];9 x=1w-b,y=18-1E,z=1a-1J;8 14.u([b+R[0][0]*x+R[0][1]*y+R[0][2]*z,1E+R[1][0]*x+R[1][1]*y+R[1][2]*z,1J+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*D[0]+R[0][1]*D[1]+R[0][2]*D[2],R[1][0]*D[0]+R[1][1]*D[1]+R[1][2]*D[2],R[2][0]*D[0]+R[2][1]*D[1]+R[2][2]*D[2]])},1t:l(a){o(a.W){9 A=7.K.4,D=7.U.4;9 b=A[0],18=A[1],1a=A[2],2N=D[0],1l=D[1],1k=D[2];9 c=7.K.1t(a).4;9 d=b+2N,2h=18+1l,2o=1a+1k;9 Q=a.1r([d,2h,2o]).4;9 e=[Q[0]+(Q[0]-d)-c[0],Q[1]+(Q[1]-2h)-c[1],Q[2]+(Q[2]-2o)-c[2]];8 14.u(c,e)}1d o(a.U){8 7.1V(F.1A,a)}1d{9 P=a.4||a;8 14.u(7.K.1t([P[0],P[1],(P[2]||0)]),7.U)}},1Z:l(a,b){a=v.u(a);b=v.u(b);o(a.4.q==2){a.4.19(0)}o(b.4.q==2){b.4.19(0)}o(a.4.q>3||b.4.q>3){8 w}9 c=b.1u();o(c===0){8 w}7.K=a;7.U=v.u([b.4[0]/c,b.4[1]/c,b.4[2]/c]);8 7}};14.u=l(a,b){9 L=25 14();8 L.1Z(a,b)};14.X=14.u(v.1j(3),v.i);14.Y=14.u(v.1j(3),v.j);14.Z=14.u(v.1j(3),v.k);l 11(){}11.23={24:l(a){8(7.1h(a.K)&&7.1m(a))},1q:l(){8 11.u(7.K,7.W)},2U:l(a){9 V=a.4||a;8 11.u([7.K.4[0]+V[0],7.K.4[1]+V[1],7.K.4[2]+(V[2]||0)],7.W)},1m:l(a){9 b;o(a.W){b=7.W.1C(a.W);8(F.13(b)<=17.16||F.13(F.1A-b)<=17.16)}1d o(a.U){8 7.W.2k(a.U)}8 w},2k:l(a){9 b=7.W.1C(a.W);8(F.13(F.1A/2-b)<=17.16)},1o:l(a){o(7.1v(a)||7.1h(a)){8 0}o(a.K){9 A=7.K.4,B=a.K.4,N=7.W.4;8 F.13((A[0]-B[0])*N[0]+(A[1]-B[1])*N[1]+(A[2]-B[2])*N[2])}1d{9 P=a.4||a;9 A=7.K.4,N=7.W.4;8 F.13((A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2])}},1h:l(a){o(a.W){8 w}o(a.U){8(7.1h(a.K)&&7.1h(a.K.2j(a.U)))}1d{9 P=a.4||a;9 A=7.K.4,N=7.W.4;9 b=F.13(N[0]*(A[0]-P[0])+N[1]*(A[1]-P[1])+N[2]*(A[2]-(P[2]||0)));8(b<=17.16)}},1v:l(a){o(1g(a.U)=='1f'&&1g(a.W)=='1f'){8 w}8!7.1m(a)},1U:l(a){o(!7.1v(a)){8 w}o(a.U){9 A=a.K.4,D=a.U.4,P=7.K.4,N=7.W.4;9 b=(N[0]*(P[0]-A[0])+N[1]*(P[1]-A[1])+N[2]*(P[2]-A[2]))/(N[0]*D[0]+N[1]*D[1]+N[2]*D[2]);8 v.u([A[0]+D[0]*b,A[1]+D[1]*b,A[2]+D[2]*b])}1d o(a.W){9 c=7.W.2f(a.W).2q();9 N=7.W.4,A=7.K.4,O=a.W.4,B=a.K.4;9 d=S.1j(2,2),i=0;H(d.2y()){i++;d=S.u([[N[i%3],N[(i+1)%3]],[O[i%3],O[(i+1)%3]]])}9 e=d.2w().4;9 x=N[0]*A[0]+N[1]*A[1]+N[2]*A[2];9 y=O[0]*B[0]+O[1]*B[1]+O[2]*B[2];9 f=[e[0][0]*x+e[0][1]*y,e[1][0]*x+e[1][1]*y];9 g=[];2e(9 j=1;j<=3;j++){g.19((i==j)?0:f[(j+(5-i)%3)%3])}8 14.u(g,c)}},1r:l(a){9 P=a.4||a;9 A=7.K.4,N=7.W.4;9 b=(A[0]-P[0])*N[0]+(A[1]-P[1])*N[1]+(A[2]-(P[2]||0))*N[2];8 v.u([P[0]+N[0]*b,P[1]+N[1]*b,(P[2]||0)+N[2]*b])},1V:l(t,a){9 R=S.1R(t,a.U).4;9 C=a.1r(7.K).4;9 A=7.K.4,N=7.W.4;9 b=C[0],1E=C[1],1J=C[2],1w=A[0],18=A[1],1a=A[2];9 x=1w-b,y=18-1E,z=1a-1J;8 11.u([b+R[0][0]*x+R[0][1]*y+R[0][2]*z,1E+R[1][0]*x+R[1][1]*y+R[1][2]*z,1J+R[2][0]*x+R[2][1]*y+R[2][2]*z],[R[0][0]*N[0]+R[0][1]*N[1]+R[0][2]*N[2],R[1][0]*N[0]+R[1][1]*N[1]+R[1][2]*N[2],R[2][0]*N[0]+R[2][1]*N[1]+R[2][2]*N[2]])},1t:l(a){o(a.W){9 A=7.K.4,N=7.W.4;9 b=A[0],18=A[1],1a=A[2],2M=N[0],2L=N[1],2Q=N[2];9 c=7.K.1t(a).4;9 d=b+2M,2p=18+2L,2m=1a+2Q;9 Q=a.1r([d,2p,2m]).4;9 e=[Q[0]+(Q[0]-d)-c[0],Q[1]+(Q[1]-2p)-c[1],Q[2]+(Q[2]-2m)-c[2]];8 11.u(c,e)}1d o(a.U){8 7.1V(F.1A,a)}1d{9 P=a.4||a;8 11.u(7.K.1t([P[0],P[1],(P[2]||0)]),7.W)}},1Z:l(a,b,c){a=v.u(a);a=a.1N();o(a===w){8 w}b=v.u(b);b=b.1N();o(b===w){8 w}o(1g(c)=='1f'){c=w}1d{c=v.u(c);c=c.1N();o(c===w){8 w}}9 d=a.4[0],18=a.4[1],1a=a.4[2];9 e=b.4[0],1W=b.4[1],1X=b.4[2];9 f,1i;o(c!==w){9 g=c.4[0],2l=c.4[1],2t=c.4[2];f=v.u([(1W-18)*(2t-1a)-(1X-1a)*(2l-18),(1X-1a)*(g-d)-(e-d)*(2t-1a),(e-d)*(2l-18)-(1W-18)*(g-d)]);1i=f.1u();o(1i===0){8 w}f=v.u([f.4[0]/1i,f.4[1]/1i,f.4[2]/1i])}1d{1i=F.1x(e*e+1W*1W+1X*1X);o(1i===0){8 w}f=v.u([b.4[0]/1i,b.4[1]/1i,b.4[2]/1i])}7.K=a;7.W=f;8 7}};11.u=l(a,b,c){9 P=25 11();8 P.1Z(a,b,c)};11.2I=11.u(v.1j(3),v.k);11.2H=11.u(v.1j(3),v.i);11.2G=11.u(v.1j(3),v.j);11.36=11.2I;11.35=11.2H;11.3j=11.2G;9 $V=v.u;9 $M=S.u;9 $L=14.u;9 $P=11.u;",62,206,"||||elements|||this|return|var||||||||||||function|||if||length||||create|Vector|null|||||||||Math|nj|while||do|anchor||||||||Matrix||direction||normal||||kj|Plane|ni|abs|Line|ki|precision|Sylvester|A2|push|A3|map|els|else||undefined|typeof|contains|mod|Zero|D3|D2|isParallelTo|kp|distanceFrom|cols|dup|pointClosestTo|np|reflectionIn|modulus|intersects|A1|sqrt|isSquare|X2|PI|X3|angleFrom|mod1|C2|mod2|sin|cos|break|C3|toRightTriangular|false|Y3|to3D|E2|E1|E3|Rotation|Y2|Y1|intersectionWith|rotate|v12|v13|rank|setVectors|nc|sum|multiply|prototype|eql|new|setElements|case|each|PA3|PA2|part|new_element|round|for|cross|product|AD2|isSameSizeAs|add|isPerpendicularTo|v22|AN3|inspect|AD3|AN2|toUnitVector|PsubQ3|PsubQ2|v23|dot|divisor|inverse|true|isSingular|determinant|max|canMultiplyFromLeft|subtract|rows|col|random|ZX|YZ|XY|Random|join|N2|N1|D1|slice|default|N3|dimensions|switch|liesIn|translate|snapTo|augment|Diagonal|trace|indexOf|diagonal|transpose|minor|row|isAntiparallelTo|ZY|YX|acos|RotationZ|RotationY|liesOn|RotationX|inv|rk|tr|det|toDiagonalMatrix|toUpperTriangular|version|XZ".split("|"),0,{})),Matrix.Translation=function(a){if(2==a.elements.length){var b=Matrix.I(3);return b.elements[2][0]=a.elements[0],b.elements[2][1]=a.elements[1],b}if(3==a.elements.length){var b=Matrix.I(4);return b.elements[0][3]=a.elements[0],b.elements[1][3]=a.elements[1],b.elements[2][3]=a.elements[2],b}throw"Invalid length for Translation"},Matrix.prototype.flatten=function(){var a=[];if(0==this.elements.length)return[];for(var b=0;b<this.elements[0].length;b++)for(var c=0;c<this.elements.length;c++)a.push(this.elements[c][b]);return a},Matrix.prototype.ensure4x4=function(){if(4==this.elements.length&&4==this.elements[0].length)return this;if(this.elements.length>4||this.elements[0].length>4)return null;for(var a=0;a<this.elements.length;a++)for(var b=this.elements[a].length;4>b;b++)a==b?this.elements[a].push(1):this.elements[a].push(0);for(var a=this.elements.length;4>a;a++)0==a?this.elements.push([1,0,0,0]):1==a?this.elements.push([0,1,0,0]):2==a?this.elements.push([0,0,1,0]):3==a&&this.elements.push([0,0,0,1]);return this},Matrix.prototype.make3x3=function(){return 4!=this.elements.length||4!=this.elements[0].length?null:Matrix.create([[this.elements[0][0],this.elements[0][1],this.elements[0][2]],[this.elements[1][0],this.elements[1][1],this.elements[1][2]],[this.elements[2][0],this.elements[2][1],this.elements[2][2]]])},Vector.prototype.flatten=function(){return this.elements},function(a){"use strict";var b={};"undefined"==typeof exports?"function"==typeof define&&"object"==typeof define.amd&&define.amd?(b.exports={},define(function(){return b.exports})):b.exports="undefined"!=typeof window?window:a:b.exports=exports,function(a){if(!b)var b=1e-6;if(!c)var c="undefined"!=typeof Float32Array?Float32Array:Array;if(!d)var d=Math.random;var e={};e.setMatrixArrayType=function(a){c=a},"undefined"!=typeof a&&(a.glMatrix=e);var f={};f.create=function(){var a=new c(2);return a[0]=0,a[1]=0,a},f.clone=function(a){var b=new c(2);return b[0]=a[0],b[1]=a[1],b},f.fromValues=function(a,b){var d=new c(2);return d[0]=a,d[1]=b,d},f.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a},f.set=function(a,b,c){return a[0]=b,a[1]=c,a},f.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a},f.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a},f.sub=f.subtract,f.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a},f.mul=f.multiply,f.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a},f.div=f.divide,f.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a},f.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a},f.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a},f.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a},f.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return Math.sqrt(c*c+d*d)},f.dist=f.distance,f.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1];return c*c+d*d},f.sqrDist=f.squaredDistance,f.length=function(a){var b=a[0],c=a[1];return Math.sqrt(b*b+c*c)},f.len=f.length,f.squaredLength=function(a){var b=a[0],c=a[1];return b*b+c*c},f.sqrLen=f.squaredLength,f.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a},f.normalize=function(a,b){var c=b[0],d=b[1],e=c*c+d*d;return e>0&&(e=1/Math.sqrt(e),a[0]=b[0]*e,a[1]=b[1]*e),a},f.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]},f.cross=function(a,b,c){var d=b[0]*c[1]-b[1]*c[0];return a[0]=a[1]=0,a[2]=d,a},f.lerp=function(a,b,c,d){var e=b[0],f=b[1];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a},f.random=function(a,b){b=b||1;var c=2*d()*Math.PI;return a[0]=Math.cos(c)*b,a[1]=Math.sin(c)*b,a},f.transformMat2=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[2]*e,a[1]=c[1]*d+c[3]*e,a},f.transformMat2d=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[2]*e+c[4],a[1]=c[1]*d+c[3]*e+c[5],a},f.transformMat3=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[3]*e+c[6],a[1]=c[1]*d+c[4]*e+c[7],a},f.transformMat4=function(a,b,c){var d=b[0],e=b[1];return a[0]=c[0]*d+c[4]*e+c[12],a[1]=c[1]*d+c[5]*e+c[13],a},f.forEach=function(){var a=f.create();return function(b,c,d,e,f,g){var h,i;for(c||(c=2),d||(d=0),i=e?Math.min(e*c+d,b.length):b.length,h=d;i>h;h+=c)a[0]=b[h],a[1]=b[h+1],f(a,a,g),b[h]=a[0],b[h+1]=a[1];return b}}(),f.str=function(a){return"vec2("+a[0]+", "+a[1]+")"},"undefined"!=typeof a&&(a.vec2=f);var g={};g.create=function(){var a=new c(3);return a[0]=0,a[1]=0,a[2]=0,a},g.clone=function(a){var b=new c(3);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b},g.fromValues=function(a,b,d){var e=new c(3);return e[0]=a,e[1]=b,e[2]=d,e},g.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a},g.set=function(a,b,c,d){return a[0]=b,a[1]=c,a[2]=d,a},g.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a},g.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a},g.sub=g.subtract,g.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a},g.mul=g.multiply,g.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a},g.div=g.divide,g.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a},g.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a},g.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a},g.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a},g.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return Math.sqrt(c*c+d*d+e*e)},g.dist=g.distance,g.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2];return c*c+d*d+e*e},g.sqrDist=g.squaredDistance,g.length=function(a){var b=a[0],c=a[1],d=a[2];return Math.sqrt(b*b+c*c+d*d)},g.len=g.length,g.squaredLength=function(a){var b=a[0],c=a[1],d=a[2];return b*b+c*c+d*d},g.sqrLen=g.squaredLength,g.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a},g.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=c*c+d*d+e*e;return f>0&&(f=1/Math.sqrt(f),a[0]=b[0]*f,a[1]=b[1]*f,a[2]=b[2]*f),a},g.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]},g.cross=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2];return a[0]=e*i-f*h,a[1]=f*g-d*i,a[2]=d*h-e*g,a},g.lerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a},g.random=function(a,b){b=b||1;var c=2*d()*Math.PI,e=2*d()-1,f=Math.sqrt(1-e*e)*b;return a[0]=Math.cos(c)*f,a[1]=Math.sin(c)*f,a[2]=e*b,a},g.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12],a[1]=c[1]*d+c[5]*e+c[9]*f+c[13],a[2]=c[2]*d+c[6]*e+c[10]*f+c[14],a},g.transformMat3=function(a,b,c){var d=b[0],e=b[1],f=b[2];return a[0]=d*c[0]+e*c[3]+f*c[6],a[1]=d*c[1]+e*c[4]+f*c[7],a[2]=d*c[2]+e*c[5]+f*c[8],a},g.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a},g.forEach=function(){var a=g.create();return function(b,c,d,e,f,g){var h,i;for(c||(c=3),d||(d=0),i=e?Math.min(e*c+d,b.length):b.length,h=d;i>h;h+=c)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],f(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2];return b}}(),g.str=function(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"},"undefined"!=typeof a&&(a.vec3=g);var h={};h.create=function(){var a=new c(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a},h.clone=function(a){var b=new c(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},h.fromValues=function(a,b,d,e){var f=new c(4);return f[0]=a,f[1]=b,f[2]=d,f[3]=e,f},h.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},h.set=function(a,b,c,d,e){return a[0]=b,a[1]=c,a[2]=d,a[3]=e,a},h.add=function(a,b,c){return a[0]=b[0]+c[0],a[1]=b[1]+c[1],a[2]=b[2]+c[2],a[3]=b[3]+c[3],a},h.subtract=function(a,b,c){return a[0]=b[0]-c[0],a[1]=b[1]-c[1],a[2]=b[2]-c[2],a[3]=b[3]-c[3],a},h.sub=h.subtract,h.multiply=function(a,b,c){return a[0]=b[0]*c[0],a[1]=b[1]*c[1],a[2]=b[2]*c[2],a[3]=b[3]*c[3],a},h.mul=h.multiply,h.divide=function(a,b,c){return a[0]=b[0]/c[0],a[1]=b[1]/c[1],a[2]=b[2]/c[2],a[3]=b[3]/c[3],a},h.div=h.divide,h.min=function(a,b,c){return a[0]=Math.min(b[0],c[0]),a[1]=Math.min(b[1],c[1]),a[2]=Math.min(b[2],c[2]),a[3]=Math.min(b[3],c[3]),a},h.max=function(a,b,c){return a[0]=Math.max(b[0],c[0]),a[1]=Math.max(b[1],c[1]),a[2]=Math.max(b[2],c[2]),a[3]=Math.max(b[3],c[3]),a},h.scale=function(a,b,c){return a[0]=b[0]*c,a[1]=b[1]*c,a[2]=b[2]*c,a[3]=b[3]*c,a},h.scaleAndAdd=function(a,b,c,d){return a[0]=b[0]+c[0]*d,a[1]=b[1]+c[1]*d,a[2]=b[2]+c[2]*d,a[3]=b[3]+c[3]*d,a},h.distance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return Math.sqrt(c*c+d*d+e*e+f*f)},h.dist=h.distance,h.squaredDistance=function(a,b){var c=b[0]-a[0],d=b[1]-a[1],e=b[2]-a[2],f=b[3]-a[3];return c*c+d*d+e*e+f*f},h.sqrDist=h.squaredDistance,h.length=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return Math.sqrt(b*b+c*c+d*d+e*e)},h.len=h.length,h.squaredLength=function(a){var b=a[0],c=a[1],d=a[2],e=a[3];return b*b+c*c+d*d+e*e},h.sqrLen=h.squaredLength,h.negate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=-b[3],a},h.normalize=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f;return g>0&&(g=1/Math.sqrt(g),a[0]=b[0]*g,a[1]=b[1]*g,a[2]=b[2]*g,a[3]=b[3]*g),a},h.dot=function(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},h.lerp=function(a,b,c,d){var e=b[0],f=b[1],g=b[2],h=b[3];return a[0]=e+d*(c[0]-e),a[1]=f+d*(c[1]-f),a[2]=g+d*(c[2]-g),a[3]=h+d*(c[3]-h),a},h.random=function(a,b){return b=b||1,a[0]=d(),a[1]=d(),a[2]=d(),a[3]=d(),h.normalize(a,a),h.scale(a,a,b),a},h.transformMat4=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3];return a[0]=c[0]*d+c[4]*e+c[8]*f+c[12]*g,a[1]=c[1]*d+c[5]*e+c[9]*f+c[13]*g,a[2]=c[2]*d+c[6]*e+c[10]*f+c[14]*g,a[3]=c[3]*d+c[7]*e+c[11]*f+c[15]*g,a},h.transformQuat=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=c[0],h=c[1],i=c[2],j=c[3],k=j*d+h*f-i*e,l=j*e+i*d-g*f,m=j*f+g*e-h*d,n=-g*d-h*e-i*f;return a[0]=k*j+n*-g+l*-i-m*-h,a[1]=l*j+n*-h+m*-g-k*-i,a[2]=m*j+n*-i+k*-h-l*-g,a},h.forEach=function(){var a=h.create();return function(b,c,d,e,f,g){var h,i;for(c||(c=4),d||(d=0),i=e?Math.min(e*c+d,b.length):b.length,h=d;i>h;h+=c)a[0]=b[h],a[1]=b[h+1],a[2]=b[h+2],a[3]=b[h+3],f(a,a,g),b[h]=a[0],b[h+1]=a[1],b[h+2]=a[2],b[h+3]=a[3];
return b}}(),h.str=function(a){return"vec4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},"undefined"!=typeof a&&(a.vec4=h);var i={};i.create=function(){var a=new c(4);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},i.clone=function(a){var b=new c(4);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b},i.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a},i.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a},i.transpose=function(a,b){if(a===b){var c=b[1];a[1]=b[2],a[2]=c}else a[0]=b[0],a[1]=b[2],a[2]=b[1],a[3]=b[3];return a},i.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*f-e*d;return g?(g=1/g,a[0]=f*g,a[1]=-d*g,a[2]=-e*g,a[3]=c*g,a):null},i.adjoint=function(a,b){var c=b[0];return a[0]=b[3],a[1]=-b[1],a[2]=-b[2],a[3]=c,a},i.determinant=function(a){return a[0]*a[3]-a[2]*a[1]},i.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1],j=c[2],k=c[3];return a[0]=d*h+e*j,a[1]=d*i+e*k,a[2]=f*h+g*j,a[3]=f*i+g*k,a},i.mul=i.multiply,i.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+e*h,a[1]=d*-h+e*i,a[2]=f*i+g*h,a[3]=f*-h+g*i,a},i.scale=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1];return a[0]=d*h,a[1]=e*i,a[2]=f*h,a[3]=g*i,a},i.str=function(a){return"mat2("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},"undefined"!=typeof a&&(a.mat2=i);var j={};j.create=function(){var a=new c(6);return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},j.clone=function(a){var b=new c(6);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b},j.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a},j.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=1,a[4]=0,a[5]=0,a},j.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=c*f-d*e;return i?(i=1/i,a[0]=f*i,a[1]=-d*i,a[2]=-e*i,a[3]=c*i,a[4]=(e*h-f*g)*i,a[5]=(d*g-c*h)*i,a):null},j.determinant=function(a){return a[0]*a[3]-a[1]*a[2]},j.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=c[0],k=c[1],l=c[2],m=c[3],n=c[4],o=c[5];return a[0]=d*j+e*l,a[1]=d*k+e*m,a[2]=f*j+g*l,a[3]=f*k+g*m,a[4]=j*h+l*i+n,a[5]=k*h+m*i+o,a},j.mul=j.multiply,j.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=Math.sin(c),k=Math.cos(c);return a[0]=d*k+e*j,a[1]=-d*j+e*k,a[2]=f*k+g*j,a[3]=-f*j+k*g,a[4]=k*h+j*i,a[5]=k*i-j*h,a},j.scale=function(a,b,c){var d=c[0],e=c[1];return a[0]=b[0]*d,a[1]=b[1]*e,a[2]=b[2]*d,a[3]=b[3]*e,a[4]=b[4]*d,a[5]=b[5]*e,a},j.translate=function(a,b,c){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4]+c[0],a[5]=b[5]+c[1],a},j.str=function(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"},"undefined"!=typeof a&&(a.mat2d=j);var k={};k.create=function(){var a=new c(9);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},k.fromMat4=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[4],a[4]=b[5],a[5]=b[6],a[6]=b[8],a[7]=b[9],a[8]=b[10],a},k.clone=function(a){var b=new c(9);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},k.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},k.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},k.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[5];a[1]=b[3],a[2]=b[6],a[3]=c,a[5]=b[7],a[6]=d,a[7]=e}else a[0]=b[0],a[1]=b[3],a[2]=b[6],a[3]=b[1],a[4]=b[4],a[5]=b[7],a[6]=b[2],a[7]=b[5],a[8]=b[8];return a},k.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=k*g-h*j,m=-k*f+h*i,n=j*f-g*i,o=c*l+d*m+e*n;return o?(o=1/o,a[0]=l*o,a[1]=(-k*d+e*j)*o,a[2]=(h*d-e*g)*o,a[3]=m*o,a[4]=(k*c-e*i)*o,a[5]=(-h*c+e*f)*o,a[6]=n*o,a[7]=(-j*c+d*i)*o,a[8]=(g*c-d*f)*o,a):null},k.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8];return a[0]=g*k-h*j,a[1]=e*j-d*k,a[2]=d*h-e*g,a[3]=h*i-f*k,a[4]=c*k-e*i,a[5]=e*f-c*h,a[6]=f*j-g*i,a[7]=d*i-c*j,a[8]=c*g-d*f,a},k.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8];return b*(j*f-g*i)+c*(-j*e+g*h)+d*(i*e-f*h)},k.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},k.mul=k.multiply,k.translate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1];return a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=m*d+n*g+j,a[7]=m*e+n*h+k,a[8]=m*f+n*i+l,a},k.rotate=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=Math.sin(c),n=Math.cos(c);return a[0]=n*d+m*g,a[1]=n*e+m*h,a[2]=n*f+m*i,a[3]=n*g-m*d,a[4]=n*h-m*e,a[5]=n*i-m*f,a[6]=j,a[7]=k,a[8]=l,a},k.scale=function(a,b,c){var d=c[0],e=c[1];return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=e*b[3],a[4]=e*b[4],a[5]=e*b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a},k.fromMat2d=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=0,a[3]=b[2],a[4]=b[3],a[5]=0,a[6]=b[4],a[7]=b[5],a[8]=1,a},k.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-(m+o),a[3]=k+r,a[6]=l-q,a[1]=k-r,a[4]=1-(j+o),a[7]=n+p,a[2]=l+q,a[5]=n-p,a[8]=1-(j+m),a},k.normalFromMat4=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(i*A-g*D-j*z)*E,a[2]=(g*C-h*A+j*y)*E,a[3]=(e*C-d*D-f*B)*E,a[4]=(c*D-e*A+f*z)*E,a[5]=(d*A-c*C-f*y)*E,a[6]=(p*x-q*w+r*v)*E,a[7]=(q*u-o*x-r*t)*E,a[8]=(o*w-p*u+r*s)*E,a):null},k.str=function(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"},"undefined"!=typeof a&&(a.mat3=k);var l={};l.create=function(){var a=new c(16);return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.clone=function(a){var b=new c(16);return b[0]=a[0],b[1]=a[1],b[2]=a[2],b[3]=a[3],b[4]=a[4],b[5]=a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b[9]=a[9],b[10]=a[10],b[11]=a[11],b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},l.copy=function(a,b){return a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},l.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.transpose=function(a,b){if(a===b){var c=b[1],d=b[2],e=b[3],f=b[6],g=b[7],h=b[11];a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=c,a[6]=b[9],a[7]=b[13],a[8]=d,a[9]=f,a[11]=b[14],a[12]=e,a[13]=g,a[14]=h}else a[0]=b[0],a[1]=b[4],a[2]=b[8],a[3]=b[12],a[4]=b[1],a[5]=b[5],a[6]=b[9],a[7]=b[13],a[8]=b[2],a[9]=b[6],a[10]=b[10],a[11]=b[14],a[12]=b[3],a[13]=b[7],a[14]=b[11],a[15]=b[15];return a},l.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15],s=c*h-d*g,t=c*i-e*g,u=c*j-f*g,v=d*i-e*h,w=d*j-f*h,x=e*j-f*i,y=k*p-l*o,z=k*q-m*o,A=k*r-n*o,B=l*q-m*p,C=l*r-n*p,D=m*r-n*q,E=s*D-t*C+u*B+v*A-w*z+x*y;return E?(E=1/E,a[0]=(h*D-i*C+j*B)*E,a[1]=(e*C-d*D-f*B)*E,a[2]=(p*x-q*w+r*v)*E,a[3]=(m*w-l*x-n*v)*E,a[4]=(i*A-g*D-j*z)*E,a[5]=(c*D-e*A+f*z)*E,a[6]=(q*u-o*x-r*t)*E,a[7]=(k*x-m*u+n*t)*E,a[8]=(g*C-h*A+j*y)*E,a[9]=(d*A-c*C-f*y)*E,a[10]=(o*w-p*u+r*s)*E,a[11]=(l*u-k*w-n*s)*E,a[12]=(h*z-g*B-i*y)*E,a[13]=(c*B-d*z+e*y)*E,a[14]=(p*t-o*v-q*s)*E,a[15]=(k*v-l*t+m*s)*E,a):null},l.adjoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=b[4],h=b[5],i=b[6],j=b[7],k=b[8],l=b[9],m=b[10],n=b[11],o=b[12],p=b[13],q=b[14],r=b[15];return a[0]=h*(m*r-n*q)-l*(i*r-j*q)+p*(i*n-j*m),a[1]=-(d*(m*r-n*q)-l*(e*r-f*q)+p*(e*n-f*m)),a[2]=d*(i*r-j*q)-h*(e*r-f*q)+p*(e*j-f*i),a[3]=-(d*(i*n-j*m)-h*(e*n-f*m)+l*(e*j-f*i)),a[4]=-(g*(m*r-n*q)-k*(i*r-j*q)+o*(i*n-j*m)),a[5]=c*(m*r-n*q)-k*(e*r-f*q)+o*(e*n-f*m),a[6]=-(c*(i*r-j*q)-g*(e*r-f*q)+o*(e*j-f*i)),a[7]=c*(i*n-j*m)-g*(e*n-f*m)+k*(e*j-f*i),a[8]=g*(l*r-n*p)-k*(h*r-j*p)+o*(h*n-j*l),a[9]=-(c*(l*r-n*p)-k*(d*r-f*p)+o*(d*n-f*l)),a[10]=c*(h*r-j*p)-g*(d*r-f*p)+o*(d*j-f*h),a[11]=-(c*(h*n-j*l)-g*(d*n-f*l)+k*(d*j-f*h)),a[12]=-(g*(l*q-m*p)-k*(h*q-i*p)+o*(h*m-i*l)),a[13]=c*(l*q-m*p)-k*(d*q-e*p)+o*(d*m-e*l),a[14]=-(c*(h*q-i*p)-g*(d*q-e*p)+o*(d*i-e*h)),a[15]=c*(h*m-i*l)-g*(d*m-e*l)+k*(d*i-e*h),a},l.determinant=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p;return r*C-s*B+t*A+u*z-v*y+w*x},l.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},l.mul=l.multiply,l.translate=function(a,b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p=c[0],q=c[1],r=c[2];return b===a?(a[12]=b[0]*p+b[4]*q+b[8]*r+b[12],a[13]=b[1]*p+b[5]*q+b[9]*r+b[13],a[14]=b[2]*p+b[6]*q+b[10]*r+b[14],a[15]=b[3]*p+b[7]*q+b[11]*r+b[15]):(d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],a[0]=d,a[1]=e,a[2]=f,a[3]=g,a[4]=h,a[5]=i,a[6]=j,a[7]=k,a[8]=l,a[9]=m,a[10]=n,a[11]=o,a[12]=d*p+h*q+l*r+b[12],a[13]=e*p+i*q+m*r+b[13],a[14]=f*p+j*q+n*r+b[14],a[15]=g*p+k*q+o*r+b[15]),a},l.scale=function(a,b,c){var d=c[0],e=c[1],f=c[2];return a[0]=b[0]*d,a[1]=b[1]*d,a[2]=b[2]*d,a[3]=b[3]*d,a[4]=b[4]*e,a[5]=b[5]*e,a[6]=b[6]*e,a[7]=b[7]*e,a[8]=b[8]*f,a[9]=b[9]*f,a[10]=b[10]*f,a[11]=b[11]*f,a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15],a},l.rotate=function(a,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D=e[0],E=e[1],F=e[2],G=Math.sqrt(D*D+E*E+F*F);return Math.abs(G)<b?null:(G=1/G,D*=G,E*=G,F*=G,f=Math.sin(d),g=Math.cos(d),h=1-g,i=c[0],j=c[1],k=c[2],l=c[3],m=c[4],n=c[5],o=c[6],p=c[7],q=c[8],r=c[9],s=c[10],t=c[11],u=D*D*h+g,v=E*D*h+F*f,w=F*D*h-E*f,x=D*E*h-F*f,y=E*E*h+g,z=F*E*h+D*f,A=D*F*h+E*f,B=E*F*h-D*f,C=F*F*h+g,a[0]=i*u+m*v+q*w,a[1]=j*u+n*v+r*w,a[2]=k*u+o*v+s*w,a[3]=l*u+p*v+t*w,a[4]=i*x+m*y+q*z,a[5]=j*x+n*y+r*z,a[6]=k*x+o*y+s*z,a[7]=l*x+p*y+t*z,a[8]=i*A+m*B+q*C,a[9]=j*A+n*B+r*C,a[10]=k*A+o*B+s*C,a[11]=l*A+p*B+t*C,c!==a&&(a[12]=c[12],a[13]=c[13],a[14]=c[14],a[15]=c[15]),a)},l.rotateX=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[4],g=b[5],h=b[6],i=b[7],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[0]=b[0],a[1]=b[1],a[2]=b[2],a[3]=b[3],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[4]=f*e+j*d,a[5]=g*e+k*d,a[6]=h*e+l*d,a[7]=i*e+m*d,a[8]=j*e-f*d,a[9]=k*e-g*d,a[10]=l*e-h*d,a[11]=m*e-i*d,a},l.rotateY=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[8],k=b[9],l=b[10],m=b[11];return b!==a&&(a[4]=b[4],a[5]=b[5],a[6]=b[6],a[7]=b[7],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e-j*d,a[1]=g*e-k*d,a[2]=h*e-l*d,a[3]=i*e-m*d,a[8]=f*d+j*e,a[9]=g*d+k*e,a[10]=h*d+l*e,a[11]=i*d+m*e,a},l.rotateZ=function(a,b,c){var d=Math.sin(c),e=Math.cos(c),f=b[0],g=b[1],h=b[2],i=b[3],j=b[4],k=b[5],l=b[6],m=b[7];return b!==a&&(a[8]=b[8],a[9]=b[9],a[10]=b[10],a[11]=b[11],a[12]=b[12],a[13]=b[13],a[14]=b[14],a[15]=b[15]),a[0]=f*e+j*d,a[1]=g*e+k*d,a[2]=h*e+l*d,a[3]=i*e+m*d,a[4]=j*e-f*d,a[5]=k*e-g*d,a[6]=l*e-h*d,a[7]=m*e-i*d,a},l.fromRotationTranslation=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=d+d,i=e+e,j=f+f,k=d*h,l=d*i,m=d*j,n=e*i,o=e*j,p=f*j,q=g*h,r=g*i,s=g*j;return a[0]=1-(n+p),a[1]=l+s,a[2]=m-r,a[3]=0,a[4]=l-s,a[5]=1-(k+p),a[6]=o+q,a[7]=0,a[8]=m+r,a[9]=o-q,a[10]=1-(k+n),a[11]=0,a[12]=c[0],a[13]=c[1],a[14]=c[2],a[15]=1,a},l.fromQuat=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c+c,h=d+d,i=e+e,j=c*g,k=c*h,l=c*i,m=d*h,n=d*i,o=e*i,p=f*g,q=f*h,r=f*i;return a[0]=1-(m+o),a[1]=k+r,a[2]=l-q,a[3]=0,a[4]=k-r,a[5]=1-(j+o),a[6]=n+p,a[7]=0,a[8]=l+q,a[9]=n-p,a[10]=1-(j+m),a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},l.frustum=function(a,b,c,d,e,f,g){var h=1/(c-b),i=1/(e-d),j=1/(f-g);return a[0]=2*f*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*f*i,a[6]=0,a[7]=0,a[8]=(c+b)*h,a[9]=(e+d)*i,a[10]=(g+f)*j,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*g*f*j,a[15]=0,a},l.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},l.ortho=function(a,b,c,d,e,f,g){var h=1/(b-c),i=1/(d-e),j=1/(f-g);return a[0]=-2*h,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=-2*i,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2*j,a[11]=0,a[12]=(b+c)*h,a[13]=(e+d)*i,a[14]=(g+f)*j,a[15]=1,a},l.lookAt=function(a,c,d,e){var f,g,h,i,j,k,m,n,o,p,q=c[0],r=c[1],s=c[2],t=e[0],u=e[1],v=e[2],w=d[0],x=d[1],y=d[2];return Math.abs(q-w)<b&&Math.abs(r-x)<b&&Math.abs(s-y)<b?l.identity(a):(m=q-w,n=r-x,o=s-y,p=1/Math.sqrt(m*m+n*n+o*o),m*=p,n*=p,o*=p,f=u*o-v*n,g=v*m-t*o,h=t*n-u*m,p=Math.sqrt(f*f+g*g+h*h),p?(p=1/p,f*=p,g*=p,h*=p):(f=0,g=0,h=0),i=n*h-o*g,j=o*f-m*h,k=m*g-n*f,p=Math.sqrt(i*i+j*j+k*k),p?(p=1/p,i*=p,j*=p,k*=p):(i=0,j=0,k=0),a[0]=f,a[1]=i,a[2]=m,a[3]=0,a[4]=g,a[5]=j,a[6]=n,a[7]=0,a[8]=h,a[9]=k,a[10]=o,a[11]=0,a[12]=-(f*q+g*r+h*s),a[13]=-(i*q+j*r+k*s),a[14]=-(m*q+n*r+o*s),a[15]=1,a)},l.str=function(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"},"undefined"!=typeof a&&(a.mat4=l);var m={};m.create=function(){var a=new c(4);return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},m.rotationTo=function(){var a=g.create(),b=g.fromValues(1,0,0),c=g.fromValues(0,1,0);return function(d,e,f){var h=g.dot(e,f);return-.999999>h?(g.cross(a,b,e),g.length(a)<1e-6&&g.cross(a,c,e),g.normalize(a,a),m.setAxisAngle(d,a,Math.PI),d):h>.999999?(d[0]=0,d[1]=0,d[2]=0,d[3]=1,d):(g.cross(a,e,f),d[0]=a[0],d[1]=a[1],d[2]=a[2],d[3]=1+h,m.normalize(d,d))}}(),m.setAxes=function(){var a=k.create();return function(b,c,d,e){return a[0]=d[0],a[3]=d[1],a[6]=d[2],a[1]=e[0],a[4]=e[1],a[7]=e[2],a[2]=c[0],a[5]=c[1],a[8]=c[2],m.normalize(b,m.fromMat3(b,a))}}(),m.clone=h.clone,m.fromValues=h.fromValues,m.copy=h.copy,m.set=h.set,m.identity=function(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a},m.setAxisAngle=function(a,b,c){c*=.5;var d=Math.sin(c);return a[0]=d*b[0],a[1]=d*b[1],a[2]=d*b[2],a[3]=Math.cos(c),a},m.add=h.add,m.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=c[0],i=c[1],j=c[2],k=c[3];return a[0]=d*k+g*h+e*j-f*i,a[1]=e*k+g*i+f*h-d*j,a[2]=f*k+g*j+d*i-e*h,a[3]=g*k-d*h-e*i-f*j,a},m.mul=m.multiply,m.scale=h.scale,m.rotateX=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+g*h,a[1]=e*i+f*h,a[2]=f*i-e*h,a[3]=g*i-d*h,a},m.rotateY=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i-f*h,a[1]=e*i+g*h,a[2]=f*i+d*h,a[3]=g*i-e*h,a},m.rotateZ=function(a,b,c){c*=.5;var d=b[0],e=b[1],f=b[2],g=b[3],h=Math.sin(c),i=Math.cos(c);return a[0]=d*i+e*h,a[1]=e*i-d*h,a[2]=f*i+g*h,a[3]=g*i-f*h,a},m.calculateW=function(a,b){var c=b[0],d=b[1],e=b[2];return a[0]=c,a[1]=d,a[2]=e,a[3]=-Math.sqrt(Math.abs(1-c*c-d*d-e*e)),a},m.dot=h.dot,m.lerp=h.lerp,m.slerp=function(a,b,c,d){var e,f,g,h,i,j=b[0],k=b[1],l=b[2],m=b[3],n=c[0],o=c[1],p=c[2],q=c[3];return f=j*n+k*o+l*p+m*q,0>f&&(f=-f,n=-n,o=-o,p=-p,q=-q),1-f>1e-6?(e=Math.acos(f),g=Math.sin(e),h=Math.sin((1-d)*e)/g,i=Math.sin(d*e)/g):(h=1-d,i=d),a[0]=h*j+i*n,a[1]=h*k+i*o,a[2]=h*l+i*p,a[3]=h*m+i*q,a},m.invert=function(a,b){var c=b[0],d=b[1],e=b[2],f=b[3],g=c*c+d*d+e*e+f*f,h=g?1/g:0;return a[0]=-c*h,a[1]=-d*h,a[2]=-e*h,a[3]=f*h,a},m.conjugate=function(a,b){return a[0]=-b[0],a[1]=-b[1],a[2]=-b[2],a[3]=b[3],a},m.length=h.length,m.len=m.length,m.squaredLength=h.squaredLength,m.sqrLen=m.squaredLength,m.normalize=h.normalize,m.fromMat3=function(){var a="undefined"!=typeof Int8Array?new Int8Array([1,2,0]):[1,2,0];return function(b,c){var d,e=c[0]+c[4]+c[8];if(e>0)d=Math.sqrt(e+1),b[3]=.5*d,d=.5/d,b[0]=(c[7]-c[5])*d,b[1]=(c[2]-c[6])*d,b[2]=(c[3]-c[1])*d;else{var f=0;c[4]>c[0]&&(f=1),c[8]>c[3*f+f]&&(f=2);var g=a[f],h=a[g];d=Math.sqrt(c[3*f+f]-c[3*g+g]-c[3*h+h]+1),b[f]=.5*d,d=.5/d,b[3]=(c[3*h+g]-c[3*g+h])*d,b[g]=(c[3*g+f]+c[3*f+g])*d,b[h]=(c[3*h+f]+c[3*f+h])*d}return b}}(),m.str=function(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"},"undefined"!=typeof a&&(a.quat=m)}(b.exports)}(this),function(){Object.create=Object.create||function(a){function b(){}return b.prototype=a,new b};var a;"undefined"==typeof exports?(a={},"object"==typeof window&&(window.cp=a)):a=exports;var b,c,d=function(a,b){if(!a)throw new Error("Assertion failed: "+b)},e=function(a,b){!a&&console&&console.warn&&(console.warn("ASSERTION FAILED: "+b),console.trace&&console.trace())},f=function(a,b){return b>a?a:b},g=function(a,b){return a>b?a:b};"object"==typeof window&&window.navigator.userAgent.indexOf("Firefox")>-1?(b=Math.min,c=Math.max):(b=f,c=g);var h=function(a,b){return b>a?a+" "+b:b+" "+a},i=function(a,b){for(var c=0;c<a.length;c++)if(a[c]===b)return a[c]=a[a.length-1],a.length--,void 0},j=function(a,b,c){var d=y(b,c),e=q(t(d,y(a,c))/H(d));return x(c,A(d,e))},k=function(a,b,c,d,e,f){var g=c-e,h=d-f,i=q(u(g,h,a-e,b-f)/I(g,h));return new r(e+g*i,f+h*i)};a.momentForCircle=function(a,b,c,d){return a*(.5*(b*b+c*c)+H(d))},a.areaForCircle=function(a,b){return Math.PI*Math.abs(a*a-b*b)},a.momentForSegment=function(a,b,c){var d=A(x(b,c),.5);return a*(O(c,b)/12+H(d))},a.areaForSegment=function(a,b,c){return c*(Math.PI*c+2*N(a,b))},a.momentForPoly=function(a,b,c){for(var d=0,e=0,f=b.length,g=0;f>g;g+=2){var h=b[g]+c.x,i=b[g+1]+c.y,j=b[(g+2)%f]+c.x,k=b[(g+3)%f]+c.y,l=C(j,k,h,i),m=u(h,i,h,i)+u(h,i,j,k)+u(j,k,j,k);d+=l*m,e+=l}return a*d/(6*e)},a.areaForPoly=function(a){for(var b=0,c=0,d=a.length;d>c;c+=2)b+=B(new r(a[c],a[c+1]),new r(a[(c+2)%d],a[(c+3)%d]));return-b/2},a.centroidForPoly=function(a){for(var b=0,c=new r(0,0),d=0,e=a.length;e>d;d+=2){var f=new r(a[d],a[d+1]),g=new r(a[(d+2)%e],a[(d+3)%e]),h=B(f,g);b+=h,c=x(c,A(x(f,g),h))}return A(c,1/(3*b))},a.recenterPoly=function(b){for(var c=a.centroidForPoly(b),d=0;d<b.length;d+=2)b[d]-=c.x,b[d+1]-=c.y},a.momentForBox=function(a,b,c){return a*(b*b+c*c)/12},a.momentForBox2=function(b,c){var d=c.r-c.l,e=c.t-c.b,f=A([c.l+c.r,c.b+c.t],.5);return a.momentForBox(b,d,e)+b*H(f)};var l=a.loopIndexes=function(a){var b,c,d,e,f=0,g=0;b=d=a[0],c=e=a[1];for(var h=a.length>>1,i=1;h>i;i++){var j=a[2*i],k=a[2*i+1];b>j||j==b&&c>k?(b=j,c=k,f=i):(j>d||j==d&&k>e)&&(d=j,e=k,g=i)}return[f,g]},m=function(a,b,c){var d=a[2*b];a[2*b]=a[2*c],a[2*c]=d,d=a[2*b+1],a[2*b+1]=a[2*c+1],a[2*c+1]=d},n=function(a,b,c,d,e,f){if(0===c)return 0;for(var g=0,h=b,i=y(e,d),j=f*v(i),k=b,l=b+c-1;l>=k;){var n=new r(a[2*k],a[2*k+1]),o=B(i,y(n,d));o>j?(o>g&&(g=o,h=k),k++):(m(a,k,l),l--)}return h!=b&&m(a,b,h),k-b},o=function(a,b,c,d,e,f,g,h){if(0>d)return 0;if(0==d)return b[2*h]=f.x,b[2*h+1]=f.y,1;var i=n(b,c,d,e,f,a),j=new r(b[2*c],b[2*c+1]),k=o(a,b,c+1,i-1,e,j,f,h),l=h+k++;b[2*l]=f.x,b[2*l+1]=f.y;var m=n(b,c+i,d-i,f,g,a),p=new r(b[2*(c+i)],b[2*(c+i)+1]);return k+o(a,b,c+i+1,m-1,f,p,g,h+k)};a.convexHull=function(a,b,c){if(b)for(var d=0;d<a.length;d++)b[d]=a[d];else b=a;var f=l(a),g=f[0],h=f[1];if(g==h)return b.length=2,b;m(b,0,g),m(b,1,0==h?g:h);var i=new r(b[0],b[1]),j=new r(b[2],b[3]),k=a.length>>1,n=o(c,b,2,k-2,i,j,i,1)+1;return b.length=2*n,e(ab(b),"Internal error: cpConvexHull() and cpPolyValidate() did not agree.Please report this error with as much info as you can."),b};var p=function(a,d,e){return b(c(a,d),e)},q=function(a){return c(0,b(a,1))},r=a.Vect=function(a,b){this.x=a,this.y=b};a.v=function(a,b){return new r(a,b)};var s=a.vzero=new r(0,0),t=a.v.dot=function(a,b){return a.x*b.x+a.y*b.y},u=function(a,b,c,d){return a*c+b*d},v=a.v.len=function(a){return Math.sqrt(t(a,a))},w=a.v.len2=function(a,b){return Math.sqrt(a*a+b*b)};a.v.eql=function(a,b){return a.x===b.x&&a.y===b.y};var x=a.v.add=function(a,b){return new r(a.x+b.x,a.y+b.y)};r.prototype.add=function(a){return this.x+=a.x,this.y+=a.y,this};var y=a.v.sub=function(a,b){return new r(a.x-b.x,a.y-b.y)};r.prototype.sub=function(a){return this.x-=a.x,this.y-=a.y,this};var z=a.v.neg=function(a){return new r(-a.x,-a.y)};r.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};var A=a.v.mult=function(a,b){return new r(a.x*b,a.y*b)};r.prototype.mult=function(a){return this.x*=a,this.y*=a,this};var B=a.v.cross=function(a,b){return a.x*b.y-a.y*b.x},C=function(a,b,c,d){return a*d-b*c},D=a.v.perp=function(a){return new r(-a.y,a.x)};a.v.pvrperp=function(a){return new r(a.y,-a.x)};var E=a.v.project=function(a,b){return A(b,t(a,b)/H(b))};r.prototype.project=function(a){return this.mult(t(this,a)/H(a)),this};var F=a.v.rotate=function(a,b){return new r(a.x*b.x-a.y*b.y,a.x*b.y+a.y*b.x)};r.prototype.rotate=function(a){return this.x=this.x*a.x-this.y*a.y,this.y=this.x*a.y+this.y*a.x,this};var G=a.v.unrotate=function(a,b){return new r(a.x*b.x+a.y*b.y,a.y*b.x-a.x*b.y)},H=a.v.lengthsq=function(a){return t(a,a)},I=a.v.lengthsq2=function(a,b){return a*a+b*b},J=a.v.lerp=function(a,b,c){return x(A(a,1-c),A(b,c))},K=a.v.normalize=function(a){return A(a,1/v(a))},L=a.v.normalize_safe=function(a){return 0===a.x&&0===a.y?s:K(a)},M=a.v.clamp=function(a,b){return t(a,a)>b*b?A(K(a),b):a};a.v.lerpconst=function(a,b,c){return x(a,M(y(b,a),c))};var N=a.v.dist=function(a,b){return v(y(a,b))},O=a.v.distsq=function(a,b){return H(y(a,b))};a.v.near=function(a,b,c){return O(a,b)<c*c};var P=a.v.slerp=function(a,b,c){var d=Math.acos(t(a,b));if(d){var e=1/Math.sin(d);return x(A(a,Math.sin((1-c)*d)*e),A(b,Math.sin(c*d)*e))}return a};a.v.slerpconst=function(a,c,d){var e=Math.acos(t(a,c));return P(a,c,b(d,e)/e)},a.v.forangle=function(a){return new r(Math.cos(a),Math.sin(a))},a.v.toangle=function(a){return Math.atan2(a.y,a.x)},a.v.str=function(a){return"("+a.x.toFixed(3)+", "+a.y.toFixed(3)+")"};var Q=0,R=a.BB=function(a,b,c,d){this.l=a,this.b=b,this.r=c,this.t=d,Q++};a.bb=function(a,b,c,d){return new R(a,b,c,d)};var S=function(a,b){return new R(a.x-b,a.y-b,a.x+b,a.y+b)},T=function(a,b,c,d,e){return a.l<=d&&b<=a.r&&a.b<=e&&c<=a.t},U=0;a.NO_GROUP=0;var V=a.ALL_LAYERS=-1;a.resetShapeIdCounter=function(){U=0};var W=a.Shape=function(a){this.body=a,this.bb_l=this.bb_b=this.bb_r=this.bb_t=0,this.hashid=U++,this.sensor=!1,this.e=0,this.u=0,this.surface_v=s,this.collision_type=0,this.group=0,this.layers=V,this.space=null,this.collisionCode=this.collisionCode};W.prototype.setElasticity=function(a){this.e=a},W.prototype.setFriction=function(a){this.body.activate(),this.u=a},W.prototype.setLayers=function(a){this.body.activate(),this.layers=a},W.prototype.setSensor=function(a){this.body.activate(),this.sensor=a},W.prototype.setCollisionType=function(a){this.body.activate(),this.collision_type=a},W.prototype.getBody=function(){return this.body},W.prototype.active=function(){return this.body&&-1!==this.body.shapeList.indexOf(this)},W.prototype.setBody=function(a){d(!this.active(),"You cannot change the body on an active shape. You must remove the shape from the space before changing the body."),this.body=a},W.prototype.cacheBB=function(){return this.update(this.body.p,this.body.rot)},W.prototype.update=function(a,b){d(!isNaN(b.x),"Rotation is NaN"),d(!isNaN(a.x),"Position is NaN"),this.cacheData(a,b)},W.prototype.pointQuery=function(a){var b=this.nearestPointQuery(a);return b.d<0?b:void 0},W.prototype.getBB=function(){return new R(this.bb_l,this.bb_b,this.bb_r,this.bb_t)};var X=function(a,b,c){this.shape=a,this.p=b,this.d=c},Y=function(a,b,c){this.shape=a,this.t=b,this.n=c};Y.prototype.hitPoint=function(a,b){return J(a,b,this.t)},Y.prototype.hitDist=function(a,b){return N(a,b)*this.t};var Z=a.CircleShape=function(a,b,c){this.c=this.tc=c,this.r=b,this.type="circle",W.call(this,a)};Z.prototype=Object.create(W.prototype),Z.prototype.cacheData=function(a,b){var c=this.tc=F(this.c,b).add(a),d=this.r;this.bb_l=c.x-d,this.bb_b=c.y-d,this.bb_r=c.x+d,this.bb_t=c.y+d},Z.prototype.nearestPointQuery=function(a){var b=a.x-this.tc.x,c=a.y-this.tc.y,d=w(b,c),e=this.r,f=new r(this.tc.x+b*e/d,this.tc.y+c*e/d);return new X(this,f,d-e)};var $=function(a,b,c,d,e){d=y(d,b),e=y(e,b);var f=t(d,d)-2*t(d,e)+t(e,e),g=-2*t(d,d)+2*t(d,e),h=t(d,d)-c*c,i=g*g-4*f*h;if(i>=0){var j=(-g-Math.sqrt(i))/(2*f);if(j>=0&&1>=j)return new Y(a,j,K(J(d,e,j)))}};Z.prototype.segmentQuery=function(a,b){return $(this,this.tc,this.r,a,b)};var _=a.SegmentShape=function(a,b,c,d){this.a=b,this.b=c,this.n=D(K(y(c,b))),this.ta=this.tb=this.tn=null,this.r=d,this.a_tangent=s,this.b_tangent=s,this.type="segment",W.call(this,a)};_.prototype=Object.create(W.prototype),_.prototype.cacheData=function(a,b){this.ta=x(a,F(this.a,b)),this.tb=x(a,F(this.b,b)),this.tn=F(this.n,b);var c,d,e,f;this.ta.x<this.tb.x?(c=this.ta.x,d=this.tb.x):(c=this.tb.x,d=this.ta.x),this.ta.y<this.tb.y?(e=this.ta.y,f=this.tb.y):(e=this.tb.y,f=this.ta.y);var g=this.r;this.bb_l=c-g,this.bb_b=e-g,this.bb_r=d+g,this.bb_t=f+g},_.prototype.nearestPointQuery=function(a){var b=j(a,this.ta,this.tb),c=a.x-b.x,d=a.y-b.y,e=w(c,d),f=this.r,g=e?x(b,A(new r(c,d),f/e)):b;return new X(this,g,e-f)},_.prototype.segmentQuery=function(a,b){var c=this.tn,d=t(y(this.ta,a),c),e=this.r,f=d>0?z(c):c,g=y(A(f,e),a),h=x(this.ta,g),i=x(this.tb,g),j=y(b,a);if(B(j,h)*B(j,i)<=0){var k=d+(d>0?-e:e),l=-k,m=t(j,c)-k;if(0>l*m)return new Y(this,l/(l-m),f)}else if(0!==e){var n=$(this,this.ta,this.r,a,b),o=$(this,this.tb,this.r,a,b);return n?o&&o.t<n.t?o:n:o}},_.prototype.setNeighbors=function(a,b){this.a_tangent=y(a,this.a),this.b_tangent=y(b,this.b)},_.prototype.setEndpoints=function(a,b){this.a=a,this.b=b,this.n=D(K(y(b,a)))};var ab=function(a){for(var b=a.length,c=0;b>c;c+=2){var d=a[c],e=a[c+1],f=a[(c+2)%b],g=a[(c+3)%b],h=a[(c+4)%b],i=a[(c+5)%b];if(C(f-d,g-e,h-f,i-g)>0)return!1}return!0},bb=a.PolyShape=function(a,b,c){this.setVerts(b,c),this.type="poly",W.call(this,a)};bb.prototype=Object.create(W.prototype);var cb=function(a,b){this.n=a,this.d=b};cb.prototype.compare=function(a){return t(this.n,a)-this.d},bb.prototype.setVerts=function(a,b){d(a.length>=4,"Polygons require some verts"),d("number"==typeof a[0],"Polygon verticies should be specified in a flattened list (eg [x1,y1,x2,y2,x3,y3,...])"),d(ab(a),"Polygon is concave or has a reversed winding. Consider using cpConvexHull()");var c=a.length,e=c>>1;this.verts=new Array(c),this.tVerts=new Array(c),this.planes=new Array(e),this.tPlanes=new Array(e);for(var f=0;c>f;f+=2){var g=a[f]+b.x,h=a[f+1]+b.y,i=a[(f+2)%c]+b.x,j=a[(f+3)%c]+b.y,k=K(D(new r(i-g,j-h)));this.verts[f]=g,this.verts[f+1]=h,this.planes[f>>1]=new cb(k,u(k.x,k.y,g,h)),this.tPlanes[f>>1]=new cb(new r(0,0),0)}},a.BoxShape=function(a,b,c){var d=b/2,e=c/2;return db(a,new R(-d,-e,d,e))};var db=a.BoxShape2=function(a,b){var c=[b.l,b.b,b.l,b.t,b.r,b.t,b.r,b.b];return new bb(a,c,s)};bb.prototype.transformVerts=function(a,d){for(var e=this.verts,f=this.tVerts,g=1/0,h=-1/0,i=1/0,j=-1/0,k=0;k<e.length;k+=2){var l=e[k],m=e[k+1],n=a.x+l*d.x-m*d.y,o=a.y+l*d.y+m*d.x;f[k]=n,f[k+1]=o,g=b(g,n),h=c(h,n),i=b(i,o),j=c(j,o)}this.bb_l=g,this.bb_b=i,this.bb_r=h,this.bb_t=j},bb.prototype.transformAxes=function(a,b){for(var c=this.planes,d=this.tPlanes,e=0;e<c.length;e++){var f=F(c[e].n,b);d[e].n=f,d[e].d=t(a,f)+c[e].d}},bb.prototype.cacheData=function(a,b){this.transformAxes(a,b),this.transformVerts(a,b)},bb.prototype.nearestPointQuery=function(a){for(var b=this.tPlanes,c=this.tVerts,d=c[c.length-2],e=c[c.length-1],f=1/0,g=s,h=!1,i=0;i<b.length;i++){b[i].compare(a)>0&&(h=!0);var j=c[2*i],l=c[2*i+1],m=k(a.x,a.y,d,e,j,l),n=N(a,m);f>n&&(f=n,g=m),d=j,e=l}return new X(this,g,h?f:-f)},bb.prototype.segmentQuery=function(a,b){for(var c=this.tPlanes,d=this.tVerts,e=c.length,f=2*e,g=0;e>g;g++){var h=c[g].n,i=t(a,h);if(!(c[g].d>i)){var j=t(b,h),k=(c[g].d-i)/(j-i);if(!(0>k||k>1)){var l=J(a,b,k),m=-B(h,l),n=-C(h.x,h.y,d[2*g],d[2*g+1]),o=-C(h.x,h.y,d[(2*g+2)%f],d[(2*g+3)%f]);if(m>=n&&o>=m)return new Y(this,k,h)}}}},bb.prototype.valueOnAxis=function(a,c){for(var d=this.tVerts,e=u(a.x,a.y,d[0],d[1]),f=2;f<d.length;f+=2)e=b(e,u(a.x,a.y,d[f],d[f+1]));return e-c},bb.prototype.containsVert=function(a,b){for(var c=this.tPlanes,d=0;d<c.length;d++){var e=c[d].n,f=u(e.x,e.y,a,b)-c[d].d;if(f>0)return!1}return!0},bb.prototype.containsVertPartial=function(a,b,c){for(var d=this.tPlanes,e=0;e<d.length;e++){var f=d[e].n;if(!(t(f,c)<0)){var g=u(f.x,f.y,a,b)-d[e].d;if(g>0)return!1}}return!0},bb.prototype.getNumVerts=function(){return this.verts.length/2},bb.prototype.getVert=function(a){return new r(this.verts[2*a],this.verts[2*a+1])};var eb=a.Body=function(a,b){this.p=new r(0,0),this.vx=this.vy=0,this.f=new r(0,0),this.w=0,this.t=0,this.v_limit=1/0,this.w_limit=1/0,this.v_biasx=this.v_biasy=0,this.w_bias=0,this.space=null,this.shapeList=[],this.arbiterList=null,this.constraintList=null,this.nodeRoot=null,this.nodeNext=null,this.nodeIdleTime=0,this.setMass(a),this.setMoment(b),this.rot=new r(0,0),this.setAngle(0)};if("undefined"!=typeof DEBUG&&DEBUG){var fb=function(a,b){d(a.x==a.x&&a.y==a.y,b)},gb=function(a,b){d(1/0!==Math.abs(a.x)&&1/0!==Math.abs(a.y),b)},hb=function(a,b){fb(a,b),gb(a,b)};eb.prototype.sanityCheck=function(){d(this.m===this.m&&this.m_inv===this.m_inv,"Body's mass is invalid."),d(this.i===this.i&&this.i_inv===this.i_inv,"Body's moment is invalid."),hb(this.p,"Body's position is invalid."),hb(this.f,"Body's force is invalid."),d(this.vx===this.vx&&1/0!==Math.abs(this.vx),"Body's velocity is invalid."),d(this.vy===this.vy&&1/0!==Math.abs(this.vy),"Body's velocity is invalid."),d(this.a===this.a&&1/0!==Math.abs(this.a),"Body's angle is invalid."),d(this.w===this.w&&1/0!==Math.abs(this.w),"Body's angular velocity is invalid."),d(this.t===this.t&&1/0!==Math.abs(this.t),"Body's torque is invalid."),hb(this.rot,"Body's rotation vector is invalid."),d(this.v_limit===this.v_limit,"Body's velocity limit is invalid."),d(this.w_limit===this.w_limit,"Body's angular velocity limit is invalid.")}}else eb.prototype.sanityCheck=function(){};eb.prototype.getPos=function(){return this.p},eb.prototype.getVel=function(){return new r(this.vx,this.vy)},eb.prototype.getAngVel=function(){return this.w},eb.prototype.isSleeping=function(){return null!==this.nodeRoot},eb.prototype.isStatic=function(){return 1/0===this.nodeIdleTime},eb.prototype.isRogue=function(){return null===this.space},eb.prototype.setMass=function(a){d(a>0,"Mass must be positive and non-zero."),this.activate(),this.m=a,this.m_inv=1/a},eb.prototype.setMoment=function(a){d(a>0,"Moment of Inertia must be positive and non-zero."),this.activate(),this.i=a,this.i_inv=1/a},eb.prototype.addShape=function(a){this.shapeList.push(a)},eb.prototype.removeShape=function(a){i(this.shapeList,a)};var ib=function(a,b,c){return a===c?a.next(b):(a.a===b?a.next_a=ib(a.next_a,b,c):a.next_b=ib(a.next_b,b,c),a)};eb.prototype.removeConstraint=function(a){this.constraintList=ib(this.constraintList,this,a)},eb.prototype.setPos=function(b){this.activate(),this.sanityCheck(),b===s&&(b=a.v(0,0)),this.p=b},eb.prototype.setVel=function(a){this.activate(),this.vx=a.x,this.vy=a.y},eb.prototype.setAngVel=function(a){this.activate(),this.w=a},eb.prototype.setAngleInternal=function(a){d(!isNaN(a),"Internal Error: Attempting to set body's angle to NaN"),this.a=a,this.rot.x=Math.cos(a),this.rot.y=Math.sin(a)
},eb.prototype.setAngle=function(a){this.activate(),this.sanityCheck(),this.setAngleInternal(a)},eb.prototype.velocity_func=function(a,b,c){var d=this.vx*b+(a.x+this.f.x*this.m_inv)*c,e=this.vy*b+(a.y+this.f.y*this.m_inv)*c,f=this.v_limit,g=d*d+e*e,h=g>f*f?f/Math.sqrt(g):1;this.vx=d*h,this.vy=e*h;var i=this.w_limit;this.w=p(this.w*b+this.t*this.i_inv*c,-i,i),this.sanityCheck()},eb.prototype.position_func=function(a){this.p.x+=(this.vx+this.v_biasx)*a,this.p.y+=(this.vy+this.v_biasy)*a,this.setAngleInternal(this.a+(this.w+this.w_bias)*a),this.v_biasx=this.v_biasy=0,this.w_bias=0,this.sanityCheck()},eb.prototype.resetForces=function(){this.activate(),this.f=new r(0,0),this.t=0},eb.prototype.applyForce=function(a,b){this.activate(),this.f=x(this.f,a),this.t+=B(b,a)},eb.prototype.applyImpulse=function(a,b){this.activate(),kc(this,a.x,a.y,b)},eb.prototype.getVelAtPoint=function(a){return x(new r(this.vx,this.vy),A(D(a),this.w))},eb.prototype.getVelAtWorldPoint=function(a){return this.getVelAtPoint(y(a,this.p))},eb.prototype.getVelAtLocalPoint=function(a){return this.getVelAtPoint(F(a,this.rot))},eb.prototype.eachShape=function(a){for(var b=0,c=this.shapeList.length;c>b;b++)a(this.shapeList[b])},eb.prototype.eachConstraint=function(a){for(var b=this.constraintList;b;){var c=b.next(this);a(b),b=c}},eb.prototype.eachArbiter=function(a){for(var b=this.arbiterList;b;){var c=b.next(this);b.swappedColl=this===b.body_b,a(b),b=c}},eb.prototype.local2World=function(a){return x(this.p,F(a,this.rot))},eb.prototype.world2Local=function(a){return G(y(a,this.p),this.rot)},eb.prototype.kineticEnergy=function(){var a=this.vx*this.vx+this.vy*this.vy,b=this.w*this.w;return(a?a*this.m:0)+(b?b*this.i:0)};var jb=a.SpatialIndex=function(a){if(this.staticIndex=a,a){if(a.dynamicIndex)throw new Error("This static index is already associated with a dynamic index.");a.dynamicIndex=this}};jb.prototype.collideStatic=function(a,b){if(a.count>0){var c=a.query;this.each(function(a){c(a,new R(a.bb_l,a.bb_b,a.bb_r,a.bb_t),b)})}};var kb=a.BBTree=function(a){jb.call(this,a),this.velocityFunc=null,this.leaves={},this.count=0,this.root=null,this.pooledNodes=null,this.pooledPairs=null,this.stamp=0};kb.prototype=Object.create(jb.prototype);var lb=0,mb=function(a,d,e){this.obj=null,this.bb_l=b(d.bb_l,e.bb_l),this.bb_b=b(d.bb_b,e.bb_b),this.bb_r=c(d.bb_r,e.bb_r),this.bb_t=c(d.bb_t,e.bb_t),this.parent=null,this.setA(d),this.setB(e)};kb.prototype.makeNode=function(a,b){var c=this.pooledNodes;return c?(this.pooledNodes=c.parent,c.constructor(this,a,b),c):(lb++,new mb(this,a,b))};var nb=0,ob=function(a,b){this.obj=b,a.getBB(b,this),this.parent=null,this.stamp=1,this.pairs=null,nb++};kb.prototype.getBB=function(a,d){var e=this.velocityFunc;if(e){var f=.1,g=(a.bb_r-a.bb_l)*f,h=(a.bb_t-a.bb_b)*f,i=A(e(a),.1);d.bb_l=a.bb_l+b(-g,i.x),d.bb_b=a.bb_b+b(-h,i.y),d.bb_r=a.bb_r+c(g,i.x),d.bb_t=a.bb_t+c(h,i.y)}else d.bb_l=a.bb_l,d.bb_b=a.bb_b,d.bb_r=a.bb_r,d.bb_t=a.bb_t},kb.prototype.getStamp=function(){var a=this.dynamicIndex;return a&&a.stamp?a.stamp:this.stamp},kb.prototype.incrementStamp=function(){this.dynamicIndex&&this.dynamicIndex.stamp?this.dynamicIndex.stamp++:this.stamp++};var pb=0,qb=function(a,b,c,d){this.prevA=null,this.leafA=a,this.nextA=b,this.prevB=null,this.leafB=c,this.nextB=d};kb.prototype.makePair=function(a,b,c,d){var e=this.pooledPairs;return e?(this.pooledPairs=e.prevA,e.prevA=null,e.leafA=a,e.nextA=b,e.prevB=null,e.leafB=c,e.nextB=d,e):(pb++,new qb(a,b,c,d))},qb.prototype.recycle=function(a){this.prevA=a.pooledPairs,a.pooledPairs=this};var rb=function(a,b,c){c&&(c.leafA===b?c.prevA=a:c.prevB=a),a?a.leafA===b?a.nextA=c:a.nextB=c:b.pairs=c};ob.prototype.clearPairs=function(a){var b,c=this.pairs;for(this.pairs=null;c;)c.leafA===this?(b=c.nextA,rb(c.prevB,c.leafB,c.nextB)):(b=c.nextB,rb(c.prevA,c.leafA,c.nextA)),c.recycle(a),c=b};var sb=function(a,b,c){var d=a.pairs,e=b.pairs,f=c.makePair(a,d,b,e);a.pairs=b.pairs=f,d&&(d.leafA===a?d.prevA=f:d.prevB=f),e&&(e.leafA===b?e.prevA=f:e.prevB=f)};mb.prototype.recycle=function(a){this.parent=a.pooledNodes,a.pooledNodes=this},ob.prototype.recycle=function(){},mb.prototype.setA=function(a){this.A=a,a.parent=this},mb.prototype.setB=function(a){this.B=a,a.parent=this},ob.prototype.isLeaf=!0,mb.prototype.isLeaf=!1,mb.prototype.otherChild=function(a){return this.A==a?this.B:this.A},mb.prototype.replaceChild=function(a,d,f){e(a==this.A||a==this.B,"Node is not a child of parent."),this.A==a?(this.A.recycle(f),this.setA(d)):(this.B.recycle(f),this.setB(d));for(var g=this;g;g=g.parent){var h=g.A,i=g.B;g.bb_l=b(h.bb_l,i.bb_l),g.bb_b=b(h.bb_b,i.bb_b),g.bb_r=c(h.bb_r,i.bb_r),g.bb_t=c(h.bb_t,i.bb_t)}},mb.prototype.bbArea=ob.prototype.bbArea=function(){return(this.bb_r-this.bb_l)*(this.bb_t-this.bb_b)};var tb=function(a,d){return(c(a.bb_r,d.bb_r)-b(a.bb_l,d.bb_l))*(c(a.bb_t,d.bb_t)-b(a.bb_b,d.bb_b))},ub=function(a,b){return Math.abs(a.bb_l+a.bb_r-b.bb_l-b.bb_r)+Math.abs(a.bb_b+a.bb_t-b.bb_b-b.bb_t)},vb=function(a,d,e){if(null==a)return d;if(a.isLeaf)return e.makeNode(d,a);var f=a.B.bbArea()+tb(a.A,d),g=a.A.bbArea()+tb(a.B,d);return f===g&&(f=ub(a.A,d),g=ub(a.B,d)),f>g?a.setB(vb(a.B,d,e)):a.setA(vb(a.A,d,e)),a.bb_l=b(a.bb_l,d.bb_l),a.bb_b=b(a.bb_b,d.bb_b),a.bb_r=c(a.bb_r,d.bb_r),a.bb_t=c(a.bb_t,d.bb_t),a};mb.prototype.intersectsBB=ob.prototype.intersectsBB=function(a){return this.bb_l<=a.r&&a.l<=this.bb_r&&this.bb_b<=a.t&&a.b<=this.bb_t};var wb=function(a,b,c){a.intersectsBB(b)&&(a.isLeaf?c(a.obj):(wb(a.A,b,c),wb(a.B,b,c)))},xb=function(a,d,e){var f=1/(e.x-d.x),g=a.bb_l==d.x?-1/0:(a.bb_l-d.x)*f,h=a.bb_r==d.x?1/0:(a.bb_r-d.x)*f,i=b(g,h),j=c(g,h),k=1/(e.y-d.y),l=a.bb_b==d.y?-1/0:(a.bb_b-d.y)*k,m=a.bb_t==d.y?1/0:(a.bb_t-d.y)*k,n=b(l,m),o=c(l,m);if(j>=n&&o>=i){var p=c(i,n),q=b(j,o);if(q>=0&&1>=p)return c(p,0)}return 1/0},yb=function(a,c,d,e,f){if(a.isLeaf)return f(a.obj);var g=xb(a.A,c,d),h=xb(a.B,c,d);return h>g?(e>g&&(e=b(e,yb(a.A,c,d,e,f))),e>h&&(e=b(e,yb(a.B,c,d,e,f)))):(e>h&&(e=b(e,yb(a.B,c,d,e,f))),e>g&&(e=b(e,yb(a.A,c,d,e,f)))),e};kb.prototype.subtreeRecycle=function(a){a.isLeaf&&(this.subtreeRecycle(a.A),this.subtreeRecycle(a.B),a.recycle(this))};var zb=function(a,b,c){if(b==a)return null;var d=b.parent;if(d==a){var e=a.otherChild(b);return e.parent=a.parent,a.recycle(c),e}return d.parent.replaceChild(d,d.otherChild(b),c),a},Ab=function(a,b){return a.bb_l<=b.bb_r&&b.bb_l<=a.bb_r&&a.bb_b<=b.bb_t&&b.bb_b<=a.bb_t};ob.prototype.markLeafQuery=function(a,b,c,d){Ab(a,this)&&(b?sb(a,this,c):(this.stamp<a.stamp&&sb(this,a,c),d&&d(a.obj,this.obj)))},mb.prototype.markLeafQuery=function(a,b,c,d){Ab(a,this)&&(this.A.markLeafQuery(a,b,c,d),this.B.markLeafQuery(a,b,c,d))},ob.prototype.markSubtree=function(a,b,c){if(this.stamp==a.getStamp()){b&&b.markLeafQuery(this,!1,a,c);for(var d=this;d.parent;d=d.parent)d==d.parent.A?d.parent.B.markLeafQuery(this,!0,a,c):d.parent.A.markLeafQuery(this,!1,a,c)}else for(var e=this.pairs;e;)this===e.leafB?(c&&c(e.leafA.obj,this.obj),e=e.nextB):e=e.nextA},mb.prototype.markSubtree=function(a,b,c){this.A.markSubtree(a,b,c),this.B.markSubtree(a,b,c)},ob.prototype.containsObj=function(a){return this.bb_l<=a.bb_l&&this.bb_r>=a.bb_r&&this.bb_b<=a.bb_b&&this.bb_t>=a.bb_t},ob.prototype.update=function(a){var b=a.root,c=this.obj;return this.containsObj(c)?!1:(a.getBB(this.obj,this),b=zb(b,this,a),a.root=vb(b,this,a),this.clearPairs(a),this.stamp=a.getStamp(),!0)},ob.prototype.addPairs=function(a){var b=a.dynamicIndex;if(b){var c=b.root;c&&c.markLeafQuery(this,!0,b,null)}else{var d=a.staticIndex.root;this.markSubtree(a,d,null)}},kb.prototype.insert=function(a,b){var c=new ob(this,a);this.leaves[b]=c,this.root=vb(this.root,c,this),this.count++,c.stamp=this.getStamp(),c.addPairs(this),this.incrementStamp()},kb.prototype.remove=function(a,b){var c=this.leaves[b];delete this.leaves[b],this.root=zb(this.root,c,this),this.count--,c.clearPairs(this),c.recycle(this)},kb.prototype.contains=function(a,b){return null!=this.leaves[b]};var Bb=function(){};kb.prototype.reindexQuery=function(a){if(this.root){var b,c=this.leaves;for(b in c)c[b].update(this);var d=this.staticIndex,e=d&&d.root;this.root.markSubtree(this,e,a),d&&!e&&this.collideStatic(this,d,a),this.incrementStamp()}},kb.prototype.reindex=function(){this.reindexQuery(Bb)},kb.prototype.reindexObject=function(a,b){var c=this.leaves[b];c&&(c.update(this)&&c.addPairs(this),this.incrementStamp())},kb.prototype.pointQuery=function(a,b){this.query(new R(a.x,a.y,a.x,a.y),b)},kb.prototype.segmentQuery=function(a,b,c,d){this.root&&yb(this.root,a,b,c,d)},kb.prototype.query=function(a,b){this.root&&wb(this.root,a,b)},kb.prototype.count=function(){return this.count},kb.prototype.each=function(a){var b;for(b in this.leaves)a(this.leaves[b].obj)};var Cb=function(a,d,e,f,g){return(c(a.bb_r,f)-b(a.bb_l,d))*(c(a.bb_t,g)-b(a.bb_b,e))},Db=function(a,d,e,f){if(1==f)return d[e];if(2==f)return a.makeNode(d[e],d[e+1]);for(var g=d[e],h=g.bb_l,i=g.bb_b,j=g.bb_r,k=g.bb_t,l=e+f,m=e+1;l>m;m++)g=d[m],h=b(h,g.bb_l),i=b(i,g.bb_b),j=c(j,g.bb_r),k=c(k,g.bb_t);var n=j-h>k-i,o=new Array(2*f);if(n)for(var m=e;l>m;m++)o[2*m+0]=d[m].bb_l,o[2*m+1]=d[m].bb_r;else for(var m=e;l>m;m++)o[2*m+0]=d[m].bb_b,o[2*m+1]=d[m].bb_t;o.sort(function(a,b){return a-b});var p=.5*(o[f-1]+o[f]),q=h,r=i,s=j,t=k,u=h,v=i,w=j,x=k;n?s=u=p:t=v=p;for(var y=l,z=e;y>z;){var g=d[z];Cb(g,u,v,w,x)<Cb(g,q,r,s,t)?(y--,d[z]=d[y],d[y]=g):z++}if(y==f){for(var g=null,m=e;l>m;m++)g=vb(g,d[m],a);return g}return NodeNew(a,Db(a,d,e,y-e),Db(a,d,y,l-y))};kb.prototype.optimize=function(){var a=new Array(this.count),b=0;for(var c in this.leaves)a[b++]=this.nodes[c];tree.subtreeRecycle(root),this.root=Db(tree,a,a.length)};var Eb=function(a,b){!a.isLeaf&&10>=b&&(Eb(a.A,b+1),Eb(a.B,b+1));for(var c="",d=0;b>d;d++)c+=" ";console.log(c+a.bb_b+" "+a.bb_t)};kb.prototype.log=function(){this.root&&Eb(this.root,0)};var Fb=a.CollisionHandler=function(){this.a=this.b=0};Fb.prototype.begin=function(){return!0},Fb.prototype.preSolve=function(){return!0},Fb.prototype.postSolve=function(){},Fb.prototype.separate=function(){};var Gb=function(a,b){this.e=0,this.u=0,this.surface_vr=s,this.a=a,this.body_a=a.body,this.b=b,this.body_b=b.body,this.thread_a_next=this.thread_a_prev=null,this.thread_b_next=this.thread_b_prev=null,this.contacts=null,this.stamp=0,this.handler=null,this.swappedColl=!1,this.state="first coll"};Gb.prototype.getShapes=function(){return this.swappedColl?[this.b,this.a]:[this.a,this.b]},Gb.prototype.totalImpulse=function(){for(var a=this.contacts,b=new r(0,0),c=0,d=a.length;d>c;c++){var e=a[c];b.add(A(e.n,e.jnAcc))}return this.swappedColl?b:b.neg()},Gb.prototype.totalImpulseWithFriction=function(){for(var a=this.contacts,b=new r(0,0),c=0,d=a.length;d>c;c++){var e=a[c];b.add(new r(e.jnAcc,e.jtAcc).rotate(e.n))}return this.swappedColl?b:b.neg()},Gb.prototype.totalKE=function(){for(var a=(1-this.e)/(1+this.e),b=0,c=this.contacts,d=0,e=c.length;e>d;d++){var f=c[d],g=f.jnAcc,h=f.jtAcc;b+=a*g*g/f.nMass+h*h/f.tMass}return b},Gb.prototype.ignore=function(){this.state="ignore"},Gb.prototype.getA=function(){return this.swappedColl?this.b:this.a},Gb.prototype.getB=function(){return this.swappedColl?this.a:this.b},Gb.prototype.isFirstContact=function(){return"first coll"===this.state};var Hb=function(a,b,c){this.point=a,this.normal=b,this.dist=c};Gb.prototype.getContactPointSet=function(){var a,b=new Array(this.contacts.length);for(a=0;a<b.length;a++)b[a]=new Hb(this.contacts[a].p,this.contacts[a].n,this.contacts[a].dist);return b},Gb.prototype.getNormal=function(a){var b=this.contacts[a].n;return this.swappedColl?z(b):b},Gb.prototype.getPoint=function(a){return this.contacts[a].p},Gb.prototype.getDepth=function(a){return this.contacts[a].dist};var Ib=function(a,b,c,d){c?c.body_a===b?c.thread_a_next=d:c.thread_b_next=d:b.arbiterList=d,d&&(d.body_a===b?d.thread_a_prev=c:d.thread_b_prev=c)};Gb.prototype.unthread=function(){Ib(this,this.body_a,this.thread_a_prev,this.thread_a_next),Ib(this,this.body_b,this.thread_b_prev,this.thread_b_next),this.thread_a_prev=this.thread_a_next=null,this.thread_b_prev=this.thread_b_next=null},Gb.prototype.update=function(a,b,c,d){if(this.contacts)for(var e=0;e<this.contacts.length;e++)for(var f=this.contacts[e],g=0;g<a.length;g++){var h=a[g];h.hash===f.hash&&(h.jnAcc=f.jnAcc,h.jtAcc=f.jtAcc)}this.contacts=a,this.handler=b,this.swappedColl=c.collision_type!==b.a,this.e=c.e*d.e,this.u=c.u*d.u,this.surface_vr=y(c.surface_v,d.surface_v),this.a=c,this.body_a=c.body,this.b=d,this.body_b=d.body,"cached"==this.state&&(this.state="first coll")},Gb.prototype.preStep=function(a,c,d){for(var e=this.body_a,f=this.body_b,g=0;g<this.contacts.length;g++){var h=this.contacts[g];h.r1=y(h.p,e.p),h.r2=y(h.p,f.p),h.nMass=1/oc(e,f,h.r1,h.r2,h.n),h.tMass=1/oc(e,f,h.r1,h.r2,D(h.n)),h.bias=-d*b(0,h.dist+c)/a,h.jBias=0,h.bounce=jc(e,f,h.r1,h.r2,h.n)*this.e}},Gb.prototype.applyCachedImpulse=function(a){if(!this.isFirstContact())for(var b=this.body_a,c=this.body_b,d=0;d<this.contacts.length;d++){var e=this.contacts[d],f=e.n.x,g=e.n.y,h=f*e.jnAcc-g*e.jtAcc,i=f*e.jtAcc+g*e.jnAcc;lc(b,c,e.r1,e.r2,h*a,i*a)}};var Jb=0,Kb=0;Gb.prototype.applyImpulse=function(){Jb++;for(var a=this.body_a,b=this.body_b,d=this.surface_vr,e=this.u,f=0;f<this.contacts.length;f++){Kb++;var g=this.contacts[f],h=g.nMass,i=g.n,j=g.r1,k=g.r2,l=b.vx-k.y*b.w-(a.vx-j.y*a.w),m=b.vy+k.x*b.w-(a.vy+j.x*a.w),n=i.x*(b.v_biasx-k.y*b.w_bias-a.v_biasx+j.y*a.w_bias)+i.y*(k.x*b.w_bias+b.v_biasy-j.x*a.w_bias-a.v_biasy),o=u(l,m,i.x,i.y),q=u(l+d.x,m+d.y,-i.y,i.x),r=(g.bias-n)*h,s=g.jBias;g.jBias=c(s+r,0);var t=-(g.bounce+o)*h,v=g.jnAcc;g.jnAcc=c(v+t,0);var w=e*g.jnAcc,x=-q*g.tMass,y=g.jtAcc;g.jtAcc=p(y+x,-w,w);var z=i.x*(g.jBias-s),A=i.y*(g.jBias-s);mc(a,-z,-A,j),mc(b,z,A,k);var B=g.jnAcc-v,C=g.jtAcc-y;lc(a,b,j,k,i.x*B-i.y*C,i.x*C+i.y*B)}},Gb.prototype.callSeparate=function(a){var b=a.lookupHandler(this.a.collision_type,this.b.collision_type);b.separate(this,a)},Gb.prototype.next=function(a){return this.body_a==a?this.thread_a_next:this.thread_b_next};var Lb=0,Mb=function(a,b,c,d){this.p=a,this.n=b,this.dist=c,this.r1=this.r2=s,this.nMass=this.tMass=this.bounce=this.bias=0,this.jnAcc=this.jtAcc=this.jBias=0,this.hash=d,Lb++},Nb=[],Ob=function(a,b,c,d){var e=c+d,f=y(b,a),g=H(f);if(!(g>=e*e)){var h=Math.sqrt(g);return new Mb(x(a,A(f,.5+(c-.5*e)/(h?h:1/0))),h?A(f,1/h):new r(1,0),h-e,0)}},Pb=function(a,b){var c=Ob(a.tc,b.tc,a.r,b.r);return c?[c]:Nb},Qb=function(a,b){var c=b.ta,d=b.tb,e=a.tc,f=y(d,c),g=q(t(f,y(e,c))/H(f)),h=x(c,A(f,g)),i=Ob(e,h,a.r,b.r);if(i){var j=i.n;return 0===g&&t(j,b.a_tangent)<0||1===g&&t(j,b.b_tangent)<0?Nb:[i]}return Nb},Rb=0,Sb=function(a,b){var c=0,d=a.valueOnAxis(b[0].n,b[0].d);if(d>0)return-1;for(var e=1;e<b.length;e++){var f=a.valueOnAxis(b[e].n,b[e].d);if(f>0)return-1;f>d&&(d=f,c=e)}return Rb=d,c},Tb=function(a,b,c,d){for(var e=[],f=a.tVerts,g=0;g<f.length;g+=2){var i=f[g],j=f[g+1];b.containsVertPartial(i,j,z(c))&&e.push(new Mb(new r(i,j),c,d,h(a.hashid,g)))}for(var k=b.tVerts,g=0;g<k.length;g+=2){var i=k[g],j=k[g+1];a.containsVertPartial(i,j,c)&&e.push(new Mb(new r(i,j),c,d,h(b.hashid,g)))}return e},Ub=function(a,b,c,d){for(var e=[],f=a.tVerts,g=0;g<f.length;g+=2){var i=f[g],j=f[g+1];b.containsVert(i,j)&&e.push(new Mb(new r(i,j),c,d,h(a.hashid,g>>1)))}for(var k=b.tVerts,g=0;g<k.length;g+=2){var i=k[g],j=k[g+1];a.containsVert(i,j)&&e.push(new Mb(new r(i,j),c,d,h(b.hashid,g>>1)))}return e.length?e:Tb(a,b,c,d)},Vb=function(a,b){var c=Sb(b,a.tPlanes);if(-1==c)return Nb;var d=Rb,e=Sb(a,b.tPlanes);if(-1==e)return Nb;var f=Rb;return d>f?Ub(a,b,a.tPlanes[c].n,d):Ub(a,b,z(b.tPlanes[e].n),f)},Wb=function(a,c,d){var e=t(c,a.ta)-a.r,f=t(c,a.tb)-a.r;return b(e,f)-d},Xb=function(a,b,c,d,e){for(var f=B(b.tn,b.ta),g=B(b.tn,b.tb),i=A(b.tn,e),j=c.tVerts,k=0;k<j.length;k+=2){var l=j[k],m=j[k+1];if(u(l,m,i.x,i.y)<t(b.tn,b.ta)*e+b.r){var n=C(b.tn.x,b.tn.y,l,m);f>=n&&n>=g&&a.push(new Mb(new r(l,m),i,d,h(c.hashid,k)))}}},Yb=function(a,b){var c=[],d=b.tPlanes,e=d.length,f=t(a.tn,a.ta),g=b.valueOnAxis(a.tn,f)-a.r,i=b.valueOnAxis(z(a.tn),-f)-a.r;if(i>0||g>0)return Nb;var j=0,k=Wb(a,d[0].n,d[0].d);if(k>0)return Nb;for(var l=0;e>l;l++){var m=Wb(a,d[l].n,d[l].d);if(m>0)return Nb;m>k&&(k=m,j=l)}var n=z(d[j].n),o=x(a.ta,A(n,a.r)),p=x(a.tb,A(n,a.r));if(b.containsVert(o.x,o.y)&&c.push(new Mb(o,n,k,h(a.hashid,0))),b.containsVert(p.x,p.y)&&c.push(new Mb(p,n,k,h(a.hashid,1))),(g>=k||i>=k)&&(g>i?Xb(c,a,b,g,1):Xb(c,a,b,i,-1)),0===c.length){var q,s=2*j,u=b.tVerts,v=new r(u[s],u[s+1]);if(q=Ob(a.ta,v,a.r,0,c))return[q];if(q=Ob(a.tb,v,a.r,0,c))return[q];var w=2*e,y=new r(u[(s+2)%w],u[(s+3)%w]);if(q=Ob(a.ta,y,a.r,0,c))return[q];if(q=Ob(a.tb,y,a.r,0,c))return[q]}return c},Zb=function(a,b){for(var c=b.tPlanes,d=0,e=t(c[0].n,a.tc)-c[0].d-a.r,f=0;f<c.length;f++){var g=t(c[f].n,a.tc)-c[f].d-a.r;if(g>0)return Nb;g>e&&(e=g,d=f)}var h=c[d].n,i=b.tVerts,j=i.length,k=d<<1,l=i[k],m=i[k+1],n=i[(k+2)%j],o=i[(k+3)%j],p=C(h.x,h.y,l,m),q=C(h.x,h.y,n,o),s=B(h,a.tc);if(q>s){var u=Ob(a.tc,new r(n,o),a.r,0,u);return u?[u]:Nb}if(p>s)return[new Mb(y(a.tc,A(h,a.r+e/2)),z(h),e,0)];var u=Ob(a.tc,new r(l,m),a.r,0,u);return u?[u]:Nb};Z.prototype.collisionCode=0,_.prototype.collisionCode=1,bb.prototype.collisionCode=2,Z.prototype.collisionTable=[Pb,Qb,Zb],_.prototype.collisionTable=[null,function(){return Nb},Yb],bb.prototype.collisionTable=[null,null,Vb];var $b=a.collideShapes=function(a,b){return d(a.collisionCode<=b.collisionCode,"Collided shapes must be sorted by type"),a.collisionTable[b.collisionCode](a,b)},_b=new Fb,ac=a.Space=function(){this.stamp=0,this.curr_dt=0,this.bodies=[],this.rousedBodies=[],this.sleepingComponents=[],this.staticShapes=new kb(null),this.activeShapes=new kb(this.staticShapes),this.arbiters=[],this.contactBuffersHead=null,this.cachedArbiters={},this.constraints=[],this.locked=0,this.collisionHandlers={},this.defaultHandler=_b,this.postStepCallbacks=[],this.iterations=10,this.gravity=s,this.damping=1,this.idleSpeedThreshold=0,this.sleepTimeThreshold=1/0,this.collisionSlop=.1,this.collisionBias=Math.pow(.9,60),this.collisionPersistence=3,this.enableContactGraph=!1,this.staticBody=new eb(1/0,1/0),this.staticBody.nodeIdleTime=1/0,this.collideShapes=this.makeCollideShapes()};ac.prototype.getCurrentTimeStep=function(){return this.curr_dt},ac.prototype.setIterations=function(a){this.iterations=a},ac.prototype.isLocked=function(){return this.locked};var bc=function(a){d(!a.locked,"This addition/removal cannot be done safely during a call to cpSpaceStep()  or during a query. Put these calls into a post-step callback.")};ac.prototype.addCollisionHandler=function(a,b,c,d,e,f){bc(this),this.removeCollisionHandler(a,b);var g=new Fb;g.a=a,g.b=b,c&&(g.begin=c),d&&(g.preSolve=d),e&&(g.postSolve=e),f&&(g.separate=f),this.collisionHandlers[h(a,b)]=g},ac.prototype.removeCollisionHandler=function(a,b){bc(this),delete this.collisionHandlers[h(a,b)]},ac.prototype.setDefaultCollisionHandler=function(a,b,c,d){bc(this);var e=new Fb;a&&(e.begin=a),b&&(e.preSolve=b),c&&(e.postSolve=c),d&&(e.separate=d),this.defaultHandler=e},ac.prototype.lookupHandler=function(a,b){return this.collisionHandlers[h(a,b)]||this.defaultHandler},ac.prototype.addShape=function(a){var b=a.body;return b.isStatic()?this.addStaticShape(a):(d(!a.space,"This shape is already added to a space and cannot be added to another."),bc(this),b.activate(),b.addShape(a),a.update(b.p,b.rot),this.activeShapes.insert(a,a.hashid),a.space=this,a)},ac.prototype.addStaticShape=function(a){d(!a.space,"This shape is already added to a space and cannot be added to another."),bc(this);var b=a.body;return b.addShape(a),a.update(b.p,b.rot),this.staticShapes.insert(a,a.hashid),a.space=this,a},ac.prototype.addBody=function(a){return d(!a.isStatic(),"Static bodies cannot be added to a space as they are not meant to be simulated."),d(!a.space,"This body is already added to a space and cannot be added to another."),bc(this),this.bodies.push(a),a.space=this,a},ac.prototype.addConstraint=function(a){d(!a.space,"This shape is already added to a space and cannot be added to another."),bc(this);var b=a.a,c=a.b;return b.activate(),c.activate(),this.constraints.push(a),a.next_a=b.constraintList,b.constraintList=a,a.next_b=c.constraintList,c.constraintList=a,a.space=this,a},ac.prototype.filterArbiters=function(a,b){for(var c in this.cachedArbiters){var d=this.cachedArbiters[c];(a===d.body_a&&(b===d.a||null===b)||a===d.body_b&&(b===d.b||null===b))&&(b&&"cached"!==d.state&&d.callSeparate(this),d.unthread(),i(this.arbiters,d),delete this.cachedArbiters[c])}},ac.prototype.removeShape=function(a){var b=a.body;b.isStatic()?this.removeStaticShape(a):(d(this.containsShape(a),"Cannot remove a shape that was not added to the space. (Removed twice maybe?)"),bc(this),b.activate(),b.removeShape(a),this.filterArbiters(b,a),this.activeShapes.remove(a,a.hashid),a.space=null)},ac.prototype.removeStaticShape=function(a){d(this.containsShape(a),"Cannot remove a static or sleeping shape that was not added to the space. (Removed twice maybe?)"),bc(this);var b=a.body;b.isStatic()&&b.activateStatic(a),b.removeShape(a),this.filterArbiters(b,a),this.staticShapes.remove(a,a.hashid),a.space=null},ac.prototype.removeBody=function(a){d(this.containsBody(a),"Cannot remove a body that was not added to the space. (Removed twice maybe?)"),bc(this),a.activate(),i(this.bodies,a),a.space=null},ac.prototype.removeConstraint=function(a){d(this.containsConstraint(a),"Cannot remove a constraint that was not added to the space. (Removed twice maybe?)"),bc(this),a.a.activate(),a.b.activate(),i(this.constraints,a),a.a.removeConstraint(a),a.b.removeConstraint(a),a.space=null},ac.prototype.containsShape=function(a){return a.space===this},ac.prototype.containsBody=function(a){return a.space==this},ac.prototype.containsConstraint=function(a){return a.space==this},ac.prototype.uncacheArbiter=function(a){delete this.cachedArbiters[h(a.a.hashid,a.b.hashid)],i(this.arbiters,a)},ac.prototype.eachBody=function(a){this.lock();for(var b=this.bodies,c=0;c<b.length;c++)a(b[c]);for(var d=this.sleepingComponents,c=0;c<d.length;c++)for(var e=d[c],f=e;f;){var g=f.nodeNext;a(f),f=g}this.unlock(!0)},ac.prototype.eachShape=function(a){this.lock(),this.activeShapes.each(a),this.staticShapes.each(a),this.unlock(!0)},ac.prototype.eachConstraint=function(a){this.lock();for(var b=this.constraints,c=0;c<b.length;c++)a(b[c]);this.unlock(!0)},ac.prototype.reindexStatic=function(){d(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete."),this.staticShapes.each(function(a){var b=a.body;a.update(b.p,b.rot)}),this.staticShapes.reindex()},ac.prototype.reindexShape=function(a){d(!this.locked,"You cannot manually reindex objects while the space is locked. Wait until the current query or step is complete.");var b=a.body;a.update(b.p,b.rot),this.activeShapes.reindexObject(a,a.hashid),this.staticShapes.reindexObject(a,a.hashid)},ac.prototype.reindexShapesForBody=function(a){for(var b=a.shapeList;b;b=b.next)this.reindexShape(b)},ac.prototype.useSpatialHash=function(a,b){throw new Error("Spatial Hash not implemented.")},ac.prototype.activateBody=function(a){if(d(!a.isRogue(),"Internal error: Attempting to activate a rogue body."),this.locked)-1===this.rousedBodies.indexOf(a)&&this.rousedBodies.push(a);else{this.bodies.push(a);for(var b=0;b<a.shapeList.length;b++){var c=a.shapeList[b];this.staticShapes.remove(c,c.hashid),this.activeShapes.insert(c,c.hashid)}for(var e=a.arbiterList;e;e=e.next(a)){var f=e.body_a;if(a===f||f.isStatic()){var g=e.a,i=e.b;this.cachedArbiters[h(g.hashid,i.hashid)]=e,e.stamp=this.stamp,e.handler=this.lookupHandler(g.collision_type,i.collision_type),this.arbiters.push(e)}}for(var j=a.constraintList;j;j=j.nodeNext){var f=j.a;(a===f||f.isStatic())&&this.constraints.push(j)}}},ac.prototype.deactivateBody=function(a){d(!a.isRogue(),"Internal error: Attempting to deactivate a rogue body."),i(this.bodies,a);for(var b=0;b<a.shapeList.length;b++){var c=a.shapeList[b];this.activeShapes.remove(c,c.hashid),this.staticShapes.insert(c,c.hashid)}for(var e=a.arbiterList;e;e=e.next(a)){var f=e.body_a;(a===f||f.isStatic())&&this.uncacheArbiter(e)}for(var g=a.constraintList;g;g=g.nodeNext){var f=g.a;(a===f||f.isStatic())&&i(this.constraints,g)}};var cc=function(a){return a?a.nodeRoot:null},dc=function(a){if(a&&a.isSleeping(a)){d(!a.isRogue(),"Internal Error: componentActivate() called on a rogue body.");for(var b=a.space,c=a;c;){var e=c.nodeNext;c.nodeIdleTime=0,c.nodeRoot=null,c.nodeNext=null,b.activateBody(c),c=e}i(b.sleepingComponents,a)}};eb.prototype.activate=function(){this.isRogue()||(this.nodeIdleTime=0,dc(cc(this)))},eb.prototype.activateStatic=function(a){d(this.isStatic(),"Body.activateStatic() called on a non-static body.");for(var b=this.arbiterList;b;b=b.next(this))a&&a!=b.a&&a!=b.b||(b.body_a==this?b.body_b:b.body_a).activate()},eb.prototype.pushArbiter=function(a){e(null===(a.body_a===this?a.thread_a_next:a.thread_b_next),"Internal Error: Dangling contact graph pointers detected. (A)"),e(null===(a.body_a===this?a.thread_a_prev:a.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (B)");var b=this.arbiterList;e(null===b||null===(b.body_a===this?b.thread_a_prev:b.thread_b_prev),"Internal Error: Dangling contact graph pointers detected. (C)"),a.body_a===this?a.thread_a_next=b:a.thread_b_next=b,b&&(b.body_a===this?b.thread_a_prev=a:b.thread_b_prev=a),this.arbiterList=a};var ec=function(a,b){b.nodeRoot=a,b!==a&&(b.nodeNext=a.nodeNext,a.nodeNext=b)},fc=function(a,b){if(!b.isRogue()){var c=cc(b);if(null==c){ec(a,b);for(var d=b.arbiterList;d;d=d.next(b))fc(a,b==d.body_a?d.body_b:d.body_a);for(var f=b.constraintList;f;f=f.next(b))fc(a,b==f.a?f.b:f.a)}else e(c===a,"Internal Error: Inconsistency detected in the contact graph.")}},gc=function(a,b){for(var c=a;c;c=c.nodeNext)if(c.nodeIdleTime<b)return!0;return!1};ac.prototype.processComponents=function(a){for(var b=1/0!==this.sleepTimeThreshold,c=this.bodies,d=0;d<c.length;d++){var f=c[d];e(null===f.nodeNext,"Internal Error: Dangling next pointer detected in contact graph."),e(null===f.nodeRoot,"Internal Error: Dangling root pointer detected in contact graph.")}if(b)for(var g=this.idleSpeedThreshold,h=g?g*g:H(this.gravity)*a*a,d=0;d<c.length;d++){var f=c[d],i=h?f.m*h:0;f.nodeIdleTime=f.kineticEnergy()>i?0:f.nodeIdleTime+a}for(var j=this.arbiters,d=0,k=j.length;k>d;d++){var l=j[d],m=l.body_a,n=l.body_b;b&&((n.isRogue()&&!n.isStatic()||m.isSleeping())&&m.activate(),(m.isRogue()&&!m.isStatic()||n.isSleeping())&&n.activate()),m.pushArbiter(l),n.pushArbiter(l)}if(b){for(var o=this.constraints,d=0;d<o.length;d++){var p=o[d],m=p.a,n=p.b;n.isRogue()&&!n.isStatic()&&m.activate(),m.isRogue()&&!m.isStatic()&&n.activate()}for(var d=0;d<c.length;){var f=c[d];if(null!==cc(f)||(fc(f,f),gc(f,this.sleepTimeThreshold)))d++,f.nodeRoot=null,f.nodeNext=null;else{this.sleepingComponents.push(f);for(var q=f;q;q=q.nodeNext)this.deactivateBody(q)}}}},eb.prototype.sleep=function(){this.sleepWithGroup(null)},eb.prototype.sleepWithGroup=function(a){d(!this.isStatic()&&!this.isRogue(),"Rogue and static bodies cannot be put to sleep.");var b=this.space;if(d(b,"Cannot put a rogue body to sleep."),d(!b.locked,"Bodies cannot be put to sleep during a query or a call to cpSpaceStep(). Put these calls into a post-step callback."),d(null===a||a.isSleeping(),"Cannot use a non-sleeping body as a group identifier."),this.isSleeping())return d(cc(this)===cc(a),"The body is already sleeping and it's group cannot be reassigned."),void 0;for(var c=0;c<this.shapeList.length;c++)this.shapeList[c].update(this.p,this.rot);if(b.deactivateBody(this),a){var e=cc(a);this.nodeRoot=e,this.nodeNext=e.nodeNext,this.nodeIdleTime=0,e.nodeNext=this}else this.nodeRoot=this,this.nodeNext=null,this.nodeIdleTime=0,b.sleepingComponents.push(this);i(b.bodies,this)},ac.prototype.activateShapesTouchingShape=function(a){1/0!==this.sleepTimeThreshold&&this.shapeQuery(a,function(a){a.body.activate()})},ac.prototype.pointQuery=function(a,b,c,d){var e=function(e){(!e.group||c!==e.group)&&b&e.layers&&e.pointQuery(a)&&d(e)},f=new R(a.x,a.y,a.x,a.y);this.lock(),this.activeShapes.query(f,e),this.staticShapes.query(f,e),this.unlock(!0)},ac.prototype.pointQueryFirst=function(a,b,c){var d=null;return this.pointQuery(a,b,c,function(a){a.sensor||(d=a)}),d},ac.prototype.nearestPointQuery=function(a,b,c,d,e){var f=function(f){if((!f.group||d!==f.group)&&c&f.layers){var g=f.nearestPointQuery(a);g.d<b&&e(f,g.d,g.p)}},g=S(a,b);this.lock(),this.activeShapes.query(g,f),this.staticShapes.query(g,f),this.unlock(!0)},ac.prototype.nearestPointQueryNearest=function(a,b,c,d){var e,f=function(f){if((!f.group||d!==f.group)&&c&f.layers&&!f.sensor){var g=f.nearestPointQuery(a);g.d<b&&(!e||g.d<e.d)&&(e=g)}},g=S(a,b);return this.activeShapes.query(g,f),this.staticShapes.query(g,f),e},ac.prototype.segmentQuery=function(a,b,c,d,e){var f=function(f){var g;return(!f.group||d!==f.group)&&c&f.layers&&(g=f.segmentQuery(a,b))&&e(f,g.t,g.n),1};this.lock(),this.staticShapes.segmentQuery(a,b,1,f),this.activeShapes.segmentQuery(a,b,1,f),this.unlock(!0)},ac.prototype.segmentQueryFirst=function(a,b,c,d){var e=null,f=function(f){var g;return(!f.group||d!==f.group)&&c&f.layers&&!f.sensor&&(g=f.segmentQuery(a,b))&&(null===e||g.t<e.t)&&(e=g),e?e.t:1};return this.staticShapes.segmentQuery(a,b,1,f),this.activeShapes.segmentQuery(a,b,e?e.t:1,f),e},ac.prototype.bbQuery=function(a,b,c,d){var e=function(e){(!e.group||c!==e.group)&&b&e.layers&&T(a,e.bb_l,e.bb_b,e.bb_r,e.bb_t)&&d(e)};this.lock(),this.activeShapes.query(a,e),this.staticShapes.query(a,e),this.unlock(!0)},ac.prototype.shapeQuery=function(a,b){var c=a.body;c&&a.update(c.p,c.rot);var d=new R(a.bb_l,a.bb_b,a.bb_r,a.bb_t),e=!1,f=function(c){var d=a;if((!d.group||d.group!==c.group)&&d.layers&c.layers&&d!==c){var f;if(d.collisionCode<=c.collisionCode)f=$b(d,c);else{f=$b(c,d);for(var g=0;g<f.length;g++)f[g].n=z(f[g].n)}if(f.length&&(e=!(d.sensor||c.sensor),b)){for(var h=new Array(f.length),g=0;g<f.length;g++)h[g]=new Hb(f[g].p,f[g].n,f[g].dist);b(c,h)}}};return this.lock(),this.activeShapes.query(d,f),this.staticShapes.query(d,f),this.unlock(!0),e},ac.prototype.addPostStepCallback=function(a){e(this.locked,"Adding a post-step callback when the space is not locked is unnecessary. Post-step callbacks will not called until the end of the next call to cpSpaceStep() or the next query."),this.postStepCallbacks.push(a)},ac.prototype.runPostStepCallbacks=function(){for(var a=0;a<this.postStepCallbacks.length;a++)this.postStepCallbacks[a]();this.postStepCallbacks=[]},ac.prototype.lock=function(){this.locked++},ac.prototype.unlock=function(a){if(this.locked--,d(this.locked>=0,"Internal Error: Space lock underflow."),0===this.locked&&a){for(var b=this.rousedBodies,c=0;c<b.length;c++)this.activateBody(b[c]);b.length=0,this.runPostStepCallbacks()}},ac.prototype.makeCollideShapes=function(){var a=this;return function(b,c){var d=a;if(b.bb_l<=c.bb_r&&c.bb_l<=b.bb_r&&b.bb_b<=c.bb_t&&c.bb_b<=b.bb_t&&b.body!==c.body&&(!b.group||b.group!==c.group)&&b.layers&c.layers){var e=d.lookupHandler(b.collision_type,c.collision_type),f=b.sensor||c.sensor;if(!f||e!==_b){if(b.collisionCode>c.collisionCode){var g=b;b=c,c=g}var i=$b(b,c);if(0!==i.length){var j=h(b.hashid,c.hashid),k=d.cachedArbiters[j];k||(k=d.cachedArbiters[j]=new Gb(b,c)),k.update(i,e,b,c),"first coll"!=k.state||e.begin(k,d)||k.ignore(),"ignore"!==k.state&&e.preSolve(k,d)&&!f?d.arbiters.push(k):(k.contacts=null,"ignore"!==k.state&&(k.state="normal")),k.stamp=d.stamp}}}}},ac.prototype.arbiterSetFilter=function(a){var b=this.stamp-a.stamp,c=a.body_a,d=a.body_b;return(c.isStatic()||c.isSleeping())&&(d.isStatic()||d.isSleeping())?!0:(b>=1&&"cached"!=a.state&&(a.callSeparate(this),a.state="cached"),b>=this.collisionPersistence?(a.contacts=null,!1):!0)};var hc=function(a){var b=a.body;a.update(b.p,b.rot)};ac.prototype.step=function(a){if(0!==a){d(0===s.x&&0===s.y,"vzero is invalid"),this.stamp++;
var b=this.curr_dt;this.curr_dt=a;var c,e,f,g=this.bodies,h=this.constraints,i=this.arbiters;for(c=0;c<i.length;c++){var j=i[c];j.state="normal",j.body_a.isSleeping()||j.body_b.isSleeping()||j.unthread()}for(i.length=0,this.lock(),c=0;c<g.length;c++)g[c].position_func(a);this.activeShapes.each(hc),this.activeShapes.reindexQuery(this.collideShapes),this.unlock(!1),this.processComponents(a),this.lock();for(f in this.cachedArbiters)this.arbiterSetFilter(this.cachedArbiters[f])||delete this.cachedArbiters[f];var k=this.collisionSlop,l=1-Math.pow(this.collisionBias,a);for(c=0;c<i.length;c++)i[c].preStep(a,k,l);for(c=0;c<h.length;c++){var m=h[c];m.preSolve(this),m.preStep(a)}var n=Math.pow(this.damping,a),o=this.gravity;for(c=0;c<g.length;c++)g[c].velocity_func(o,n,a);var p=0===b?0:a/b;for(c=0;c<i.length;c++)i[c].applyCachedImpulse(p);for(c=0;c<h.length;c++)h[c].applyCachedImpulse(p);for(c=0;c<this.iterations;c++){for(e=0;e<i.length;e++)i[e].applyImpulse();for(e=0;e<h.length;e++)h[e].applyImpulse()}for(c=0;c<h.length;c++)h[c].postSolve(this);for(c=0;c<i.length;c++)i[c].handler.postSolve(i[c],this);this.unlock(!0)}};var ic=function(a,b,c,d){var e=a.vx+-c.y*a.w,f=a.vy+c.x*a.w,g=b.vx+-d.y*b.w,h=b.vy+d.x*b.w;return new r(g-e,h-f)},jc=function(a,b,c,d,e){var f=a.vx+-c.y*a.w,g=a.vy+c.x*a.w,h=b.vx+-d.y*b.w,i=b.vy+d.x*b.w;return u(h-f,i-g,e.x,e.y)},kc=function(a,b,c,d){a.vx+=b*a.m_inv,a.vy+=c*a.m_inv,a.w+=a.i_inv*(d.x*c-d.y*b)},lc=function(a,b,c,d,e,f){kc(a,-e,-f,c),kc(b,e,f,d)},mc=function(a,b,c,d){a.v_biasx+=b*a.m_inv,a.v_biasy+=c*a.m_inv,a.w_bias+=a.i_inv*C(d.x,d.y,b,c)},nc=function(a,b,c){var d=B(b,c);return a.m_inv+a.i_inv*d*d},oc=function(a,b,c,d,f){var g=nc(a,c,f)+nc(b,d,f);return e(0!==g,"Unsolvable collision or constraint."),g},pc=function(a,b,c,d,f,g){var h,i,j,k,l=a.m_inv+b.m_inv;h=l,i=0,j=0,k=l;var m=a.i_inv,n=c.x*c.x*m,o=c.y*c.y*m,p=-c.x*c.y*m;h+=o,i+=p,j+=p,k+=n;var q=b.i_inv,r=d.x*d.x*q,s=d.y*d.y*q,t=-d.x*d.y*q;h+=s,i+=t,j+=t,k+=r;var u=h*k-i*j;e(0!==u,"Unsolvable constraint.");var v=1/u;f.x=k*v,f.y=-i*v,g.x=-j*v,g.y=h*v},qc=function(a,b,c){return new r(t(a,b),t(a,c))},rc=function(a,b){return 1-Math.pow(a,b)},sc=a.Constraint=function(a,b){this.a=a,this.b=b,this.space=null,this.next_a=null,this.next_b=null,this.maxForce=1/0,this.errorBias=Math.pow(.9,60),this.maxBias=1/0};sc.prototype.activateBodies=function(){this.a&&this.a.activate(),this.b&&this.b.activate()},sc.prototype.preStep=function(){},sc.prototype.applyCachedImpulse=function(){},sc.prototype.applyImpulse=function(){},sc.prototype.getImpulse=function(){return 0},sc.prototype.preSolve=function(){},sc.prototype.postSolve=function(){},sc.prototype.next=function(a){return this.a===a?this.next_a:this.next_b};var tc=a.PinJoint=function(a,b,c,d){sc.call(this,a,b),this.anchr1=c,this.anchr2=d;var f=a?x(a.p,F(c,a.rot)):c,g=b?x(b.p,F(d,b.rot)):d;this.dist=v(y(g,f)),e(this.dist>0,"You created a 0 length pin joint. A pivot joint will be much more stable."),this.r1=this.r2=null,this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};tc.prototype=Object.create(sc.prototype),tc.prototype.preStep=function(a){var b=this.a,c=this.b;this.r1=F(this.anchr1,b.rot),this.r2=F(this.anchr2,c.rot);var d=y(x(c.p,this.r2),x(b.p,this.r1)),e=v(d);this.n=A(d,1/(e?e:1/0)),this.nMass=1/oc(b,c,this.r1,this.r2,this.n);var f=this.maxBias;this.bias=p(-rc(this.errorBias,a)*(e-this.dist)/a,-f,f),this.jnMax=this.maxForce*a},tc.prototype.applyCachedImpulse=function(a){var b=A(this.n,this.jnAcc*a);lc(this.a,this.b,this.r1,this.r2,b.x,b.y)},tc.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=this.n,d=jc(a,b,this.r1,this.r2,c),e=(this.bias-d)*this.nMass,f=this.jnAcc;this.jnAcc=p(f+e,-this.jnMax,this.jnMax),e=this.jnAcc-f,lc(a,b,this.r1,this.r2,c.x*e,c.y*e)},tc.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var uc=a.SlideJoint=function(a,b,c,d,e,f){sc.call(this,a,b),this.anchr1=c,this.anchr2=d,this.min=e,this.max=f,this.r1=this.r2=this.n=null,this.nMass=0,this.jnAcc=this.jnMax=0,this.bias=0};uc.prototype=Object.create(sc.prototype),uc.prototype.preStep=function(a){var b=this.a,c=this.b;this.r1=F(this.anchr1,b.rot),this.r2=F(this.anchr2,c.rot);var d=y(x(c.p,this.r2),x(b.p,this.r1)),e=v(d),f=0;e>this.max?(f=e-this.max,this.n=L(d)):e<this.min?(f=this.min-e,this.n=z(L(d))):(this.n=s,this.jnAcc=0),this.nMass=1/oc(b,c,this.r1,this.r2,this.n);var g=this.maxBias;this.bias=p(-rc(this.errorBias,a)*f/a,-g,g),this.jnMax=this.maxForce*a},uc.prototype.applyCachedImpulse=function(a){var b=this.jnAcc*a;lc(this.a,this.b,this.r1,this.r2,this.n.x*b,this.n.y*b)},uc.prototype.applyImpulse=function(){if(0!==this.n.x||0!==this.n.y){var a=this.a,b=this.b,c=this.n,d=this.r1,e=this.r2,f=ic(a,b,d,e),g=t(f,c),h=(this.bias-g)*this.nMass,i=this.jnAcc;this.jnAcc=p(i+h,-this.jnMax,0),h=this.jnAcc-i,lc(a,b,this.r1,this.r2,c.x*h,c.y*h)}},uc.prototype.getImpulse=function(){return Math.abs(this.jnAcc)};var vc=a.PivotJoint=function(a,b,c,d){if(sc.call(this,a,b),"undefined"==typeof d){var e=c;c=a?a.world2Local(e):e,d=b?b.world2Local(e):e}this.anchr1=c,this.anchr2=d,this.r1=this.r2=s,this.k1=new r(0,0),this.k2=new r(0,0),this.jAcc=s,this.jMaxLen=0,this.bias=s};vc.prototype=Object.create(sc.prototype),vc.prototype.preStep=function(a){var b=this.a,c=this.b;this.r1=F(this.anchr1,b.rot),this.r2=F(this.anchr2,c.rot),pc(b,c,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*a;var d=y(x(c.p,this.r2),x(b.p,this.r1));this.bias=M(A(d,-rc(this.errorBias,a)/a),this.maxBias)},vc.prototype.applyCachedImpulse=function(a){lc(this.a,this.b,this.r1,this.r2,this.jAcc.x*a,this.jAcc.y*a)},vc.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=this.r1,d=this.r2,e=ic(a,b,c,d),f=qc(y(this.bias,e),this.k1,this.k2),g=this.jAcc;this.jAcc=M(x(this.jAcc,f),this.jMaxLen),lc(a,b,this.r1,this.r2,this.jAcc.x-g.x,this.jAcc.y-g.y)},vc.prototype.getImpulse=function(){return v(this.jAcc)};var wc=a.GrooveJoint=function(a,b,c,d,e){sc.call(this,a,b),this.grv_a=c,this.grv_b=d,this.grv_n=D(K(y(d,c))),this.anchr2=e,this.grv_tn=null,this.clamp=0,this.r1=this.r2=null,this.k1=new r(0,0),this.k2=new r(0,0),this.jAcc=s,this.jMaxLen=0,this.bias=null};wc.prototype=Object.create(sc.prototype),wc.prototype.preStep=function(a){var b=this.a,c=this.b,d=b.local2World(this.grv_a),e=b.local2World(this.grv_b),f=F(this.grv_n,b.rot),g=t(d,f);this.grv_tn=f,this.r2=F(this.anchr2,c.rot);var h=B(x(c.p,this.r2),f);h<=B(d,f)?(this.clamp=1,this.r1=y(d,b.p)):h>=B(e,f)?(this.clamp=-1,this.r1=y(e,b.p)):(this.clamp=0,this.r1=y(x(A(D(f),-h),A(f,g)),b.p)),pc(b,c,this.r1,this.r2,this.k1,this.k2),this.jMaxLen=this.maxForce*a;var i=y(x(c.p,this.r2),x(b.p,this.r1));this.bias=M(A(i,-rc(this.errorBias,a)/a),this.maxBias)},wc.prototype.applyCachedImpulse=function(a){lc(this.a,this.b,this.r1,this.r2,this.jAcc.x*a,this.jAcc.y*a)},wc.prototype.grooveConstrain=function(a){var b=this.grv_tn,c=this.clamp*B(a,b)>0?a:E(a,b);return M(c,this.jMaxLen)},wc.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=this.r1,d=this.r2,e=ic(a,b,c,d),f=qc(y(this.bias,e),this.k1,this.k2),g=this.jAcc;this.jAcc=this.grooveConstrain(x(g,f)),lc(a,b,this.r1,this.r2,this.jAcc.x-g.x,this.jAcc.y-g.y)},wc.prototype.getImpulse=function(){return v(this.jAcc)},wc.prototype.setGrooveA=function(a){this.grv_a=a,this.grv_n=D(K(y(this.grv_b,a))),this.activateBodies()},wc.prototype.setGrooveB=function(a){this.grv_b=a,this.grv_n=D(K(y(a,this.grv_a))),this.activateBodies()};var xc=function(a,b){return(a.restLength-b)*a.stiffness},yc=a.DampedSpring=function(a,b,c,d,e,f,g){sc.call(this,a,b),this.anchr1=c,this.anchr2=d,this.restLength=e,this.stiffness=f,this.damping=g,this.springForceFunc=xc,this.target_vrn=this.v_coef=0,this.r1=this.r2=null,this.nMass=0,this.n=null};yc.prototype=Object.create(sc.prototype),yc.prototype.preStep=function(a){var b=this.a,c=this.b;this.r1=F(this.anchr1,b.rot),this.r2=F(this.anchr2,c.rot);var d=y(x(c.p,this.r2),x(b.p,this.r1)),f=v(d);this.n=A(d,1/(f?f:1/0));var g=oc(b,c,this.r1,this.r2,this.n);e(0!==g,"Unsolvable this."),this.nMass=1/g,this.target_vrn=0,this.v_coef=1-Math.exp(-this.damping*a*g);var h=this.springForceFunc(this,f);lc(b,c,this.r1,this.r2,this.n.x*h*a,this.n.y*h*a)},yc.prototype.applyCachedImpulse=function(){},yc.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=this.n,d=this.r1,e=this.r2,f=jc(a,b,d,e,c),g=(this.target_vrn-f)*this.v_coef;this.target_vrn=f+g,g*=this.nMass,lc(a,b,this.r1,this.r2,this.n.x*g,this.n.y*g)},yc.prototype.getImpulse=function(){return 0};var zc=function(a,b){return(b-a.restAngle)*a.stiffness},Ac=a.DampedRotarySpring=function(a,b,c,d,e){sc.call(this,a,b),this.restAngle=c,this.stiffness=d,this.damping=e,this.springTorqueFunc=zc,this.target_wrn=0,this.w_coef=0,this.iSum=0};Ac.prototype=Object.create(sc.prototype),Ac.prototype.preStep=function(a){var b=this.a,c=this.b,d=b.i_inv+c.i_inv;e(0!==d,"Unsolvable spring."),this.iSum=1/d,this.w_coef=1-Math.exp(-this.damping*a*d),this.target_wrn=0;var f=this.springTorqueFunc(this,b.a-c.a)*a;b.w-=f*b.i_inv,c.w+=f*c.i_inv},Ac.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=a.w-b.w,d=(this.target_wrn-c)*this.w_coef;this.target_wrn=c+d;var e=d*this.iSum;a.w+=e*a.i_inv,b.w-=e*b.i_inv};var Bc=a.RotaryLimitJoint=function(a,b,c,d){sc.call(this,a,b),this.min=c,this.max=d,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Bc.prototype=Object.create(sc.prototype),Bc.prototype.preStep=function(a){var b=this.a,c=this.b,d=c.a-b.a,e=0;d>this.max?e=this.max-d:d<this.min&&(e=this.min-d),this.iSum=1/(1/b.i+1/c.i);var f=this.maxBias;this.bias=p(-rc(this.errorBias,a)*e/a,-f,f),this.jMax=this.maxForce*a,this.bias||(this.jAcc=0)},Bc.prototype.applyCachedImpulse=function(a){var b=this.a,c=this.b,d=this.jAcc*a;b.w-=d*b.i_inv,c.w+=d*c.i_inv},Bc.prototype.applyImpulse=function(){if(this.bias){var a=this.a,b=this.b,c=b.w-a.w,d=-(this.bias+c)*this.iSum,e=this.jAcc;this.jAcc=this.bias<0?p(e+d,0,this.jMax):p(e+d,-this.jMax,0),d=this.jAcc-e,a.w-=d*a.i_inv,b.w+=d*b.i_inv}},Bc.prototype.getImpulse=function(){return Math.abs(joint.jAcc)};var Cc=a.RatchetJoint=function(a,b,c,d){sc.call(this,a,b),this.angle=0,this.phase=c,this.ratchet=d,this.angle=(b?b.a:0)-(a?a.a:0),this.iSum=this.bias=this.jAcc=this.jMax=0};Cc.prototype=Object.create(sc.prototype),Cc.prototype.preStep=function(a){var b=this.a,c=this.b,d=this.angle,e=this.phase,f=this.ratchet,g=c.a-b.a,h=d-g,i=0;h*f>0?i=h:this.angle=Math.floor((g-e)/f)*f+e,this.iSum=1/(b.i_inv+c.i_inv);var j=this.maxBias;this.bias=p(-rc(this.errorBias,a)*i/a,-j,j),this.jMax=this.maxForce*a,this.bias||(this.jAcc=0)},Cc.prototype.applyCachedImpulse=function(a){var b=this.a,c=this.b,d=this.jAcc*a;b.w-=d*b.i_inv,c.w+=d*c.i_inv},Cc.prototype.applyImpulse=function(){if(this.bias){var a=this.a,b=this.b,c=b.w-a.w,d=this.ratchet,e=-(this.bias+c)*this.iSum,f=this.jAcc;this.jAcc=p((f+e)*d,0,this.jMax*Math.abs(d))/d,e=this.jAcc-f,a.w-=e*a.i_inv,b.w+=e*b.i_inv}},Cc.prototype.getImpulse=function(a){return Math.abs(a.jAcc)};var Dc=a.GearJoint=function(a,b,c,d){sc.call(this,a,b),this.phase=c,this.ratio=d,this.ratio_inv=1/d,this.jAcc=0,this.iSum=this.bias=this.jMax=0};Dc.prototype=Object.create(sc.prototype),Dc.prototype.preStep=function(a){var b=this.a,c=this.b;this.iSum=1/(b.i_inv*this.ratio_inv+this.ratio*c.i_inv);var d=this.maxBias;this.bias=p(-rc(this.errorBias,a)*(c.a*this.ratio-b.a-this.phase)/a,-d,d),this.jMax=this.maxForce*a},Dc.prototype.applyCachedImpulse=function(a){var b=this.a,c=this.b,d=this.jAcc*a;b.w-=d*b.i_inv*this.ratio_inv,c.w+=d*c.i_inv},Dc.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=b.w*this.ratio-a.w,d=(this.bias-c)*this.iSum,e=this.jAcc;this.jAcc=p(e+d,-this.jMax,this.jMax),d=this.jAcc-e,a.w-=d*a.i_inv*this.ratio_inv,b.w+=d*b.i_inv},Dc.prototype.getImpulse=function(){return Math.abs(this.jAcc)},Dc.prototype.setRatio=function(a){this.ratio=a,this.ratio_inv=1/a,this.activateBodies()};var Ec=a.SimpleMotor=function(a,b,c){sc.call(this,a,b),this.rate=c,this.jAcc=0,this.iSum=this.jMax=0};Ec.prototype=Object.create(sc.prototype),Ec.prototype.preStep=function(a){this.iSum=1/(this.a.i_inv+this.b.i_inv),this.jMax=this.maxForce*a},Ec.prototype.applyCachedImpulse=function(a){var b=this.a,c=this.b,d=this.jAcc*a;b.w-=d*b.i_inv,c.w+=d*c.i_inv},Ec.prototype.applyImpulse=function(){var a=this.a,b=this.b,c=b.w-a.w+this.rate,d=-c*this.iSum,e=this.jAcc;this.jAcc=p(e+d,-this.jMax,this.jMax),d=this.jAcc-e,a.w-=d*a.i_inv,b.w+=d*b.i_inv},Ec.prototype.getImpulse=function(){return Math.abs(this.jAcc)}}();var AWGLActor,AWGLActorInterface,AWGLAjax,AWGLBezAnimation,AWGLColor3,AWGLEngine,AWGLInterface,AWGLLog,AWGLPhysics,AWGLRenderer,AWGLShader,AWGLUtilParam,AWGLVertAnimation;AWGLUtilParam=function(){function a(){}return a.required=function(a,b,c){var d,e,f,g;if(null===a&&c!==!0&&(a=void 0),void 0===a)throw new Error("Required argument missing!");if(b instanceof Array&&b.length>0){for(d=!1,f=0,g=b.length;g>f;f++)if(e=b[f],a===e){d=!0;break}if(!d)throw new Error("Required argument is not of a valid value!")}return a},a.optional=function(a,b,c,d){var e,f,g,h;if(null===a&&d!==!0&&(a=void 0),void 0===a&&(a=b),c instanceof Array&&c.length>0){for(e=!1,g=0,h=c.length;h>g;g++)if(f=c[g],a===f){e=!0;break}if(!e)throw new Error("Required argument is not of a valid value!")}return a},a}(),window.param=AWGLUtilParam,AWGLColor3=function(){function a(b,c,d){b=param.optional(b,0),c=param.optional(c,0),d=param.optional(d,0),b instanceof a?(this._r=b.getR(),this._g=b.getG(),this._b=b.getB()):(this.setR(b),this.setG(c),this.setB(d))}return a.prototype.getR=function(a){return a!==!0?this._r:this._r/255},a.prototype.getG=function(a){return a!==!0?this._g:this._g/255},a.prototype.getB=function(a){return a!==!0?this._b:this._b/255},a.prototype.setR=function(a){return a=Number(a),0>a&&(a=0),a>255&&(a=255),this._r=a},a.prototype.setG=function(a){return a=Number(a),0>a&&(a=0),a>255&&(a=255),this._g=a},a.prototype.setB=function(a){return a=Number(a),0>a&&(a=0),a>255&&(a=255),this._b=a},a.prototype.toString=function(){return"("+this._r+", "+this._g+", "+this._b+")"},a}(),AWGLShader=function(){function a(a,b,c,d){var e;if(this._vertSrc=a,this._fragSrc=b,this._gl=c,param.required(this._vertSrc),param.required(this._fragSrc),param.required(this._gl),d=param.optional(d,!1),this.errors=[],this._prog=null,this._vertShader=null,this._fragShader=null,this._handles=null,d===!0&&(e=this.build(this._gl),e===!1))throw new Error("Failed to build shader! "+JSON.stringify(this.errors))}return a.prototype.build=function(a){var b;if(this._gl=a,param.required(this._gl),b=this._gl,this.errors=[],void 0===b||null===b)throw new Error("Need a valid gl object to build a shader!");return this._vertShader=b.createShader(b.VERTEX_SHADER),this._fragShader=b.createShader(b.FRAGMENT_SHADER),b.shaderSource(this._vertShader,this._vertSrc),b.shaderSource(this._fragShader,this._fragSrc),b.compileShader(this._vertShader),b.compileShader(this._fragShader),b.getShaderParameter(this._vertShader,b.COMPILE_STATUS)||this.errors.push(b.getShaderInfoLog(this._vertShader)),b.getShaderParameter(this._fragShader,b.COMPILE_STATUS)||this.errors.push(b.getShaderInfoLog(this._fragShader)),this._prog=b.createProgram(),b.attachShader(this._prog,this._vertShader),b.attachShader(this._prog,this._fragShader),b.linkProgram(this._prog),b.getProgramParameter(this._prog,b.LINK_STATUS)||this.errors.push("Failed to link!"),this.errors.length>0?!1:!0},a.prototype.generateHandles=function(){var a,b,c,d,e,f,g,h,i;if(null===this._prog)return AWGLEngine.getLog().error("Build program before generating handles"),!1;if(null!==this._handles)return AWGLEngine.getLog().warn("Refusing to re-generate handles!"),!1;for(this._handles={},h=function(a,b,c){var d,e;if(a=a.split(" "),d=a[a.length-1].replace(";",""),1===b){if(e={n:d,h:c._gl.getUniformLocation(c._prog,d)},"object"!=typeof e.h)throw new Error("Failed to get handle for uniform "+d+" ["+e.h+"]");return e}if(2===b)return e={n:d,h:c._gl.getAttribLocation(c._prog,d)};throw new Error("Type not 1 or 2, WTF, internal error")},i=[this._vertSrc,this._fragSrc],d=0,f=i.length;f>d;d++)for(c=i[d],c=c.split(";"),e=0,g=c.length;g>e&&(b=c[e],-1===b.indexOf("main()"));e++)-1!==b.indexOf("attribute")?(a=h(b,2,this),this._handles[a.n]=a.h):-1!==b.indexOf("uniform")&&(a=h(b,1,this),this._handles[a.n]=a.h);return!0},a.prototype.getHandles=function(){return this._handles},a.prototype.getProgram=function(){return this._prog},a}(),AWGLRenderer=function(){function a(b,c,d){var e,f,g,h,i,j;if(this._width=c,this._height=d,b=param.optional(b,""),this._defaultShader=null,this._canvas=null,this._ctx=null,this._pickRenderRequested=!1,this._pickRenderBuff=null,this._pickRenderCB=null,this.initError=void 0,0===b.length&&(b=void 0),null!==a.me)throw new Error("Only one instance of AWGLRenderer can be created!");if(a.me=this,f=null,this._width=param.optional(this._width,800),this._height=param.optional(this._height,600),this._width<=1||this._height<=1)throw new Error("Canvas must be at least 2x2 in size");return j=function(b,c,d,e){var f;return f=a.me._canvas=document.createElement("canvas"),f.width=d,f.height=e,f.id="awgl_canvas","body"===b?document.getElementsByTagName(b)[0].appendChild(f):document.getElementById(b).appendChild(f)},void 0===b||null===b?(j("body","awgl_canvas",this._width,this._height),AWGLLog.info("Creating canvas #awgl_canvas ["+this._width+"x"+this._height+"]")):(this._canvas=document.getElementById(b),null===this._canvas?(j("body",b,this._width,this._height),AWGLLog.info("Creating canvas #"+b+" ["+this._width+"x"+this._height+"]")):"canvas"===this._canvas.nodeName.toLowerCase()?(AWGLLog.warn("Canvas exists, ignoring supplied dimensions"),this._width=this._canvas.width,this._height=this._canvas.height,AWGLLog.info("Using canvas #"+b+" ["+this._width+"x"+this._height+"]")):(j(b,"awgl_canvas",this._width,this._height),AWGLLog.info("Creating canvas #awgl_canvas ["+this._width+"x"+this._height+"]"))),f=this._canvas.getContext("webgl"),null===f&&(AWGLLog.warn("Continuing with experimental webgl support"),f=this._canvas.getContext("experimental-webgl")),null===f?(alert("Your browser does not support WebGL!"),this.initError="Your browser does not support WebGL!",void 0):(a._gl=f,this._ctx=this._canvas.getContext("2d"),AWGLLog.info("Created WebGL context"),f.enable(f.DEPTH_TEST),f.depthFunc(f.LEQUAL),AWGLLog.info("Renderer initialized"),i="attribute vec2 Position;uniform mat4 Projection;uniform mat4 ModelView;void main() {  mat4 mvp = Projection * ModelView;  gl_Position = mvp * vec4(Position, 1, 1);}\n",e="precision mediump float;uniform vec4 Color;void main() {  gl_FragColor = Color;}\n",this._defaultShader=new AWGLShader(i,e,f,!0),this._defaultShader.generateHandles(),g=this._defaultShader.getHandles(),f.useProgram(this._defaultShader.getProgram()),f.enableVertexAttribArray(a.attrVertPosition),f.enableVertexAttribArray(a.attrVertColor),h=makeOrtho(0,this._width,0,this._height,-10,10).flatten(),f.uniformMatrix4fv(g.Projection,!1,h),AWGLLog.info("Initialized shaders"),this.setClearColor(0,0,0),void 0)}return a._nextID=0,a._gl=null,a._PPM=128,a.getPPM=function(){return a._PPM},a.getMPP=function(){return 1/a._PPM},a.screenToWorld=function(b){var c;return c=new cp.v,c.x=b.x/a._PPM,c.y=b.y/a._PPM,c},a.worldToScreen=function(b){var c;return c=new cp.v,c.x=b.x*a._PPM,c.y=b.y*a._PPM,c},a.actors=[],a.me=null,a.getMe=function(){return a.me},a.prototype.getDefaultShader=function(){return this._defaultShader},a.prototype.getCanvas=function(){return this._canvas},a.prototype.getContext=function(){return this._ctx},a.getGL=function(){return a._gl},a.prototype.getWidth=function(){return this._width},a.prototype.getHeight=function(){return this._height},a.prototype.getClearColor=function(){return this._clearColor},a.prototype.setClearColor=function(b,c,d){return void 0===this._clearColor&&(this._clearColor=new AWGLColor3),b instanceof AWGLColor3?this._clearColor=b:((void 0===b||null===b)&&(b=0),(void 0===c||null===c)&&(c=0),(void 0===d||null===d)&&(d=0),this._clearColor.setR(b),this._clearColor.setG(c),this._clearColor.setB(d)),b=this._clearColor.getR(!0),c=this._clearColor.getG(!0),d=this._clearColor.getB(!0),null!==a._gl&&void 0!==a._gl?a._gl.clearColor(b,c,d,1):AWGLLog.error("Can't set clear color, AWGLRenderer._gl not valid!")},a.prototype.requestPickingRender=function(a,b){return param.required(a),param.required(b),this._pickRenderRequested?(AWGLLog.warn("Pick render already requested! No request queue"),void 0):(this._pickRenderBuff=a,this._pickRenderCB=b,this._pickRenderRequested=!0)},a.prototype.render=function(){var b,c,d,e,f,g,h,i;if(c=a._gl,void 0!==c&&null!==c){for(this._pickRenderRequested&&c.bindFramebuffer(c.FRAMEBUFFER,this._pickRenderBuff),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT),h=a.actors,d=0,g=h.length;g>d;d++)b=h[d],this._pickRenderRequested?(i=b.getColor(),e=b.getId()-255*Math.floor(b.getId()/255),f=Math.floor(b.getId()/255),b.setColor(e,f,248),b.draw(c),b.setColor(i)):b.draw(c);return this._pickRenderRequested?(this._pickRenderCB(),this._pickRenderRequested=!1,this._pickRenderBuff=null,this._pickRenderCB=null,c.bindFramebuffer(c.FRAMEBUFFER,null),this.render()):void 0}},a.getNextId=function(){return a._nextID++},a}(),AWGLPhysics=function(){function a(){throw new Error("Physics constructor called")}return a.velIterations=6,a.posIterations=2,a.frameTime=1/60,a._gravity=new cp.v(0,-1),a._stepIntervalId=null,a._world=null,a._densityRatio=1e-4,a.bodyCount=0,a.startStepping=function(){var a;if(null===this._stepIntervalId)return this._world=new cp.Space,this._world.gravity=this._gravity,this._world.iterations=60,this._world.collisionSlop=.5,this._world.sleepTimeThreshold=.5,a=this,AWGLLog.info("Starting world update loop"),this._stepIntervalId=setInterval(function(){return a._world.step(a.frameTime)},this.frameTime)},a.stopStepping=function(){return null!==this._stepIntervalId?(AWGLLog.info("Halting world update loop"),clearInterval(this._stepIntervalId),this._stepIntervalId=null,this._world=null):void 0},a.getWorld=function(){return this._world},a.getDensityRatio=function(){return this._densityRatio},a.getGravity=function(){return this._gravity},a.setGravity=function(a){if(!(a instanceof cp.Vect))throw new Error("You need to set space gravity using cp.v!");return this._gravity=a,null!==this._world&&void 0!==this._world?this._world.gravity=a:void 0},a}(),AWGLLog=function(){function a(){}return a.tags=["","[Error]> ","[Warning]> ","[Debug]> ","[Info]> "],a.level=4,a.w=function(b,c){var d;return d=a,b>d.level||0===b||0===d.level?void 0:1===b&&void 0!==console.error?(console.error(""+d.tags[b]+c),void 0):2===b&&void 0!==console.warn?(console.warn(""+d.tags[b]+c),void 0):3===b&&void 0!==console.debug?(console.debug(""+d.tags[b]+c),void 0):4===b&&void 0!==console.info?(console.info(""+d.tags[b]+c),void 0):(b>4&&void 0!==d.tags[b]?console.log(""+d.tags[b]+c):console.log(c),void 0)},a.error=function(a){return this.w(1,a)},a.warn=function(a){return this.w(2,a)},a.debug=function(a){return this.w(3,a)},a.info=function(a){return this.w(4,a)},a}(),AWGLAjax=function(){function a(){this.busy=!1,this.queue=[]}return a.prototype.r=function(a,b){var c;if(param.required(a),c=this,this.busy)return this.queue.push({url:a,cb:b}),!1;if(0===this.queue.length)return this.busy=!0,this._callMjax(a,b),!0;throw new Error("[AWGLAjax] Queue length non-zero and busy flag not set!")},a.prototype._callMjax=function(a,b){var c;return c=this,window.microAjax(a,function(a){var d;return c.queue.length>0?(d=c.queue.pop(),c._callMjax(d.url,d.cb)):c.busy=!1,"function"==typeof b?b(a):void 0})},a}(),AWGLActorInterface=function(){function a(){}return a.prototype._findActor=function(a){var b,c,d,e;for(param.required(a),e=AWGLRenderer.actors,c=0,d=e.length;d>c;c++)if(b=e[c],b.getId()===a)return b;return null},a.prototype.createActor=function(a){var b;return param.required(a),a=JSON.parse(a),b=new AWGLActor(a),b.getId()},a.prototype.updateVertices=function(a,b){var c;return param.required(a),param.required(b),null!==(c=this._findActor(b))?(c.updateVertices(JSON.parse(a)),!0):!1},a.prototype.destroyActor=function(a){var b,c,d,e,f;for(param.required(a),f=AWGLRenderer.actors,c=d=0,e=f.length;e>d;c=++d)if(b=f[c],b.getId()===a)return b.destroyPhysicsBody(),AWGLRenderer.actors.splice(c,1),b=void 0,!0;return!1},a.prototype.setPhysicsVertices=function(a,b){var c;return param.required(a),param.required(b),null!==(c=this._findActor(b))?(c.setPhysicsVertices(JSON.parse(a)),!0):!1},a.prototype.setRenderMode=function(a,b){var c;return a=param.required(a,[1,2]),param.required(b),null!==(c=this._findActor(b))?(c.setRenderMode(a),!0):!1},a.prototype.setActorPosition=function(a,b,c){var d;return param.required(a),param.required(b),param.required(c),null!==(d=this._findActor(c))?(d.setPosition(new cp.v(a,b)),!0):!1},a.prototype.getActorPosition=function(a){var b,c;return param.required(a),null!==(b=this._findActor(a))?(c=b.getPosition(),JSON.stringify({x:c.x,y:c.y})):null},a.prototype.setActorRotation=function(a,b,c){var d;return param.required(a),param.required(b),c=param.optional(c,!1),null!==(d=this._findActor(b))?(d.setRotation(a,c),!0):!1},a.prototype.getActorRotation=function(a,b){var c;return param.required(a),b=param.optional(b,!1),null!==(c=this._findActor(a))?c.getRotation(b):-1},a.prototype.setActorColor=function(a,b,c,d){var e;return param.required(a),param.required(b),param.required(c),param.required(d),null!==(e=this._findActor(d))?(e.setColor(new AWGLColor3(a,b,c)),!0):!1},a.prototype.getActorColor=function(a){var b;return param.required(a),null!==(b=this._findActor(a))?JSON.stringify({r:b.getColor().getR(),g:b.getColor().getG(),b:b.getColor().getB()}):null},a.prototype.enableActorPhysics=function(a,b,c,d){var e;return param.required(d),param.required(a),param.required(b),param.required(c),null!==(e=this._findActor(d))?(e.createPhysicsBody(a,b,c),!0):!1},a.prototype.destroyPhysicsBody=function(a){var b;return param.required(a),null!==(b=this._findActor(a))&&b.destroyPhysicsBody(),!1},a}(),AWGLInterface=function(){function a(){this._Actors=new AWGLActorInterface}return a.prototype.Actors=function(){return this._Actors},a}(),AWGLEngine=function(){function a(a,b,c,d,e,f){var g;return this.url=a,null===this.url&&(this.url=void 0),this.url=param.optional(this.url,""),b=param.optional(b,4),d=param.optional(d,""),this["package"]=null,this.ajax=null,this._renderer=null,this._renderIntervalId=null,this._framerate=1/60,this.initError=void 0,AWGLLog.level=b,null===window.ajax||void 0===window.ajax?(AWGLLog.error("Ajax library is not present!"),this.initSuccess="Ajax library is not present!",void 0):null===window._||void 0===window._?(AWGLLog.error("Underscore.js is not present!"),this.initSuccess="Underscore.js is not present!",void 0):void 0===window.cp||null===window.cp?(AWGLLog.error("Chipmunk-js is not present!"),this.initSuccess="Chipmunk-js is not present!",void 0):(this.url.length>0?(this.ajax=new AWGLAjax,g=this,this.ajax.r(""+this.url+"/package.json",function(a){var b;return AWGLLog.info("...fetched package.json"),g["package"]=JSON.parse(a),(b=g.verifyPackage(g["package"],function(){return AWGLLog.info("...downloaded. Creating Renderer"),g._renderer=new AWGLRenderer(d,e,f),g.startRendering(),AWGLPhysics.startStepping(),window.AdefyGLI=new AWGLInterface,null!==c&&void 0!==c?c(this):void 0}))?AWGLLog.info("package.json valid, downloading assets..."):(AWGLLog.error("Invalid package.json"),this.initSuccess="Invalid package.json",void 0)}),AWGLLog.info("Engine initialized, awaiting package.json...")):void 0!==c?(this._renderer=new AWGLRenderer(d,e,f),window.AdefyGLI=new AWGLInterface,AWGLLog.info("Engine initialized, executing cb"),c(this)):AWGLLog.error("Engine can't initialize, no url or cb was passed in!"),void 0)}return a.prototype.verifyPackage=function(a,b){var c,d,e,f,g,h,i,j;h={company:"",apikey:"",load:"",scenes:{}};for(c in h)if(void 0===a[c])return AWGLLog.error("package.json invalid, missing key "+c),!1;if(0===a.scenes.length)return AWGLLog.warning(".json does not specify any scenes, can't continue"),!1;e={load:null,scenes:{}},g=1+_.size(a.scenes),d=this,j=function(a,c){return"load"===a?e.load=c:e.scenes[a]=c,g--,0===g?b(e):void 0},i=function(a,b){return d.ajax.r(""+d.url+b,function(b){return j(a,b)})},this.ajax.r(""+this.url+a.load,function(a){return j("load",a)});for(f in a.scenes)i(f,a.scenes[f]);return!0},a.prototype.setFPS=function(a){return this._framerate=1/a},a.prototype.startRendering=function(){var a;if(null===this._renderIntervalId)return a=this,AWGLLog.info("Starting render loop"),this._renderIntervalId=setInterval(function(){return a._renderer.render()},this._framerate)},a.prototype.stopRendering=function(){return null!==this._renderIntervalId?(AWGLLog.info("Halting render loop"),clearInterval(this._renderIntervalId),this._renderIntervalId=null):void 0},a.prototype.getWidth=function(){return null===this._renderer||void 0===this._renderer?-1:this._renderer.getWidth()},a.prototype.getHeight=function(){return null===this._renderer||void 0===this._renderer?-1:this._renderer.getHeight()},a.prototype.requestPickingRender=function(a,b){return null===this._renderer||void 0===this._renderer?AWGLLog.warn("Can't request a pick render, renderer not instantiated!"):this._renderer.requestPickingRender(a,b)},a.prototype.getGL=function(){return null===AWGLRenderer._gl?(AWGLLog.warn("No gl object to get, render not instantiated!"),null):AWGLRenderer._gl},a}(),AWGLBezAnimation=function(){function a(a,b){this.actor=a,param.required(this.actor),param.required(b.duration),this.bezOpt={},b.controlPoints.length>0?(this.bezOpt.degree=b.controlPoints.length,this.bezOpt.degree>0&&(param.required(b.controlPoints[0].x),param.required(b.controlPoints[0].y),2===degree&&(param.required(b.controlPoints[1].x),param.required(b.controlPoints[1].y))),this.bezOpt.ctrl=b.controlPoints):this.bezOpt.degree=0,this.bezOpt.property=param.required(b.property),"rotation"===this.bezOpt.property&&(this.bezOpt.startPos=this.actor.getRotation()),"position"===this.bezOpt.property[0]&&("x"===this.bezOpt.property[1]?this.bezOpt.startPos=this.actor.getPosition().x:"y"===this.bezOpt.property[1]&&(this.bezOpt.startPos=this.actor.getPosition().y)),"color"===this.bezOpt.property[0]&&("r"===this.bezOpt.property[1]?this.bezOpt.startPos=this.actor.getColor().getR():"g"===this.bezOpt.property[1]?this.bezOpt.startPos=this.actor.getColor().getG():"b"===this.bezOpt.property[1]&&(this.bezOpt.startPos=this.actor.getColor().getB())),this.bezOpt.endPos=param.required(b.endVal),this.incr=1/(1e3*b.duration/16.667),this.temp=0,this._intervalID=null}return a.prototype.update=function(a){var b,c,d,e,f,g,h,i,j,k;if(param.required(a),this.temp+this.incr<=1?this.temp+=this.incr:(a=1,clearInterval(this._intervalID)),a>1||0>a)throw clearInterval(this._intervalID),new Error("t out of bounds! "+a);if(0===this.bezOpt.degree)c=this.bezOpt.startPos+(this.bezOpt.endPos-this.bezOpt.startPos)*a;else if(1===this.bezOpt.degree)d=1-a,e=d*d,j=a*a,c=e*this.bezOpt.startPos+2*d*a*this.bezOpt.ctrl[0].y+j*this.bezOpt.endPos;else{if(2!==this.bezOpt.degree)throw clearInterval(this._intervalID),new Error("Invalid degree, can't evaluate ("+this.bezOpt.degree+")");d=1-a,e=d*d,f=e*d,j=a*a,k=j*a,c=f*this.bezOpt.startPos+3*e*a*this.bezOpt.ctrl[0].y+3*d*j*this.bezOpt.ctrl[1].y+k*this.bezOpt.endPos}if("rotation"===this.bezOpt.property&&this.actor.setRotation(c),"position"===this.bezOpt.property[0]&&("x"===this.bezOpt.property[1]?(b=new cp.v(c,this.actor.getPosition().y),this.actor.setPosition(b)):"y"===this.bezOpt.property[1]&&(b=new cp.v(this.actor.getPosition().x,c),this.actor.setPosition(b))),"color"===this.bezOpt.property[0]){if("r"===this.bezOpt.property[1])return i=c,h=this.actor.getColor().getG(),g=this.actor.getColor().getB(),this.actor.setColor(i,h,g);if("g"===this.bezOpt.property[1])return i=this.actor.getColor().getR(),h=c,g=this.actor.getColor().getB(),this.actor.setColor(i,h,g);if("b"===this.bezOpt.property[1])return i=this.actor.getColor().getR(),h=this.actor.getColor().getG(),g=c,this.actor.setColor(i,h,g)
}},a.prototype.animate=function(){var a;return a=this,this._intervalID=setInterval(function(){return a.update(a.temp)},16.667)},a}(),AWGLVertAnimation=function(){function a(a,b,c){this.actor=a,this.options=b,this.relOrabs=c,param.required(this.actor),param.required(this.options),param.optional(this.relOrabs)}return a.prototype.update=function(a,b){var c;return c=this,setTimeout(function(){return c.actor.updateVertices(a)},b)},a.prototype.animate=function(){var a,b,c,d,e,f,g;for(b=this,f=this.options.vertices,g=[],a=d=0,e=f.length;e>d;a=++d)c=f[a],g.push(b.update(this.options.vertices[a],this.options.time[a]));return g},a}(),AWGLActor=function(){function a(a){if(param.required(a),this._gl=AWGLRenderer._gl,void 0===this._gl||null===this._gl)throw new Error("GL context is required for actor initialization!");this._color=null,this._colArray=null,this.lit=!1,this.visible=!0,this._id=-1,this._position=new cp.v(0,0),this._rotation=0,this._rotV=null,this._transV=null,this._modelM=null,this._shape=null,this._body=null,this._friction=null,this._mass=null,this._elasticity=null,this._vertices=[],this._psyxVertices=[],this._vertBuffer=null,this._vertBufferFloats=null,this._sh_modelview=null,this._sh_position=null,this._sh_color=null,this._renderMode=1,this._id=AWGLRenderer._nextID++,AWGLRenderer.actors.push(this),this.updateVertices(a),this.setColor(new AWGLColor3(255,255,255)),this._rotV=$V([0,0,1]),this._transV=$V([0,0,1]),this._modelM=Matrix.I(4),this.setShader(AWGLRenderer.getMe().getDefaultShader())}return a.defaultFriction=.3,a.defaultMass=10,a.defaultElasticity=.2,a._nullV=new cp.v(0,0),a.prototype.setShader=function(a){var b;if(param.required(a),null===a.getProgram())throw new Error("Shader has to be built before it can be used!");return null===a.getHandles()&&a.generateHandles(),b=a.getHandles(),this._sh_modelview=b.ModelView,this._sh_position=b.Position,this._sh_color=b.Color},a.prototype.createPhysicsBody=function(b,c,d){var e,f,g,h,i,j,k,l,m,n,o,p;if(this._mass=b,this._friction=c,this._elasticity=d,(null===AWGLPhysics.getWorld()||void 0===AWGLPhysics.getWorld())&&AWGLPhysics.startStepping(),this._shape!==!0){for(0===AWGLPhysics.bodyCount&&AWGLPhysics.startStepping(),AWGLPhysics.bodyCount++,(void 0===this._mass||null===this._mass)&&(this._mass=0),this._mass<0&&(this._mass=0),void 0===this._friction?this._friction=a.defaultFriction:this._friction<0&&(this._friction=0),void 0===this._elasticity?this._elasticity=a.defaultElasticity:this._elasticity<0&&(this._elasticity=0),l=[],k=0,h=null,h=this._psyxVertices.length>6?this._psyxVertices:this._vertices,f=o=0,p=h.length-1;p>o;f=o+=2)l.push(h[f]/AWGLRenderer.getPPM()),l.push(h[f+1]/AWGLRenderer.getPPM()),0===this._mass&&(m=l[l.length-2],n=l[l.length-1],e=this._rotation,l[l.length-2]=m*Math.cos(e)-n*Math.sin(e),l[l.length-1]=m*Math.sin(e)+n*Math.cos(e));return j=AWGLPhysics.getWorld(),i=AWGLRenderer.screenToWorld(this._position),0===this._mass?(this._shape=j.addShape(new cp.PolyShape(j.staticBody,l,i)),this._body=null):(g=cp.momentForPoly(this._mass,l,a._nullV),this._body=j.addBody(new cp.Body(this._mass,g)),this._body.setPos(i),this._body.setAngle(this._rotation),this._shape=j.addShape(new cp.PolyShape(this._body,l,a._nullV))),this._shape.setFriction(this._friction),this._shape.setElasticity(this._elasticity)}},a.prototype.destroyPhysicsBody=function(){if(0!==AWGLPhysics.bodyCount&&null!==this._shape){if(AWGLPhysics.bodyCount--,AWGLPhysics.getWorld().removeShape(this._shape),this._body&&AWGLPhysics.getWorld().removeBody(this._body),this._shape=null,this._body=null,0===AWGLPhysics.bodyCount)return AWGLPhysics.stopStepping();if(AWGLPhysics.bodyCount<0)throw new Error("Body count is negative!")}},a.prototype.updateVertices=function(a){if(this._vertices=param.required(a),this._vertices.length<6)throw new Error("At least 3 vertices make up an actor");return this._vertBuffer=this._gl.createBuffer(),this._vertBufferFloats=new Float32Array(this._vertices),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,this._vertBuffer),this._gl.bufferData(this._gl.ARRAY_BUFFER,this._vertBufferFloats,this._gl.STATIC_DRAW),this._gl.bindBuffer(this._gl.ARRAY_BUFFER,null)},a.prototype.setPhysicsVertices=function(a){return this._psyxVertices=param.required(a),null!==this._body?(this.destroyPhysicsBody(),this.createPhysicsBody(this._mass,this._friction,this._elasticity)):void 0},a.prototype.draw=function(a){var b;if(param.required(a),this.visible){if(null!==this._body&&(this._position=AWGLRenderer.worldToScreen(this._body.getPos()),this._rotation=this._body.a),this._modelM=Matrix.I(4),this._transV.elements[0]=this._position.x,this._transV.elements[1]=this._position.y,this._modelM=this._modelM.x(Matrix.Translation(this._transV).ensure4x4()),this._modelM=this._modelM.x(Matrix.Rotation(this._rotation,this._rotV).ensure4x4()),b=new Float32Array(this._modelM.flatten()),a.bindBuffer(a.ARRAY_BUFFER,this._vertBuffer),a.vertexAttribPointer(this._sh_position,2,a.FLOAT,!1,0,0),a.uniform4f(this._sh_color,this._colArray[0],this._colArray[1],this._colArray[2],1),a.uniformMatrix4fv(this._sh_modelview,!1,b),1===this._renderMode)return a.drawArrays(a.TRIANGLE_STRIP,0,this._vertices.length/2);if(2===this._renderMode)return a.drawArrays(a.TRIANGLE_FAN,0,this._vertices.length/2);throw new Error("Invalid render mode! "+this._renderMode)}},a.prototype.setRenderMode=function(a){return this._renderMode=param.required(a,[1,2])},a.prototype.setPosition=function(a){return param.required(a),null===this._shape?this._position=a instanceof cp.v?a:new cp.v(Number(a.x),Number(a.y)):null!==this._body?this._body.setPos(AWGLRenderer.screenToWorld(a)):void 0},a.prototype.setRotation=function(a,b){return param.required(a),b=param.optional(b,!1),b===!1&&(a=.0174532925*Number(a)),null===this._shape?this._rotation=a:null!==this._body?this._body.SetAngle(this._rotation):void 0},a.prototype.getPosition=function(){return this._position},a.prototype.getRotation=function(a){return a=param.optional(a,!1),a===!1?57.2957795*this._rotation:this._rotation},a.prototype.getVertices=function(){return this._vertices},a.prototype.getId=function(){return this._id},a.prototype.getColor=function(){return new AWGLColor3(this._color)},a.prototype.setColor=function(a,b,c){return param.required(a),(void 0===this._color||null===this._color)&&(this._color=new AWGLColor3),a instanceof AWGLColor3?(this._color=a,this._colArray=[a.getR(!0),a.getG(!0),a.getB(!0)]):(param.required(b),param.required(c),this._color.setR(Number(a)),this._color.setG(Number(b)),this._color.setB(Number(c)),this._colArray=[this._color.getR(!0),this._color.getG(!0),this._color.getB(!0)])},a}();var AJSBaseActor,AJSColor3,AJSPolygon,AJSRectangle,AJSTriangle,AJSUtilParam,AJSVector2,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};AJSUtilParam=function(){function a(){}return a.required=function(a,b){var c,d,e,f;if(void 0===a)throw new Error("Required argument missing!");if(b instanceof Array){for(c=!1,e=0,f=b.length;f>e;e++)if(d=b[e],a===d){c=!0;break}if(!c)throw new error("Required argument is not of a valid value!")}return a},a.optional=function(a,b,c){var d,e,f,g;if(void 0===a&&(a=b),c instanceof Array){for(d=!1,f=0,g=c.length;g>f;f++)if(e=c[f],a===e){d=!0;break}if(!d)throw new error("Required argument is not of a valid value!")}return a},a}(),window.param=AJSUtilParam,AJSVector2=function(){function a(a,b){this.x=a||0,this.y=b||0}return a.prototype.negative=function(){return new a(-this.x,-this.y)},a.prototype.add=function(b){return b instanceof a?new a(this.x+b.x,this.y+b.y):new a(this.x+b,this.y+b)},a.prototype.subtract=function(b){return b instanceof a?new a(this.x-b.x,this.y-b.y):new a(this.x-b,this.y-b)},a.prototype.multiply=function(b){return b instanceof a?new a(this.x*b.x,this.y*b.y):new a(this.x*b,this.y*b)},a.prototype.divide=function(b){return b instanceof a?new a(this.x/b.x,this.y/b.y):new a(this.x/b,this.y/b)},a.prototype.equals=function(a){return this.x===a.x&&this.y===a.y},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y},a.prototype.cross=function(a){return this.x*a.y-this.y*a.x},a.prototype.ortho=function(){return new a(this.y,-this.x)},a.prototype.length=function(){return Math.sqrt(this.dot(this))},a.prototype.normalize=function(){return this.divide(this.length())},a.prototype.toString=function(){return"("+this.x+", "+this.y+")"},a}(),AJSBaseActor=function(){function a(a,b,c,d){if(this._verts=a,param.required(this._verts),this._m=param.optional(b,0),this._f=param.optional(c,.2),this._e=param.optional(d,.3),0>b&&(b=0),this._verts.length<6)throw"At least three vertices must be provided";if(this._psyx=!1,this._id=window.AdefyGLI.Actors().createActor(JSON.stringify(this._verts)),-1===this._id)throw"Failed to create actor!";this.setPosition(new AJSVector2),this.setRotation(0),this.setColor(new AJSColor3(255,255,255))}return a.prototype.destroy=function(){return window.AdefyGLI.Actors().destroyActor(this._id)},a.prototype._setPhysicsVertices=function(a){return window.AdefyGLI.Actors().setPhysicsVertices(JSON.stringify(a),this._id)},a.prototype._setRenderMode=function(a){return window.AdefyGLI.Actors().setRenderMode(param.required(a,[1,2]),this._id)},a.prototype._updateVertices=function(){return window.AdefyGLI.Actors().updateVertices(JSON.stringify(this._verts),this._id)},a.prototype.getId=function(){return this._id},a.prototype.setPosition=function(a){return this._position=a,window.AdefyGLI.Actors().setActorPosition(a.x,a.y,this._id)},a.prototype.setRotation=function(a,b){return b!==!0&&(b=!1),this._rotation=a,window.AdefyGLI.Actors().setActorRotation(a,this._id,b)},a.prototype.getPosition=function(){var a;return a=JSON.parse(window.AdefyGLI.Actors().getActorPosition(this._id)),new AJSVector2(a.x,a.y)},a.prototype.getRotation=function(a){return a!==!0&&(a=!1),window.AdefyGLI.Actors().getActorRotation(this._id,a)},a.prototype.setColor=function(a){return window.AdefyGLI.Actors().setActorColor(a._r,a._g,a._b,this._id)},a.prototype.getColor=function(){var a;return a=JSON.parse(window.AdefyGLI.Actors().getActorColor(this._id)),new AJSColor3(a.r,a.g,a.b)},a.prototype.hasPsyx=function(){return this._psyx},a.prototype.enablePsyx=function(a,b,c){return this._m=param.optional(a,this._m),this._f=param.optional(b,this._f),this._e=param.optional(c,this._e),this._psyx=window.AdefyGLI.Actors().enableActorPhysics(this._m,this._f,this._e,this._id)},a.prototype.disablePsyx=function(){return this._psyx=!window.AdefyGLI.Actors().destroyPhysicsBody(this._id)},a}(),AJSColor3=function(){function a(a,b,c){this._r=param.optional(a,0),this._g=param.optional(b,0),this._b=param.optional(c,0)}return a.prototype.getR=function(a){return void 0===a?this._r:0===this._r?a?0:0:this._r/255},a.prototype.getG=function(a){return void 0===a?this._g:0===this._g?a?0:0:this._g/255},a.prototype.getB=function(a){return void 0===a?this._b:0===this._b?a?0:0:this._b/255},a.prototype.setR=function(a){return 0>a&&(a=0),a>255&&(a=255),this._r=a},a.prototype.setG=function(a){return 0>a&&(a=0),a>255&&(a=255),this._g=a},a.prototype.setB=function(a){return 0>a&&(a=0),a>255&&(a=255),this._b=a},a.prototype.toString=function(){return"("+this._r+", "+this._g+", "+this._b+")"},a}(),AJSRectangle=function(a){function b(a){if(a=param.required(a),this._w=param.required(a.w),this._h=param.required(a.h),this._w<=0)throw"Width must be greater than 0";if(this._h<=0)throw"Height must be greater than 0";this._rebuildVerts(),b.__super__.constructor.call(this,this._verts,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3&&this.setColor(a.color),a.position instanceof AJSVector2&&this.setPosition(a.position),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx()}return __extends(b,a),b.prototype._rebuildVerts=function(){var a,b;return b=this._w/2,a=this._h/2,this._verts=[],this._verts.push(-b),this._verts.push(-a),this._verts.push(-b),this._verts.push(a),this._verts.push(b),this._verts.push(a),this._verts.push(b),this._verts.push(-a),this._verts.push(-b),this._verts.push(-a)},b.prototype.getWidth=function(){return this._w},b.prototype.getHeight=function(){return this._h},b.prototype.setHeight=function(a){if(param.required(a),0>=a)throw new Error("New height must be >0 !");return this._h=a,this._rebuildVerts(),this._updateVertices()},b.prototype.setWidth=function(a){if(param.required(a),0>=a)throw new Error("New width must be >0 !");return this._w=a,this._rebuildVerts(),this._updateVertices()},b}(AJSBaseActor),AJSTriangle=function(a){function b(a){if(a=param.required(a),this._base=param.required(a.base),this._height=param.required(a.height),this._base<=0)throw"Base must be wider than 0";if(this._height<=0)throw"Height must be greater than 0";this._rebuildVerts(),b.__super__.constructor.call(this,this._verts,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3&&this.setColor(a.color),a.position instanceof AJSVector2&&this.setPosition(a.position),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx()}return __extends(b,a),b.prototype._rebuildVerts=function(){var a,b;return a=this._base/2,b=this._height/2,this._verts=[8],this._verts[0]=-a,this._verts[1]=-b,this._verts[2]=0,this._verts[3]=b,this._verts[4]=a,this._verts[5]=-b,this._verts[6]=-a,this._verts[7]=-b},b.prototype.getBase=function(){return this._base},b.prototype.getHeight=function(){return this._height},b.prototype.setHeight=function(a){if(param.required(a),0>=a)throw new Error("New height must be >0 !");return this._height=a,this._rebuildVerts(),this._updateVertices()},b.prototype.setBase=function(a){if(param.required(a),0>=a)throw new Error("New base must be >0 !");return this._base=a,this._rebuildVerts(),this._updateVertices()},b}(AJSBaseActor),AJSPolygon=function(a){function b(a){var c;if(param.required(a),this._radius=param.required(a.radius),this._segments=param.required(a.segments),a.psyx=param.optional(a.psyx,!1),this._radius<=0)throw"Radius must be larger than 0";if(this._segments<3)throw"Shape must consist of at least 3 segments";this._rebuildVerts(!0),b.__super__.constructor.call(this,this._verts,a.mass,a.friction,a.elasticity),a.color instanceof AJSColor3&&this.setColor(a.color),a.position instanceof AJSVector2&&this.setPosition(a.position),"number"==typeof a.rotation&&this.setRotation(a.rotation),a.psyx&&this.enablePsyx(),c=this._verts,c.length-=2,this._setPhysicsVertices(c),this._setRenderMode(2)}return __extends(b,a),b.prototype._rebuildVerts=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n,o;for(a=param.optional(a,!1),i=this._radius,j=0,f=6.2831852/this._segments,e=Math.tan(f),d=Math.cos(f),this._verts=[],b=k=0,m=this._segments;m>=0?m>k:k>m;b=m>=0?++k:--k)c=2*b,this._verts[c]=i,this._verts[c+1]=j,g=-j,h=i,i+=g*e,j+=h*e,i*=d,j*=d;for(this._verts.push(this._verts[0]),this._verts.push(this._verts[1]),o=[],b=l=0,n=this._verts.length;n>l;b=l+=2)o.push(this._verts[this._verts.length-2-b]),o.push(this._verts[this._verts.length-1-b]);return this._verts=o,a||this._setPhysicsVertices(this._verts),this._verts.push(0),this._verts.push(0)},b.prototype.getRadius=function(){return this._radius},b.prototype.getSegments=function(){return this._segments},b.prototype.setRadius=function(a){if(param.required(a),0>=a)throw new Error("New radius must be >0 !");return this._radius=a,this._rebuildVerts(),this._updateVertices()},b.prototype.setSegments=function(a){if(param.required(a),3>a)throw new Error("New segment count must be >=3 !");return this._segments=a,this._rebuildVerts(),this._updateVertices()},b}(AJSBaseActor);var ABezier,AHBaseActor,AHPolygon,AHRectangle,AHTriangle,AHandle,AUtilLog,AUtilParam,AWidget,AWidgetContextMenu,AWidgetControlBar,AWidgetControlBarControl,AWidgetControlCanvas,AWidgetControlPhysics,AWidgetControlRender,AWidgetMainbar,AWidgetMainbarItem,AWidgetModal,AWidgetNotification,AWidgetSidebar,AWidgetSidebarItem,AWidgetSidebarObject,AWidgetSidebarObjectGroup,AWidgetSidebarProperties,AWidgetTimeline,AWidgetWorkspace,AdefyEditor,__hasProp={}.hasOwnProperty,__extends=function(a,b){function c(){this.constructor=a}for(var d in b)__hasProp.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};window.__nextID=0,window.nextId=function(){return""+window.__nextID++},window.prefId=function(a){return""+a+"-"+window.__nextID++},AUtilLog=function(){function a(){}return a.tags=["","[Error]> ","[Warning]> ","[Debug]> ","[Info]> "],a.level=4,a.w=function(b,c){var d;return d=a,b>d.level||0===b||0===d.level?void 0:1===b&&void 0!==console.error?(console.error(""+d.tags[b]+c),void 0):2===b&&void 0!==console.warn?(console.warn(""+d.tags[b]+c),void 0):3===b&&void 0!==console.debug?(console.debug(""+d.tags[b]+c),void 0):4===b&&void 0!==console.info?(console.info(""+d.tags[b]+c),void 0):(b>4&&void 0!==d.tags[b]?console.log(""+d.tags[b]+c):console.log(c),void 0)},a.error=function(b){return a.w(1,b)},a.warn=function(b){return a.w(2,b)},a.debug=function(b){return a.w(3,b)},a.info=function(b){return a.w(4,b)},a}(),AUtilParam=function(){function a(){}return a.required=function(a,b,c){var d,e,f,g;if(null===a&&c!==!0)throw new Error("Required argument can not be null!");if(void 0===a)throw new Error("Required argument missing!");if(b instanceof Array&&b.length>0){for(d=!1,f=0,g=b.length;g>f;f++)if(e=b[f],a===e){d=!0;break}if(!d)throw new Error("Required argument is not of a valid value!")}return a},a.optional=function(a,b,c,d){var e,f,g,h;if(null===a&&d!==!0&&(a=void 0),void 0===a&&(a=b),c instanceof Array&&c.length>0){for(e=!1,g=0,h=c.length;h>g;g++)if(f=c[g],a===f){e=!0;break}if(!e)throw new Error("Required argument is not of a valid value!")}return a},a}(),window.param=AUtilParam,AHandle=function(){function a(){var a;this._properties={},a=this,this._ctx={Delete:function(){return a["delete"]()}},this._id=prefId("ahandle"),a=this,$(document).ready(function(){return $("body").data(a.getId(),a)})}return a.prototype.getId=function(){return this._id},a.prototype["delete"]=function(){var a;return a=this,$(document).ready(function(){return $("body").removeData(a.getId())})},a.prototype.onClick=function(){return void 0!==$("body").data("default-properties")?$("body").data("default-properties").refresh(this):void 0},a.prototype.renderWorkspace=function(a,b,c){return b=param.optional(b,0),c=param.optional(c,0),a=param.optional(a,""),'<div id="'+this._id+'" class="ahandle">'+a+"</div>"},a.prototype.getProperties=function(){return this._properties},a.prototype.updateProperties=function(a){var b,c;param.required(a),c=[];for(b in a)void 0!==this._properties[b]?"function"==typeof this._properties[b].update?c.push(this._properties[b].update(a[b])):c.push(void 0):c.push(void 0);return c},a.prototype.setProperty=function(a,b){return param.required(a),param.required(b),void 0!==this._properties[a]?this._properties[a]=b:void 0},a.prototype._convertCSS=function(a){var b,c;param.required(a),c='style="';for(b in a)c+=""+b+":"+a[b]+";";return c+='"'},a.prototype.getContextFunctions=function(){return this._ctx},a}(),AHBaseActor=function(a){function b(a,c){var d;b.__super__.constructor.call(this),this._actor=null,this.name="Base Actor "+this._id.replace("ahandle-",""),this.lifetimeStart=param.required(a),this.lifetimeEnd=AWidgetTimeline.getMe().getDuration(),this.lifetimeEnd=param.optional(c,this.lifetimeEnd),this._alive=!1,this.timebarColor=AWidgetTimeline.getRandomTimebarColor(),this._propBuffer={},this._propSnapshot=null,this._initialized=!1,this._animations={},this._capped=!1,this._lastTemporalState=Math.floor(this.lifetimeStart),d=this,this._properties.position={type:"composite",live:!0,components:{x:{type:"number","float":!0,placeholder:0,getValue:function(){return this._value}},y:{type:"number","float":!0,placeholder:0,getValue:function(){return this._value}}},getValue:function(){var a;return null!==d._actor?(a=d._actor.getPosition(),this.components.x._value=a.x,this.components.y._value=a.y):void 0},update:function(a){return param.required(a),a.x=param.optional(a.x,this.components.x._value),a.y=param.optional(a.y,this.components.y._value),this.components.x._value=a.x,this.components.y._value=a.y,null!==d._actor?d._actor.setPosition(new AJSVector2(a.x,a.y)):void 0}},this._properties.rotation={type:"number",live:!0,min:0,max:360,"float":!0,placeholder:0,getValue:function(){return this._value=d._actor.getRotation()},update:function(a){return this._value=param.required(a),null!==d._actor?d._actor.setRotation(a):void 0}},this._properties.color={type:"composite",live:!0,components:{r:{type:"number",min:0,max:255,"float":!1,placeholder:255,_value:255,getValue:function(){return this._value}},g:{type:"number",min:0,max:255,"float":!1,placeholder:255,_value:255,getValue:function(){return this._value}},b:{type:"number",min:0,max:255,"float":!1,placeholder:255,_value:255,getValue:function(){return this._value}}},getValue:function(){var a;return null!==d._actor&&(a=d._actor.getColor(),this.components.r._value=a.getR(),this.components.g._value=a.getG(),this.components.b._value=a.getB()),null},update:function(a){return param.required(a),a.r=param.optional(a.r,this.components.r._value),a.g=param.optional(a.g,this.components.g._value),a.b=param.optional(a.b,this.components.b._value),this.components.r._value=a.r,this.components.g._value=a.g,this.components.b._value=a.b,null!==d._actor?d._actor.setColor(new AJSColor3(a.r,a.g,a.b)):void 0}},this._properties.psyx={type:"composite",live:!1,components:{mass:{type:"number",min:0,"float":!0,placeholder:50,_value:50,getValue:function(){return this._value}},elasticity:{type:"number",min:0,max:1,"float":!0,placeholder:.3,_value:.3,getValue:function(){return this._value}},friction:{type:"number",min:0,max:1,"float":!0,placeholder:.2,_value:.2,getValue:function(){return this._value}},enabled:{type:"bool",_value:!1,getValue:function(){return this._value}}},getValue:function(){},update:function(a){return param.required(a),this.components.mass._value=param.required(a.mass),this.components.elasticity._value=param.required(a.elasticity),this.components.friction._value=param.required(a.friction),this.components.enabled._value=param.required(a.enabled),null!==d._actor&&(d._actor.disablePsyx(),a.enabled)?d._actor.enablePsyx(a.mass,a.friction,a.elasticity):void 0}}}return __extends(b,a),b.prototype.timelineDeath=function(){return this._alive?(this._alive=!1,this._actor.destroy(),this._actor=null):void 0},b.prototype._birth=function(){},b.prototype.isAlive=function(){return this._alive},b.prototype.postInit=function(){var a;if(this._initialized)return AUtilLog.warn("postInit already called, bailing"),void 0;this._initialized=!0,this._birth();for(a in this._properties)this._properties[a].getValue();return this.updateInTime()},b.prototype.perProp=function(a,b){var c,d,e;e=[];for(d in a)"composite"===a[d].type&&void 0!==a[d].components?e.push(function(){var e;e=[];for(c in a[d].components)e.push(b(a[d].components[c],!0));return e}()):e.push(b(a[d],!1));return e},b.prototype.updateInTime=function(){var a;return this._alive||this._birth(),a=AWidgetTimeline.getMe().getCursorTime(),Number(Math.floor(a))!==this._lastTemporalState?(this._updatePropBuffer(),this._updateActorState(),this._genSnapshot(),this._lastTemporalState=Number(Math.floor(a)),AWidgetTimeline.getMe().render()):void 0},b.prototype._genSnapshot=function(){var a,b,c,d,e;this._propSnapshot={},e=[];for(b in this._properties){if(c={},d=this._properties[b],"composite"===d.type&&void 0!==d.components){c.components={};for(a in d.components)c.components[a]={},c.components[a].value=d.components[a]._value}else c.value=d._value;e.push(this._propSnapshot[b]=c)}return e},b.prototype._applyKnownState=function(a){var b,c,d,e,f,g,h;if(param.required(a),Number(a)!==this._lastTemporalState){for(d=Number(a)>this._lastTemporalState?!0:!1,b=[],c=this._lastTemporalState;c!==a&&-1!==c;)c=this._findNearestState(c,d),Number(c)!==Math.floor(this.lifetimeStart)&&-1!==c&&(d&&Number(c)<Number(a)&&b.push(c),!d&&Number(c)>Number(a)&&b.push(c));for(b.sort(function(a,b){return d===!1?Number(a)>Number(b)?-1:Number(a)<Number(b)?1:0:Number(a)>Number(b)?1:Number(a)<Number(b)?-1:0}),h=[],f=0,g=b.length;g>f;f++)e=b[f],h.push(this._applyPropBuffer(this._propBuffer[e]));return h}},b.prototype._applyPropBuffer=function(a){var b,c,d,e,f;param.required(a),e=[];for(c in a)if(d=a[c],void 0!==d.components){f={};for(b in d.components)f[b]=d.components[b].value;e.push(this._properties[c].update(f))}else e.push(this._properties[c].update(d.value));return e},b.prototype._updateActorState=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;if(c=Math.floor(AWidgetTimeline.getMe().getCursorTime()),c!==this._lastTemporalState&&!(c<this.lifetimeStart||c>this.lifetimeEnd)&&(e=c,void 0===this._propBuffer[String(c)]&&(e=this._findNearestState(c)),this._applyKnownState(e),e!==c)){if(-1===this._findNearestState(c,!0))return this._capState(),void 0;for(this._capped=!1,c=Math.floor(AWidgetTimeline.getMe().getCursorTime()),j=[],n=function(a){var b,c,d,e;for(b=!0,d=0,e=j.length;e>d;d++)if(c=j[d],c===a.name){b=!1;break}return b?j.push(a):void 0},d=String(c);-1!==(d=this._findNearestState(d,!0));)for(f in this._propBuffer[d])n({name:f,end:d});for(k=0,l=j.length;l>k;k++){if(h=j[k],a=this._animations[""+h.end],m=this._properties[h.name],void 0===m)throw new Error("We don't have the property "+h.name+"!");if(void 0===a)throw new Error("Animation does not exist for "+h.end+"!");if(void 0===a[h.name])throw new Error("Animation doesn't effect "+h.name+"!");if("composite"===m.type&&void 0!==m.components){i={};for(b in m.components)o=a[h.name].components[b]._start.x,c>=o&&(g=(c-o)/(h.end-o),i[b]=a[h.name].components[b].eval(g).y,this._properties[h.name].update(i))}else o=a[h.name]._start.x,c>=o&&(g=(c-o)/(h.end-o),i=a[h.name].eval(g).y,this._properties[h.name].update(i))}return $("body").data("default-properties").refresh(this)}},b.prototype._capState=function(){var a,b,c,d,e;if(!this._capped){this._capped=!0,b=[];for(a in this._propBuffer)b.push(Number(a));for(b.sort(function(a,b){return a-b}),e=[],c=0,d=b.length;d>c;c++)a=b[c],e.push(this._applyPropBuffer(this._propBuffer[String(a)]));return e}},b.prototype._getPropertiesDelta=function(){var a,b,c,d,e,f,g;b=[],g=this._propSnapshot;for(d in g){if(e=g[d],c=!1,f=this._properties[d],"composite"===f.type&&void 0!==f.components)for(a in f.components)e.components[a].value!==f.components[a]._value&&(c=!0);else e.value!==f._value&&(c=!0);c&&b.push(d)}return b},b.prototype._splitAnimation=function(a,b,c){var d,e,f,g,h,i,j,k;if(param.required(a),param.required(b),c=param.optional(c,null),null===c&&(c=this._findNearestState(a,!1,b)),e=this._findNearestState(a,!0,b),k=this._propBuffer[String(c)][b],g=this._propBuffer[String(a)][b],-1!==e){if(d=this._animations[e],void 0!==d[b].components){j=[];for(f in d[b].components){if(d[b].components[f]._start.x!==Number(c))throw new Error("Existing animation invalid!");h=a,i=g.components[f].value,this._animations[e][b].components[f]._start.x=h,j.push(this._animations[e][b].components[f]._start.y=i)}return j}if(d[b]._start.x!==Number(c))throw new Error("Existing animation invalid!");return h=a,i=g.value,this._animations[e][b]._start.x=h,this._animations[e][b]._start.y=i}},b.prototype._updatePropBuffer=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m;if(null===this._propSnapshot&&(this._propBuffer[this._lastTemporalState]=this._serializeProperties()),c=this._getPropertiesDelta(),c.length>0){if(k=this._serializeProperties(c),this._propBuffer[this._lastTemporalState]=k,this._lastTemporalState===Math.floor(this.lifetimeStart))return;for(void 0===this._animations[""+this._lastTemporalState]&&(this._animations[""+this._lastTemporalState]={}),j=[],h=0,i=c.length;i>h;h++)d=c[h],e=this._findNearestState(this._lastTemporalState,!1,d),this._splitAnimation(this._lastTemporalState,d,e),m=this._propBuffer[String(e)][d],g=this._propBuffer[String(this._lastTemporalState)][d],void 0!==g.components?(this._animations[""+this._lastTemporalState][d]={components:{}},j.push(function(){var c;c=[];for(b in g.components)l={x:Number(e),y:m.components[b].value},f={x:Number(this._lastTemporalState),y:g.components[b].value},a=new ABezier(l,f,0,[],!1),c.push(this._animations[""+this._lastTemporalState][d].components[b]=a);return c}.call(this))):(l={x:Number(e),y:m.value},f={x:Number(this._lastTemporalState),y:g.value},a=new ABezier(l,f,0,[],!1),j.push(this._animations[""+this._lastTemporalState][d]=a));return j}},b.prototype.getAnimations=function(){return this._animations},b.prototype._findNearestState=function(a,b,c){var d,e,f,g,h;a=Number(param.required(a)),b=param.optional(b,!1),c=param.optional(c,null),e=-1;for(f in this._propBuffer)void 0!==this._propBuffer[f]&&(h=Number(f),b?h>a&&(e>h||-1===e)&&(null===c?e=h:void 0!==this._propBuffer[f][c]&&(e=h)):a>h&&h>e&&(null===c?e=h:void 0!==this._propBuffer[f][c]&&(e=h)));if(-1===e){g=[];for(d in this._propBuffer)g.push(d)}return-1===e?-1:String(e)},b.prototype._serializeProperties=function(a){var b,c,d,e,f,g,h,i;a=param.optional(a,[]),f={};for(e in this._properties){if(d=!1,0===a.length)d=!0;else for(g=0,h=a.length;h>g;g++)if(c=a[g],e===c){d=!0;break}if(d)if(i=this._properties[e],f[e]={},"composite"===i.type&&void 0!==i.components){f[e].components={};for(b in i.components)f[e].components[b]={},f[e].components[b].value=i.components[b]._value}else f[e].value=i._value}return f},b.prototype._deserializeProperties=function(a){var b,c,d,e;if(void 0===this._propBuffer[a])throw new Error("Can't deserialize, invalid time provided! "+a);d=this._propBuffer[a],e=[];for(c in d)void 0!==d[c].components?e.push(function(){var a;a=[];for(b in d[c].components)a.push(this._properties[c].components[b]._value=d[c].components[b].value);return a}.call(this)):e.push(this._properties[c]._value=d[c].value);return e},b.prototype["delete"]=function(){var a;return null!==this._actor&&(AWidgetWorkspace.getMe().notifyDemise(this),a=$("body").data("default-properties"),a instanceof AWidgetSidebarProperties&&a.privvyIface("get_id")===this._actor.getId()&&a.clear(),this._actor.destroy(),this._actor=null),b.__super__["delete"].call(this)},b.prototype.getActorId=function(){return null!==this._actor?this._actor.getId():AUtilLog.warn("No actor, can't get id!")},b.prototype.getPosition=function(){var a;return null!==this._actor?(a=this._actor.getPosition(),{x:a.x,y:a.y}):AUtilLog.warn("No actor, can't get position!")},b.prototype.getColor=function(a){var b;return a=param.optional(a,!1),null!==this._actor?(b=this._actor.getColor(),{r:b.getR(a),g:b.getG(a),b:b.getB(a)}):void 0},b.prototype.setPosition=function(a,b){return null!==this._actor?this._actor.setPosition(new AJSVector2(a,b)):AUtilLog.warn("No actor, can't set position!")},b.prototype.getActor=function(){return this._actor},b.prototype.getRotation=function(){return this._properties.rotation._value},b}(AHandle),AHTriangle=function(a){function b(a,c,d,e,f,g,h,i){var j;if(param.required(c),param.required(d),param.required(e),param.required(f),i=param.optional(i,!1),g=param.optional(g,0),0>=c||0>=d)throw new Error("Base/Height must be >0!");b.__super__.constructor.call(this,a,h),this.name="Triangle "+this._id.replace("ahandle-",""),this._properties.position.components.x._value=e,this._properties.position.components.y._value=f,this._properties.rotation.update(g),j=this,this._properties.base={type:"number",min:0,placeholder:30,live:!0,"float":!0,_value:c,getValue:function(){return this._value=j._actor.getBase()},update:function(a){return this._value=param.required(a),null!==j._actor?j._actor.setBase(Number(a)):void 0}},this._properties.height={type:"number",min:0,placeholder:60,live:!0,"float":!0,_value:d,getValue:function(){return this._value=j._actor.getHeight()},update:function(a){return this._value=param.required(a),null!==j._actor?j._actor.setHeight(Number(a)):void 0}},i||this.postInit()}return __extends(b,a),b.prototype.getBase=function(){return this._properties.base._value
},b.prototype.getHeight=function(){return this._properties.height._value},b.prototype._birth=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(!this._alive)return this._alive=!0,h=this._properties.psyx.components.enabled._value,g=this._properties.psyx.components.mass._value,d=this._properties.psyx.components.friction._value,c=this._properties.psyx.components.elasticity._value,b=this._properties.base._value,f=this._properties.height._value,k=this._properties.position.components.x._value,l=this._properties.position.components.y._value,j=this._properties.rotation._value,i=this._properties.color.components.r._value,e=this._properties.color.components.g._value,a=this._properties.color.components.b._value,this._actor=new AJSTriangle({psyx:h,mass:g,friction:d,elasticity:c,base:b,height:f,position:new AJSVector2(k,l),color:new AJSColor3(i,e,a),rotation:j})},b}(AHBaseActor),AHRectangle=function(a){function b(a,c,d,e,f,g,h,i){var j;if(param.required(c),param.required(d),param.required(e),param.required(f),i=param.optional(i,!1),g=param.optional(g,0),0>=c||0>=d)throw new Error("Width/Height must be >0!");b.__super__.constructor.call(this,a,h),this.name="Rectangle "+this._id.replace("ahandle-",""),this._properties.position.components.x._value=e,this._properties.position.components.y._value=f,this._properties.rotation.update(g),j=this,this._properties.width={type:"number",min:0,placeholder:100,"float":!0,live:!0,_value:c,getValue:function(){return this._value=j._actor.getWidth()},update:function(a){return this._value=param.required(a),null!==j._actor?j._actor.setWidth(Number(a)):void 0}},this._properties.height={type:"number",min:0,placeholder:100,"float":!0,live:!0,_value:d,getValue:function(){return this._value=j._actor.getHeight()},update:function(a){return this._value=param.required(a),null!==j._actor?j._actor.setHeight(Number(a)):void 0}},i||this.postInit()}return __extends(b,a),b.prototype.getHeight=function(){return this._properties.height._value},b.prototype.getWidth=function(){return this._properties.width._value},b.prototype._birth=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(!this._alive)return this._alive=!0,g=this._properties.psyx.components.enabled._value,f=this._properties.psyx.components.mass._value,c=this._properties.psyx.components.friction._value,b=this._properties.psyx.components.elasticity._value,j=this._properties.width._value,e=this._properties.height._value,k=this._properties.position.components.x._value,l=this._properties.position.components.y._value,i=this._properties.rotation._value,h=this._properties.color.components.r._value,d=this._properties.color.components.g._value,a=this._properties.color.components.b._value,this._actor=new AJSRectangle({psyx:g,mass:f,friction:c,elasticity:b,w:j,h:e,position:new AJSVector2(k,l),color:new AJSColor3(h,d,a),rotation:i})},b}(AHBaseActor),AHPolygon=function(a){function b(a,c,d,e,f,g,h,i){var j;if(param.required(c),param.required(d),param.required(e),param.required(f),i=param.optional(i,!1),g=param.optional(g,0),3>c)throw new Error("Can't create an ngon with less than 3 sides");0>d&&(d*=-1),b.__super__.constructor.call(this,a,h),this.name="Polygon "+this._id.replace("ahandle-",""),this._properties.position.components.x._value=e,this._properties.position.components.y._value=f,this._properties.rotation.update(g),j=this,this._properties.sides={type:"number",min:3,placeholder:5,"float":!1,_value:c,live:!0,getValue:function(){return this._value},update:function(a){return this._value=param.required(a),null!==j._actor?j._actor.setSegments(Number(a)):void 0}},this._properties.radius={type:"number",min:0,"default":50,"float":!0,live:!0,_value:d,getValue:function(){return this._value},update:function(a){return this._value=param.required(a),null!==j._actor?j._actor.setRadius(Number(a)):void 0}},i||this.postInit()}return __extends(b,a),b.prototype.getSides=function(){return this._properties.sides._value},b.prototype.getRadius=function(){return this._properties.radius._value},b.prototype._birth=function(){var a,b,c,d,e,f,g,h,i,j,k,l;if(!this._alive)return this._alive=!0,f=this._properties.psyx.components.enabled._value,e=this._properties.psyx.components.mass._value,c=this._properties.psyx.components.friction._value,b=this._properties.psyx.components.elasticity._value,h=this._properties.radius._value,j=this._properties.sides._value,k=this._properties.position.components.x._value,l=this._properties.position.components.y._value,i=this._properties.rotation._value,g=this._properties.color.components.r._value,d=this._properties.color.components.g._value,a=this._properties.color.components.b._value,this._actor=new AJSPolygon({psyx:f,mass:e,friction:c,elasticity:b,radius:h,segments:j,position:new AJSVector2(k,l),color:new AJSColor3(g,d,a),rotation:i})},b}(AHBaseActor),AWidget=function(){function a(a,b,c,d){var e,f,g,h,i;if(this._id=a,this._parent=param.optional(b,"body"),d=param.optional(d,!1),this._sel=null,(""+this._id).length>0){if(this._sel="#"+this._id,i="","string"==typeof b)i=b;else{if(void 0===b.getSel||null===b.getSel)throw new Error("Invalid parent specified!");i=b.getSel()}if(d?$(i).prepend('<div id="'+this._id+'"></div>'):$(i).append('<div id="'+this._id+'"></div>'),c instanceof Array)for(g=0,h=c.length;h>g;g++)e=c[g],$(this._sel).addClass(e)}f=this,$(document).ready(function(){return $("body").data(f._sel,f)})}return a.prototype.getSel=function(){return this._sel},a.prototype.getId=function(){return""+this._id},a.prototype.dropped=function(){return null},a}(),AWidgetContextMenu=function(a){function b(a,c,d){return param.required(a),param.required(c),param.required(d),void 0===d.getContextFunctions?(AUtilLog.warn("Object has no getContextFunctions, can't create ctx menu"),void 0):(this.functions=d.getContextFunctions(),this.alive=!0,$.isEmptyObject(this.functions)||(b.__super__.constructor.call(this,prefId("actxmenu"),"#aeditor",["actxmenu"]),$("body").data(this.getId(),this),$(this.getSel()).css({left:a,top:c}),$(this.getSel()).html(this._buildHTML()),b.animate?$(this.getSel()).slideDown(b.animateSpeed):$(this.getSel()).show()),void 0)}return __extends(b,a),b._registeredMouseup=!1,b.animate=!0,b.animateSpeed=80,b.prototype._buildHTML=function(){var a,c,d,e;e="<ul>",c=this,d=function(a){return"function"!=typeof c.functions[a]?(AUtilLog.error("Only methods can be bound to context menu items"),void 0):$(document).on("click",'[data-id="'+c.functions[a]._ident+'"]',function(){return c.remove(),c.functions[a]()})};for(a in this.functions)void 0!==this.functions[a]._ident&&this._unbindListener(this.functions[a]._ident),this.functions[a]._ident=this._convertToIdent(a)+nextId(),e+='<li data-id="'+this.functions[a]._ident+'">'+a+"</li>",d(a);return b._registeredMouseup||($(document).mouseup(function(a){var c,d;return d=$(".actxmenu"),c=$("body").data($(d).attr("id")),void 0===d||void 0===c||d.is(a.target)||0!==d.has(a.target).length?void 0:b.animate?$(c._sel).slideUp(b.animateSpeed,function(){return c.remove()}):c.remove()}),b._registeredMouseup=!0),e+="</ul>"},b.prototype._unbindListener=function(a){return $(document).off("click",'[data-id="'+a+'"]')},b.prototype._convertToIdent=function(a){return a.toLowerCase().split(" ").join("_")},b.prototype.remove=function(){var a;if(this.alive){for(a in this.functions)void 0!==this.functions[a]._ident&&(this._unbindListener(this.functions[a]._ident),this.functions[a]._ident=void 0);return $(this.getSel()).remove(),$("body").removeData(this.getId()),this.alive=!1}},b}(AWidget),AWidgetNotification=function(a){function b(a,c,d){var e,f,g=this;param.required(a),c=param.optional(c,"blue",["blue","red","green"]),d=param.optional(d,2e3),this.timeout=null,b._listenersRegistered||($(document).ready(function(){return $(document).on("click",".anotification .icon-remove",function(){return $("body").data("#"+$(this).parent().attr("id")).killMe()})}),b._listenersRegistered=!0),b.__super__.constructor.call(this,prefId("anotification"),"#aeditor",["anotification"]),f="",f+='<i class="icon-remove"></i>',f+="<p>"+a+"</p>",$(this._sel).html(f),$(this._sel).css({left:$(window).width()-$(this._sel).width()-32,top:24+b.cHeight+8*b.count,"background-color":b.colors[c]}),$("body").data(this._sel,this),e=this,$(this._sel).show(),$(this._sel).animate({opacity:1},200,function(){return g.timeout=setTimeout(function(){return e.killMe()},d)}),b.count++,b.cHeight+=$(this._sel).height()+16}return __extends(b,a),b.count=0,b.cHeight=0,b.colors={red:"#cc0000",green:"#669900",blue:"#0099cc"},b._listenersRegistered=!1,b.prototype.killMe=function(){var a=this;return null!==this.timeout&&clearInterval(this.timeout),b.count--,b.cHeight-=$(this._sel).height()+16,$("body").removeData(this._sel),$(""+this._sel+" i").css("opacity","0"),$(this._sel).animate({opacity:0},400,function(){return $(a._sel).remove()})},b}(AWidget),AWidgetModal=function(a){function b(a,c,d){var e;this.title=a,this.content=c,param.required(this.title),param.required(this.content),d=param.optional(d,!1),void 0!==$("body").data("activeModal")&&($("body").data("activeModal").close(),$("body").removeData("activeModal")),this.dead=!0,b.__super__.constructor.call(this,prefId("amodal"),"#aeditor",["amodal"]),this.show(),b.__listenersRegistered||(b.__listenersRegistered=!0,e=this,$(document).ready(function(){return $(document).mouseup(function(a){var b;if(void 0!==$("body").data("activeModal"))return b=$($("body").data("activeModal")._sel),b.is(a.target)||0!==b.has(a.target).length||d?void 0:$("body").data("activeModal").close()}),$(document).on("click",".amodal .amf-dismiss",function(){var a;return a=$(this).closest(".amodal").attr("id"),$("body").data("#"+a).close()})}))}return __extends(b,a),b.__listenersRegistered=!1,b.prototype.show=function(){var a;if(this.dead)return this.dead=!1,a='<div class="aminner">',a+='<span class="amtitle">'+this.title+"</span>",a+='<div class="ambody">'+this.content+"</span>",a+='<div class="amfooter">',a+='<button class="amf-dismiss">Close</button>',a+="</div>",a+="</div>",$(this._sel).html(a),$("body").data("activeModal",this),$(this._sel).animate({opacity:1},400)},b.prototype.close=function(){var a=this;if(!this.dead)return this.dead=!0,$(this._sel).is(":visible")?$(this._sel).animate({opacity:0},400,function(){return a._kill()}):this._kill()},b.prototype._kill=function(){return $("body").removeData("activeModal"),$(this._sel).remove()},b}(AWidget),ABezier=function(){function a(a,b,c,d,e){this._start=a,this._end=b,this._degree=c,this._control=d,this._buffer=e,param.required(this._start),param.required(this._end),param.required(this._degree,[0,1,2]),this._buffer=param.optional(this._buffer,!1),this._bufferData={},param.required(this._start.x),param.required(this._start.y),param.required(this._end.x),param.required(this._end.y),this._degree>0&&(param.required(this._control),this._degree>1&&(param.required(this._control[0].x),param.required(this._control[0].y)),2===this._degree&&(param.required(this._control[1].x),param.required(this._control[1].y)))}return a.prototype.eval=function(a){var b,c,d,e,f,g;if(param.required(a),this._buffer&&void 0!==this._bufferData[String(a)])return this._bufferData[String(a)];if(a>1||0>a)throw new Error("t out of bounds! "+a);if(0===this._degree)b={x:this._start.x+(this._end.x-this._start.x)*a,y:this._start.y+(this._end.y-this._start.y)*a},this._buffer&&(this._bufferData[String(a)]=b);else if(1===this._degree)c=1-a,d=c*c,f=a*a,b={x:d*this._start.x+2*c*a*this._control[0].x+f*this._end.x,y:d*this._start.y+2*c*a*this._control[0].y+f*this._end.y},this._buffer&&(this._bufferData[String(a)]=b);else{if(2!==this._degree)throw new Error("Invalid degree, can't evaluate ("+this._degree+")");c=1-a,d=c*c,e=d*c,f=a*a,g=f*a,b={x:e*this._start.x+3*d*a*this._control[0].x+3*c*f*this._control[1].x+g*this._end.x,y:e*this._start.y+3*d*a*this._control[0].y+3*c*f*this._control[1].y+g*this._end.y},this._buffer&&(this._bufferData[String(a)]=b)}return b},a.prototype.enableBuffer=function(){return this._buffer=!0},a.prototype.disableBuffer=function(){return this._buffer=!1,this._bufferData={}},a}(),AWidgetTimeline=function(a){function b(a,c){var d,e,f;if(b.__exists)throw new Error("Only one timeline can exist at any one time!");if(b.__exists=!0,b.__instance=this,param.required(a),this._duration=Number(param.required(c)),e=b._timebarColors.length,f=b._timebarBGColors.length,e!==f)throw new Error("Timeline color count != timeline bg color count!");if(this._duration<250)throw new Error("Ad must be longer than 250ms!");b.__super__.constructor.call(this,prefId("atimeline"),a,["atimeline"]),this._actors=[],this._bodyPadding=$("body").css("padding-bottom"),"auto"===this._bodyPadding&&(this._bodyPadding=0),this._bodyPadding=this._bodyPadding.split("px").join(""),this.resize(256),this.renderStructure(),this._updateCursorTime(),d=this,this._enableDrag(),this._regListeners()}return __extends(b,a),b.__exists=!1,b.__instance=null,b._timebarColors=["atimebar-color-1","atimebar-color-2","atimebar-color-3","atimebar-color-4"],b._timebarBGColors=["atimebar-color-1-bg","atimebar-color-2-bg","atimebar-color-3-bg","atimebar-color-4-bg"],b.prototype._enableDrag=function(){var a;return a=this,$("#att-cursor").draggable({axis:"x",containment:"parent",drag:function(b,c){return a._onCursorDrag(b,c),a._onCursorDragStop(b,c)}})},b.prototype._regListeners=function(){return $(document).ready(function(){return $(document).on("click",".atts-outer",function(a){return me._outerClicked(a,this)})})},b.prototype._onCursorDrag=function(){return this._updateCursorTime()},b.prototype._onCursorDragStop=function(){var a,b,c,d,e,f;for(e=this._actors,f=[],c=0,d=e.length;d>c;c++)a=e[c],b=this.getCursorTime(),(b<a.lifetimeStart||b>a.lifetimeEnd)&&a.isAlive()&&a.timelineDeath(),a.isAlive()||b>=a.lifetimeStart&&b<=a.lifetimeEnd?f.push(a.updateInTime()):f.push(void 0);return f},b.prototype._updateCursorTime=function(){var a;return a=(this.getCursorTime()/1e3).toFixed(3),$("#attt-cursor-time").text("Cursor: "+a+"s")},b.prototype._outerClicked=function(a,b){var c,d;return param.required(a),param.required(b),d=Number($(b).attr("data-index")),0>d||d>this._actors.length-1||isNaN(d)?(AUtilLog.warn("Clicked timebar has an invalid index, bailing ["+d+"]"),void 0):(c=this._actors[d],alert(""+c.name+" clicked"))},b.getMe=function(){return b.__instance},b.getRandomTimebarColor=function(){return Math.floor(Math.random()*b._timebarColors.length)},b.prototype.setCursorTime=function(a){if(param.required(a),0===$("#att-cursor").length)throw new Error("Cursor not visible can't return time!");return $("#att-cursor").css("left",$("#att-space").width()*(a/this._duration)),this._onCursorDrag(),this._onCursorDragStop()},b.prototype.getCursorTime=function(){if(0===$("#att-cursor").length)throw new Error("Cursor not visible can't return time!");return this._duration*($("#att-cursor").position().left/$("#att-space").width())},b.prototype.registerActor=function(a){if(param.required(a),!a instanceof AHBaseActor)throw new Error("Actor must be an instance of AHBaseActor!");return this._actors.push(a),this._renderActorSpace(this._actors.length-1),this._renderActors(this._actors.length-1)},b.prototype.removeActor=function(a){var b,c,d,e,f;for(param.required(a),f=this._actors,c=d=0,e=f.length;e>d;c=++d)if(b=f[c],b.getActorId()===a)return this._actors.splice(c,1),this._renderActors(),this._renderSpace(),!0;return!1},b.prototype.getDuration=function(){return this._duration},b.prototype.renderStructure=function(){var a;return a="",a+='<ul id="at-actors">',a+="<hr>",a+='<div id="ata-title">Actors</div>',a+="<hr>",a+='<div id="ata-body"></div>',a+="</ul>",a+='<div id="at-timeline">',a+='<div id="att-toolbar">',a+='<div class="attt-third">',a+='<span id="attt-cursor-time"></span>',a+="</div>",a+='<div class="attt-third">',a+='<span id="attt-name">Timeline</span>',a+="</div>",a+='<div class="attt-third">',a+='<i class="icon-cog"></i>',a+="</div>",a+="</div>",a+='<div id="att-cursor"><div></div></div>',a+='<ul id="att-space"></ul>',a+="</div>",$(this._sel).html(a)},b.prototype.render=function(){return this._renderActors(),this._renderSpace()},b.prototype._refreshActorRows=function(){var a;return a=this,$(".atab-spacer").each(function(){var c,d,e,f,g,h;for(e=$(this).parent().find(".atab-name")[0],c=a._actors[Number($(this).parent().attr("data-index"))],$(this).width($(this).parent().width()-$(e).width()-24),h=b._timebarBGColors,f=0,g=h.length;g>f;f++)d=h[f],$(this).removeClass(d);return $(this).addClass(b._timebarBGColors[c.timebarColor])}),$(".atab-name").each(function(){var c,d,e,f,g;for(c=a._actors[Number($(this).parent().attr("data-index"))],g=b._timebarColors,e=0,f=g.length;f>e;e++)d=g[e],$(this).removeClass(d);return $(this).addClass(b._timebarColors[c.timebarColor])})},b.prototype._renderActors=function(){var a,b,c,d,e,f;for(c="",f=this._actors,b=d=0,e=f.length;e>d;b=++d)a=f[b],c+=this._renderSingleActor(b,!0);return $("#ata-body").html(c),this._refreshActorRows()},b.prototype._renderSingleActor=function(a,b){var c,d,e;return b=param.optional(b,!1),param.required(a),d='<div class="atab-spacer"></div>',c='<div class="atab-name">'+this._actors[a].name+"</div>",e='<li data-index="'+a+'">'+c+d+"</li>",b?e:($("#ata-body").append(e),this._refreshActorRows())},b.prototype._renderActorSpace=function(a,c){var d,e,f,g,h,i,j,k,l,m;if(c=param.optional(c,!1),param.required(a),0>a||a>=this._actors.length)throw new Error("Invalid index, no actor at "+a+", can't render space");if(k="",g=$("#att-space").width(),d=this._actors[a],d.lifetimeEnd<d.lifetimeStart)throw new Error("Actor lifetime end must come after lifetime start! "+("start: "+d.lifetimeStart+", end: "+d.lifetimeEnd));if(d.lifetimeStart<0||d.lifetimeEnd>this._duration)throw new Error("Actor exists beyond our duration!");m=g*(d.lifetimeStart/this._duration),l=g*((d.lifetimeEnd-d.lifetimeStart)/this._duration),h='style="left:'+m+"px; width:"+l+'px"',j=b._timebarBGColors[d.timebarColor],k+='<div data-index="'+a+'" class="atts-outer">',k+="<div "+h+' class="attso-inner '+j+'">',i=d.getAnimations();for(e in i)f=g*((Number(e)-d.lifetimeStart)/this._duration),k+='<div style="left: '+f+'px;" class="attso-key">',k+='<i class="icon-bolt"></i>',k+="</div>";return k+="</div>",k+="</div>",c?k:$("#att-space").append(k)},b.prototype._renderSpace=function(){var a,b,c,d,e,f;for(c="",f=this._actors,b=d=0,e=f.length;e>d;b=++d)a=f[b],c+=this._renderActorSpace(b,!0);return $("#att-space").html(c)},b.prototype.resize=function(a){return this._height=a,$(this._sel).css("height",""+this._height+"px"),$("body").css("padding-bottom",this._bodyPadding+this._height)},b}(AWidget),AWidgetWorkspace=function(a){function b(a){var c,d,e=this;return b.__exists===!0?(AUtilLog.warn("A workspace already exists, refusing to continue!"),void 0):(param.required(a),b.__exists=!0,b.__instance=this,b.__super__.constructor.call(this,prefId("aworkspace"),a,["aworkspace"]),this.actorObjects=[],c=this,void 0===window.ajax&&(window.ajax=microAjax),this._cWidth=$(this._sel).width(),this._cHeight=$(window).height()-$(".amainbar").height()-$(".atimeline").height()-2,this._pWidth=800,this._pHeight=480,this._pickBuffer=null,this._pickTexture=null,d="",d+='<div id="aw-canvas-container">',d+='<div id="awcc-outline-text"></div>',d+='<div id="awcc-outline"></div>',d+="</div",$(this._sel).html(d),AUtilLog.info("Starting AWGL instance..."),new AWGLEngine(null,4,function(a){return e._awgl=a,e._engineInit(),e._applyCanvasSizeUpdate()},"aw-canvas-container",this._cWidth,this._cHeight),void 0)}return __extends(b,a),b.__exists=!1,b.__instance=null,b.prototype.getCanvasWidth=function(){return this._cWidth},b.prototype.getCanvasHeight=function(){return this._cHeight},b.prototype._applyCanvasSizeUpdate=function(){return $("#aw-canvas-container").css({height:""+this._cHeight+"px",width:""+this._cWidth+"px"}),this._buildPickBuffer()},b.getMe=function(){return b.__instance},b.prototype.reset=function(){var a,b,c,d;for(d=this.actorObjects,b=0,c=d.length;c>b;b++)a=d[b],AWidgetTimeline.getMe().removeActor(a.getActorId()),a.timelineDeath(),a["delete"]();return this.actorObjects=[]},b.prototype.notifyDemise=function(a){var b,c,d,e,f;if(a instanceof AHBaseActor)for(f=this.actorObjects,b=d=0,e=f.length;e>d;b=++d)if(c=f[b],c.getId()===a.getId())return this.actorObjects.splice(b,1),AWidgetTimeline.getMe().removeActor(a.getActorId()),void 0},b.prototype._buildPickBuffer=function(){var a,b,c,d;return a=this._awgl.getGL(),null!==this._pickTexture&&a.deleteTexture(this._pickTexture),null!==this._pickBuffer&&a.deleteFramebuffer(this._pickBuffer),this._pickBuffer=a.createFramebuffer(),this._pickTexture=a.createTexture(),d=this._awgl.getWidth(),b=this._awgl.getHeight(),a.bindFramebuffer(a.FRAMEBUFFER,this._pickBuffer),a.bindTexture(a.TEXTURE_2D,this._pickTexture),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR_MIPMAP_NEAREST),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,d,b,0,a.RGBA,a.UNSIGNED_BYTE,null),a.generateMipmap(a.TEXTURE_2D),c=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,c),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,d,b),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this._pickTexture,c),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c),a.bindTexture(a.TEXTURE_2D,null),a.bindRenderbuffer(a.RENDERBUFFER,null),a.bindFramebuffer(a.FRAMEBUFFER,null)},b.prototype.registerActor=function(a){if(param.required(a),!a instanceof AHBaseActor)throw new Error("You can only register actors that derive from BaseActor");return this.actorObjects.push(a),AWidgetTimeline.getMe().registerActor(a)},b.prototype._engineInit=function(){var a;return AUtilLog.info("AWGL instance up, initializing workspace"),a=this,$(document).ready(function(){var b,c,d,e,f,g,h,i,j,k,l;return $(".aworkspace-drag").draggable({addClasses:!1,helper:"clone",revert:"invalid",cursor:"pointer"}),$(".aworkspace canvas").droppable({accept:".aworkspace-drag",drop:function(b,c){var d,e,f,g;return f=$(c.draggable).children("div").attr("id"),e=$("body").data(f),g=a.domToGL(c.position.left,c.position.top),d=e.dropped("workspace",g.x,g.y),d instanceof AHBaseActor?(a.actorObjects.push(d),AWidgetTimeline.getMe().registerActor(d)):void 0}}),g=0,h=0,c=0,d=0,b=-1,j=5,k=!1,e=null,f=!1,i=!1,l=!1,$(".aworkspace canvas").mousedown(function(f){var j;return j=a.domToGL(f.pageX,f.pageY),a._performPick(j.x,j.y,function(j,l,m){var n,o,p,q,r,s,t;if(248===m){for(r=j+255*l,t=a.actorObjects,n=q=0,s=t.length;s>q;n=++q)if(o=t[n],o.getActorId()===r){b=n;break}return-1!==b?(p=$("body").data("default-properties"),p instanceof AWidgetSidebarProperties&&p.privvyIface("get_id")===r&&(k=!0,e=p),g=f.pageX,h=f.pageY,c=a.actorObjects[b].getPosition().x,d=a.actorObjects[b].getPosition().y,i=!0):void 0}})}),$(".aworkspace canvas").mouseup(function(){return f&&a.actorObjects[b].getActor().enablePsyx(),i=!1,b=-1,e=null,k=!1,f=!1,setTimeout(function(){return l=!1},1)}),$(".aworkspace canvas").mousemove(function(m){var n,o;return i&&(l||(a.actorObjects[b].getActor().hasPsyx()&&(f=!0,a.actorObjects[b].getActor().disablePsyx()),l=!0),(Math.abs(m.pageX-g)>j||Math.abs(m.pageY-h)>j)&&(n=Number(c+(m.pageX-g)),o=Number(d+-1*(m.pageY-h)),a.actorObjects[b].setPosition(n,o),k))?e.privvyIface("update_position",n,o):void 0}),$(".aworkspace canvas").click(function(b){var c;if(!l)return c=a.domToGL(b.pageX,b.pageY),a._performPick(c.x,c.y,function(b,c,d){var e,f,g,h,i,j;if(248!==d)return $("body").data("default-properties").clear(),void 0;for(g=b+255*c,i=a.actorObjects,j=[],f=0,h=i.length;h>f;f++)e=i[f],e.getActorId()===g?j.push(e.onClick()):j.push(void 0);return j})}),$(document).on("contextmenu",".aworkspace canvas",function(b){var c;return b.preventDefault(),c=a.domToGL(b.pageX,b.pageY),a._performPick(c.x,c.y,function(c,d,e){var f,g,h,i,j;if(248===e)for(h=c+255*d,j=a.actorObjects,g=0,i=j.length;i>g;g++)if(f=j[g],f.getActorId()===h)return $.isEmptyObject(f.getContextFunctions())||new AWidgetContextMenu(b.pageX,b.pageY,f),void 0}),!1})}),this._awgl.startRendering()},b.prototype._performPick=function(a,b,c){var d=this;return this._awgl.requestPickingRender(this._pickBuffer,function(){var e,f;return f=new Uint8Array(4),e=d._awgl.getGL(),e.bindFramebuffer(e.FRAMEBUFFER,d._pickBuffer),e.readPixels(a,b,1,1,e.RGBA,e.UNSIGNED_BYTE,f),e.bindFramebuffer(e.FRAMEBUFFER,null),c(f[0],f[1],f[2])})},b.prototype.domToGL=function(a,b){var c,d,e;return void 0===this._awgl?(AUtilLog.warn("Can't convert coords, awgl not up!"),null):(d=$(""+this.getSel()+" canvas").offset().top,c=$(""+this.getSel()+" canvas").offset().left,e={x:a-c,y:this._awgl.getHeight()-(b-d)})},b.prototype.updateOutline=function(){var a,b;return b=$(this._sel).height()/2-2-$("#awcc-outline").height()/2,a=$(this._sel).width()/2-2-$("#awcc-outline").width()/2,$("#awcc-outline").css({top:b,left:a,width:this._pWidth,height:this._pHeight}),$("#awcc-outline-text").css({top:b-16,left:a}),$("#awcc-outline-text").text(""+this._pWidth+"x"+this._pHeight)},b.prototype.onResize=function(){return $(this._sel).height($(document).height()-$(".amainbar").height()+2-$(".atimeline").height()),this.updateOutline()},b}(AWidget),AWidgetControlBar=function(a){function b(a){if(b.__exists===!0)return AUtilLog.warn("A controlbar already exists, refusing to continue!"),void 0;if(param.required(a),b.__exists=!0,b.__instance=this,!a instanceof AWidgetWorkspace)throw new Error("ControlBar needs to bind to an existing workspace!");b.__super__.constructor.call(this,prefId("awcontrolbar"),a,["awcontrolbar"],!0),this._controls=[],new AWidgetControlCanvas,new AWidgetControlRender,new AWidgetControlPhysics,this.render()}return __extends(b,a),b.__exists=!1,b.__instance=null,b.prototype.addControl=function(a){return this._controls.push(a),this.render()},b.prototype.render=function(){var a,b,c,d,e,f,g;for(d="",d+='<div class="awcb-inner">',c=this._parent.getCanvasWidth(),b=this._parent.getCanvasHeight(),g=this._controls,e=0,f=g.length;f>e;e++)a=g[e],d+=a.render();return d+="</div>",$(this._sel).html(d)},b.getMe=function(){return b.__instance},b}(AWidget),AWidgetControlBarControl=function(){function a(a,b,c){this.title=a,this.status=b,this.controls=c,param.required(this.title),this.status=param.optional(this.status,"-"),this.controls=param.optional(this.controls,[]),this.statusState="off",this._initialized=!1,AWidgetControlBar.getMe().addControl(this)}return a.classSection="awcb-section",a.classTitle="awcb-section-title",a.classStatus="awcb-control-status",a.classControl="awcb-control",a.prototype.initialize=function(){this._initialized},a.prototype.render=function(){var b,c,d,e,f,g,h,i,j,k,l,m,n=this;for(e=a.classSection,g=a.classTitle,f=a.classStatus,d=a.classControl,this._initialized||(this.initialize(),this._initialized=!0),i="",i+='<div class="'+e+'">',i+='<div class="'+g+'">'+this.title+"</div>",c=this,m=function(a){return $(document).on("click","#"+n.controls[a].id,function(){return c.controls[a].cb(a)})},l=this.controls,h=j=0,k=l.length;k>j;h=++j)b=l[h],param.required(b.name),param.required(b.icon),param.required(b.state),param.optional(b.cb),(void 0===b.id||null===b.id)&&(b.id=prefId("awcbcontrol"),m(h)),i+='<div id="'+b.id+'" class="'+d+" "+b.state+'">',i+=b.name,i+='<i class="'+b.icon+'"></i>',i+="</div>";return i+='<div class="'+f+" "+this.statusState+'">'+this.status+"</div>",i+="</div>"},a.prototype.setStatusState=function(a,b){return this.statusState=a,param.required(this.statusState),b?AWidgetControlBar.getMe().render():void 0},a.prototype.setStatus=function(a,b){return this.status=a,param.required(this.status),b?AWidgetControlBar.getMe().render():void 0},a}(),AWidgetControlCanvas=function(a){function b(){var a;a=[{name:"Pick Size",icon:"icon-resize-full",state:"on",cb:function(){return alert("resize requested")}}],this._canvasHeight=0,this._canvasWidth=0,b.__super__.constructor.call(this,"Canvas","-",a)}return __extends(b,a),b.prototype.initialize=function(){return this._canvasHeight=AWidgetWorkspace.getMe().getCanvasHeight(),this._canvasWidth=AWidgetWorkspace.getMe().getCanvasWidth(),this.status=""+this._canvasWidth+"x"+this._canvasHeight},b}(AWidgetControlBarControl),AWidgetControlPhysics=function(a){function b(){var a;a=[{name:"Play",icon:"icon-play",state:"on",cb:function(){return alert("play pressed")}},{name:"Stop",icon:"icon-stop",state:"off",cb:function(){return alert("stop pressed")}}],b.__super__.constructor.call(this,"Physics","Stopped",a)}return __extends(b,a),b}(AWidgetControlBarControl),AWidgetControlRender=function(a){function b(){var a;a=[{name:"Play",icon:"icon-play",state:"on",cb:function(){return alert("play pressed")}},{name:"Stop",icon:"icon-stop",state:"off",cb:function(){return alert("stop pressed")}}],b.__super__.constructor.call(this,"Renderer","Stopped",a)}return __extends(b,a),b}(AWidgetControlBarControl),AWidgetSidebarItem=function(a){function b(a,c){if(param.required(a),!a instanceof AWidgetSidebar)throw new Error("Sidebar items need a AWidgetSidebar as a parent!");b.__super__.constructor.call(this,prefId("asitem"),a,c)}return __extends(b,a),b}(AWidget),AWidgetSidebar=function(a){function b(a,c,d,e){this._items=[],this._name=param.optional(c,"Sidebar"),this._origin=param.optional(d,"left",["left","right"]),this._width=param.optional(e,300),param.required(a),b.__super__.constructor.call(this,prefId("asidebar"),a,["asidebar"]),this._hiddenX=0,this._visibleX=0,this.setWidth(this._width),this.show(null,!1),this.onResize(),this._bindToggle()}return __extends(b,a),b.__staticInitialized=!1,b.prototype._bindToggle=function(){return b.__staticInitialized?void 0:(b.__staticInitialized=!0,$(document).ready(function(){return $(document).on("click",".as-toggle",function(){var a;return a=$("body").data("#"+$(this).parent().parent().attr("id")),a.toggle()})}))},b.prototype.setName=function(a){return this._name=param.required(a),this.render()},b.prototype.getName=function(){return this._name},b.prototype.addItem=function(a){var b;if(param.required(a),void 0===a.render||null===a.render)throw new Error("Item must have a render function!");if(void 0===a.getId||null===a.getId)throw new Error("Item must supply a getId() function!");if(b=a.render(),"string"!=typeof b)throw new Error("Item render function must return a string!");return this._items.push(a),this.render()},b.prototype.removeItem=function(a){var b,c,d;for(param.required(a),b=c=0,d=this._items.length;d>=0?d>c:c>d;b=d>=0?++c:--c)if(this._items[b].getId()===b&&typeof this._items[b].getId()==typeof b)return this._items.splice(b,1),this.render(),!0;return!1},b.prototype.render=function(){var a,b,c,d,e,f;for(b='<i class="as-toggle icon-double-angle',b+="left"===this._origin?'-left"></i>':'-right"></i>',c='<div class="as-name">'+this._name+b+"</div><hr>",f=this._items,d=0,e=f.length;e>d;d++)a=f[d],c+=a.render();return $(this._sel).html(c)},b.prototype.onResize=function(){return $(this._sel).height($(window).height()-$(".amainbar").height()-$(".atimeline").height()-2),$(this._sel).css({top:$(".amainbar").height()+2}),"right"===this._origin?(this._hiddenX=$(window).width()-32,this._visibleX=$(window).width()-this._width):void 0},b.prototype.setWidth=function(a){return param.required(a),this._width=a,"left"===this._origin?(this._hiddenX=-this._width+32,this._visibleX=0):(this._hiddenX=$(window).width()-32,this._visibleX=$(window).width()-this._width),$(this._sel).width(this._width)},b.prototype.toggle=function(a,b){return b=param.optional(b,!0),b&&AUtilLog.warn("Animation not yet supported"),this._visiblity?this.hide(a,b):this.show(a,b)},b.prototype.show=function(a,b){return b=param.optional(b,!0),this._visiblity===!0?(a&&a(),void 0):(b?$(this._sel).animate({left:this._visibleX},300):$(this._sel).css({left:this._visibleX}),this._visiblity=!0)},b.prototype.hide=function(a,b){return b=param.optional(b,!0),this._visiblity===!1?(a&&a(),void 0):(b?$(this._sel).animate({left:this._hiddenX},300):$(this._sel).css({left:this._hiddenX}),this._visiblity=!1)},b}(AWidget),AWidgetSidebarObject=function(a){function b(a,c,d){this._name=param.required(a),this._parent=param.required(c),this.icon=param.optional(d,""),b.__super__.constructor.call(this,this._parent.getParent(),["as-obj"]),this._parent.render()
}return __extends(b,a),b.prototype.render=function(){var a,b;return a='<i class="icon-caret-down"></i>',b="",this.icon.length>0&&(b='<img height="16" src="'+this.icon+'" class="awso-i">'),'<div id="'+this._sel+'" class="aso-name">'+b+this._name+a+"</div>"},b.prototype.setName=function(a){return this._name=param.required(a),this._parent.render()},b.prototype.dropped=function(a,b,c){return param.required(a),param.required(b),param.required(c),null},b}(AWidgetSidebarItem),AWidgetSidebarObjectGroup=function(a){function b(a,c){b.__super__.constructor.call(this,c,["as-objgroup"]),this._items=[],this.setName(a),this._parent.addItem(this),this._parent.render()}return __extends(b,a),b.prototype.render=function(){var a,b,c,d,e;for(b='<div class="as-objgroup">',b+='<span class="asog-catname">'+this._name+"</span>",b+="<ul>",e=this._items,c=0,d=e.length;d>c;c++)a=e[c],b+='<li class="aworkspace-drag">'+a.render()+"</li>";return b+="</ul></div>"},b.prototype.setName=function(a){return this._name=param.required(a),this._parent.render()},b.prototype.getName=function(){return this._name},b.prototype.addItem=function(a){if(param.required(a),!a instanceof AWidgetSidebarObject)throw new Error("Items have to be instances of AWidgetSidebarObject!");return this._items.push(a),this._parent.render()},b.prototype.createItem=function(a){var b;return param.required(a),b=new AWidgetSidebarObject(a,this),this._items.push(b),this._parent.render(),b},b.prototype.removeItem=function(a){var b,c,d;for(param.required(a),b=c=0,d=this._items.length;d>=0?d>c:c>d;b=d>=0?++c:--c)if(this._items[b].getId===a)return this._items.splice(b,1),this._parent.render(),!0;return!1},b.prototype.getParent=function(){return this._parent},b}(AWidgetSidebarItem),AWidgetSidebarProperties=function(a){function b(a){param.required(a),b.__super__.constructor.call(this,a),this._builtHMTL="",$("body").data("default-properties",this),this._parent.addItem(this),this._curObject=null,this._regListeners()}return __extends(b,a),b.__exists=!1,b.prototype._regListeners=function(){var a;return b.__exists===!1?(b.__exists=!0,a=this,$(document).ready(function(){var b,c,d,e,f,g;return $(document).on("click",".asp-save",function(){return a.save(this)}),c=0,d=0,f=null,b=-1,g=5,e=!1,$(document).on("mousedown",".drag_mod",function(a){return f=$(this).parent().find("> input")[0],null===f?AUtilLog.warn("Drag start on a label with no input!"):(c=a.pageX,d=a.pageY,b=Number($(f).val()),e=!0,$("body").css("cursor","e-resize"),a.preventDefault(),!1)}),$(document).mousemove(function(h){return e?(h.preventDefault(),(Math.abs(h.pageX-c)>g||Math.abs(h.pageY-d)>g)&&($(f).val(b+(h.pageX-c)),a._executeLive($(f).parent().find("> input")[0])),!1):void 0}),$(document).mouseup(function(){return e=!1,f=null,$("body").css("cursor","auto")}),$(document).on("input",".asp-control > input",function(){return a._executeLive($(this).parent().find("> input")[0])})})):void 0},b.prototype._executeLive=function(a){var b,c;for(b=$(a).parent();$(b).parent().hasClass("asp-control");)b=$(b).parent();return c=$(b).find(".aspc-live input"),1===c.length&&$(c[0]).is(":checked")?this.saveControl(b):void 0},b.prototype.save=function(a){var b;return param.required(a),null===this._curObject?(AUtilLog.warn("Save requested with no associated object!"),void 0):(b=this,$(a).parent().find(".asp-control-group > .asp-control").each(function(){return b.saveControl(this)}))},b.prototype.saveControl=function(a,b){var c,d,e,f,g,h,i,j,k,l,m;if(param.required(a),null===this._curObject)return AUtilLog.warn("Save requested with no associated object!"),void 0;if(b=param.optional(b,!1),e=$(a).attr("data-type"),g=function(b,c){return 0===b.length?(AUtilLog.error("No "+c+" found! "+a),!1):b.length>1?(AUtilLog.error("Too many of type "+c+" found! "+a),!1):!0},m=function(a){return g(a,"value")},i=function(a){return g(a,"label")},k={},d=$(a).find("> label"),i(d)){if(d=$(d[0]).attr("data-name"),"number"===e||"text"===e)f=$(a).find("> input"),m(f)&&(k[d]="number"===e?Number($(f[0]).val()):$(f[0]).val());else if("bool"===e)f=$(a).find("> input"),m(f)&&(k[d]=$(f[0]).is(":checked"));else if("composite"===e)for(l=$(a).find(".asp-control"),k[d]={},h=0,j=l.length;j>h;h++)c=l[h],$.extend(k[d],this.saveControl(c,!0));return b?k:this._curObject.updateProperties(k)}},b.prototype.refresh=function(a){var b,c,d;this._curObject=param.required(a),c=a.getProperties(),this._builtHMTL='<ul id="'+this._id+'" class="as-properties">';for(b in c)d=this._generateControl(b,c[b]),this._builtHMTL+='<li class="asp-control-group">'+d+"</li><hr>";return this._builtHMTL+='<button class="asp-save">Save</button><hr>',this._builtHMTL+="</ul>",this._parent.render()},b.prototype.clear=function(){return this._builtHMTL="",this._curObject=null,this._parent.render()},b.prototype.render=function(){return this._builtHMTL},b.prototype._generateControl=function(a,b,c){var d,e,f,g,h,i,j,k;if(c=param.optional(c,!1),param.required(a),param.required(b),param.required(b.type),d=a.charAt(0).toUpperCase()+a.substring(1),h="",h+='<div data-type="'+b.type+'" class="asp-control">',"composite"===b.type){param.required(b.components),g='data-name="'+a+'"',f='class="aspc-composite-name"',h+="<label "+g+" "+f+" >"+d+"</label>",b.getValue();for(e in b.components)h+=this._generateControl(e,b.components[e],!0)}else i=prefId("aspc"),j='data-name="'+a+'"',"number"===b.type&&(j+=' class="drag_mod"',d='<i class="icon-resize-horizontal"></i> '+d),h+="<label "+j+' for="'+i+'">'+d+"</label>",void 0===b.max&&(b.max=null),void 0===b.min&&(b.min=null),void 0===b.live&&(b.live=!1),"number"===b.type?(void 0===b["default"]&&(b["default"]=0),void 0===b.float&&(b.float=!0),h+="<input ",h+='name="'+i+'" ',h+='type="text" ',h+='data-max="'+b.max+'" ',h+='data-min="'+b.min+'" ',h+='data-control="number" ',h+='data-float="'+b.float+'" ',h+='placeholder="'+b["default"]+'" ',h+='value="'+b.getValue()+'" ',h+=" />"):"bool"===b.type?(void 0===b["default"]&&(b["default"]=!1),h+="<input ",h+='name="'+i+'" ',h+='type="checkbox" ',h+='data-control="bool" ',h+=null!=(k=b.getValue())?k:{"checked ":""},h+=" />"):"text"===b.type?(void 0===b["default"]&&(b["default"]=""),h+="<input ",h+='name="'+i+'" ',h+='type="text" ',h+='data-control="text" ',h+='placeholder="'+b["default"]+'" ',h+='value="'+b.getValue()+'" ',h+=" />"):AUtilLog.warn("Unrecognized property type "+b.type);return!c&&b.live&&(h+='<div class="aspc-live">',h+='<label for="live-'+a+'">Live</label>',h+='<input name="live-'+a+'" type="checkbox" checked>',h+="</div>"),h+="</div>"},b.prototype.privvyIface=function(a,b,c){var d,e,f,g;if(param.required(a),"update_position"===a)d=param.required(b),e=param.required(c),f=$(""+this._sel+' label[data-name="x"]'),g=$(""+this._sel+' label[data-name="y"]'),f.length>0&&g.length>0&&($(f).parent().find("input")[0].value=d,$(g).parent().find("input")[0].value=e);else if("get_id"===a&&this._curObject)return this._curObject.getActorId();return null},b}(AWidgetSidebarItem),AWidgetMainbarItem=function(){function a(a,b,c,d,e,f,g){if(this._id=a,this._parent=b,this._menubar=c,this._role=d,this._children=[],param.required(this._id),param.required(this._parent),param.required(this._menubar),param.required(this._role,["primary","secondary","detail"]),!(this._menubar instanceof AWidgetMainbar))throw new Error("You need to use an existing menubar to create an item!");this.label=param.optional(e,""),this.href=param.optional(f,"#"),this.sectionEnd=param.optional(g,!1),"detail"===this._role&&(this._children=void 0)}return a.prototype.render=function(){var a,b,c,d;switch(c="",this._role){case"primary":a=this._children.length<=0?"":'class="amb-primary-has-children"',b=null===this.click||void 0===this.click?"":'onclick="'+this.click+'"',c+="<a "+a+" "+b+' id="'+this._id+'" href="'+this.href+'">',c+="<li>"+this.label+"</li>",c+="</a>";break;case"secondary":d=this.sectionEnd?'class="ambc-section-end"':"",b=null===this.click||void 0===this.click?"":'onclick="'+this.click+'"',c+="<a "+d+" "+b+' id="'+this._id+'" href="'+this.href+'">',c+="<li>"+this.label+"</li>",c+="</a>";break;case"detail":c+="";break;default:throw new Error("Tried to render invalid menubar item ["+this._role+"]")}return c},a.prototype.createChild=function(b,c,d,e){var f,g;return e=param.optional(e,!1),b=param.optional(b,""),d=param.optional(d,null),c=param.optional(c,"javascript:void(0)",[],!1),"detail"===this._role?null:(g="secondary","secondary"===this._role&&(g="detail"),f=new a(prefId("amb-item"),this,this._menubar,g),f.label=b,f.href=c,f.sectionEnd=e,f.click=d,this._children.push(f),f)},a.prototype.removeChild=function(a){var b,c,d;for(b=c=0,d=this._children.length;d>=0?d>c:c>d;b=d>=0?++c:--c)if(this._children[b].getId()===a)return this._children.splice(b,1),!0;return!1},a.prototype.getId=function(){return this._id},a}(),AWidgetMainbar=function(a){function b(a){return this._items=[],b.__exists===!0?(AUtilLog.warn("A mainbar already exists, refusing to continue!"),void 0):(b.__exists=!0,param.required(a),b.__super__.constructor.call(this,prefId("amainbar"),a,["amainbar"]),this._regListeners(),void 0)}return __extends(b,a),b.__exists=!1,b.prototype._regListeners=function(){return $(document).ready(function(){return $(document).mouseup(function(a){var b,c,d,e;return d=$(".amainbar-secondary"),b=$(".amainbar-detail"),d&&(e=$(".amainbar-primary .open"),d.is(a.target)||0!==d.has(a.target).length||(d.hide(),e.removeClass("open"))),b&&(c=$(".amainbar-secondary .open"),!b.is(a.target)&&0===b.has(a.target).length)?(b.hide(),c.removeClass("open")):void 0}),$(document).on("click",".amb-primary-has-children",function(a){var b;return b=$('.amainbar-secondary[data-owner="'+$(this).attr("id")+'"]'),$(this).hasClass("open")?(b.hide(),$(this).removeClass("open")):(b.show(),$(this).addClass("open")),a.preventDefault(),!1}),$(document).on("click",".amainbar-secondary a",function(a){return $(this).parent().hide(),$(".amb-primary-has-children").removeClass("open"),a.preventDefault(),!1}),$(document).on("mouseover",".amb-primary-has-children",function(){return $(".amb-primary-has-children.open").length>0?($(".amainbar-secondary").hide(),$(".amb-primary-has-children.open").removeClass("open"),$('.amainbar-secondary[data-owner="'+$(this).attr("id")+'"]').show(),$(this).addClass("open")):void 0})})},b.prototype.addItem=function(a,b){var c,d;return param.required(a),b=param.optional(b,"#"),d=prefId("amb-item"),c=new AWidgetMainbarItem(d,"#",this,"primary",a,b),this._items.push(c),c},b.prototype.removeItem=function(a){var b,c,d;for(b=c=0,d=this._items.length;d>=0?d>c:c>d;b=d>=0?++c:--c)if(this._items[b].getId===a)return this._items.splice(b,1),!0;return!1},b.prototype.render=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x;for(x=[],d=[],e='<div id="ambdecorater"></div>',e+='<ul class="amainbar-primary">',t=this._items,f=0,k=t.length;k>f;f++){if(b=t[f],"primary"!==b._role)throw new Error("Invalid child at this level! "+b._role+" (primary)");e+=b.render(),b._children.length>0&&x.push(b)}for(e+="</ul>",$(this._sel).html(e),h=0,l=x.length;l>h;h++){for(b=x[h],q=nextId(),r='data-owner="'+b.getId()+'"',g='id="'+q+'"',c='class="amainbar-secondary"',e="<ul "+r+" "+g+" "+c+">",u=b._children,i=0,m=u.length;m>i;i++){if(a=u[i],"secondary"!==a._role)throw new Error("Invalid child at this level! "+a._role+" (secondary)");e+=a.render(),a._children.length>0&&d.push(a)}e+="</ul>",$(this._sel).append(e),s=$("#"+b.getId()).offset().left,$("#"+q).css({left:s})}for(w=[],j=0,n=d.length;n>j;j++){for(b=d[j],e='<ul class="amainbar-detail">',v=b._children,p=0,o=v.length;o>p;p++){if(a=v[p],"detail"!==a._role)throw new Error("Invalid child at this level! "+a._role+" (detail)");if(e+=a.render(),a._children.length>0)throw new Error("Detail item has children! Damn.")}e+="</ul>",w.push($(this._sel).append(e))}return w},b}(AWidget),AdefyEditor=function(){function a(a){var b,c,d;if(d=navigator.userAgent,(-1!==d.search("Opera")||-1!==d.search("OPR"))&&alert("Opera does not fully support our editor, please use Chrome or FF!"),void 0===window.jQuery||null===window.jQuery)throw new Error("JQuery not found!");if(void 0===$.ui||null===$.ui)throw new Error("JQuery UI not found!");this.sel=param.optional(a,"#aeditor"),b=AUtilLog,this.widgets=[],0===$(this.sel).length&&(b.warn(""+this.sel+" not found, creating it and continuing"),$("body").prepend('<div id="'+this.sel.replace("#","")+'"></div>')),c=this,$(document).ready(function(){var a,d,e,f,g,h,i,j,k,l,m,n,o,p,q;return g=new AWidgetMainbar(c.sel),d=g.addItem("File"),p=g.addItem("View"),m=g.addItem("Timeline"),n=g.addItem("Tools"),e=g.addItem("Help"),a="window.adefy_editor",d.createChild("New Ad...",null,""+a+".newAd()"),d.createChild("New From Template...",null,null,!0),d.createChild("Save",null,""+a+".save()"),d.createChild("Save As..."),d.createChild("Export...",null,""+a+".export()",!0),d.createChild("Quit"),p.createChild("Toggle Toolbox Sidebar",null,"window.left_sidebar.toggle()"),p.createChild("Toggle Properties Sidebar",null,"window.right_sidebar.toggle()"),p.createChild("Fullscreen"),n.createChild("Preview..."),n.createChild("Calculate device support..."),n.createChild("Change canvas size..."),e.createChild("About AdefyEditor"),e.createChild("Changelog",null,null,!0),e.createChild("Take a Guided Tour"),e.createChild("Quick Start"),e.createChild("Tutorials"),e.createChild("Documentation"),g.render(),l=new AWidgetTimeline(c.sel,5e3),f=new AWidgetSidebar(c.sel,"Toolbox","left",256),j=new AWidgetSidebar(c.sel,"Properties","right",300),k=new AWidgetSidebarObjectGroup("Primitives",f),i=k.createItem("Rectangle"),h=k.createItem("Polgyon"),o=k.createItem("Triangle"),i.icon="img/icon_rectangle.png",h.icon="img/icon_hexagon.png",o.icon="img/icon_triangle.png",f.render(),i.dropped=function(a,b,c){return param.required(a),param.required(b),param.required(c),"workspace"!==a?null:new AHRectangle(AWidgetTimeline.getMe().getCursorTime(),100,100,b,c)},h.dropped=function(a,b,c){return param.required(a),param.required(b),param.required(c),"workspace"!==a?null:new AHPolygon(AWidgetTimeline.getMe().getCursorTime(),5,100,b,c)},o.dropped=function(a,b,c){return param.required(a),param.required(b),param.required(c),"workspace"!==a?null:new AHTriangle(AWidgetTimeline.getMe().getCursorTime(),20,30,b,c)},new AWidgetSidebarProperties(j),q=new AWidgetWorkspace(c.sel),c.widgets.push(g),c.widgets.push(q),c.widgets.push(f),c.widgets.push(j),window.left_sidebar=f,window.right_sidebar=j,c.onResize(),$(window).resize(function(){return c.onResize()}),setTimeout(function(){return c.onResize()},10),b.info("Adefy editor created on "+c.sel),new AWidgetNotification("Initialized","blue",1e3),void 0!==window.ad&&24===window.ad.length?(b.info("Loading "+window.ad),c.load(window.ad)):void 0})}return a.prototype.onResize=function(){var a,b,c,d,e;for(d=this.widgets,e=[],b=0,c=d.length;c>b;b++)a=d[b],void 0!==a.onResize?e.push(a.onResize()):e.push(void 0);return e},a.prototype.newAd=function(){return AWidgetWorkspace.getMe().reset()},a.prototype._serialize=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o;for(f={},f.cursorPosition=AWidgetTimeline.getMe().getCursorTime(),f.actors=[],m=AWidgetWorkspace.getMe().actorObjects,k=0,l=m.length;l>k;k++)if(a=m[k],i={},a instanceof AHTriangle?(i.type="AHTriangle",i.base=a.getBase(),i.height=a.getHeight()):a instanceof AHRectangle?(i.type="AHRectangle",i.width=a.getWidth(),i.height=a.getHeight()):a instanceof AHPolygon?(i.type="AHPolygon",i.radius=a.getRadius(),i.sides=a.getSides()):AUtilLog.warn("Actor of unknown type, not saving: "+a.name),void 0!==i.type){i.name=a.name,i.timebarColor=a.timebarColor,i.lifetimeStart=a.lifetimeStart,i.lifetimeEnd=a.lifetimeEnd,i.propBuffer=a._propBuffer,i.lastTemporalState=a._lastTemporalState,i.x=a.getPosition().x,i.y=a.getPosition().y,i.r=a.getRotation(),i.animations={},n=a._animations;for(b in n){c=n[b],i.animations[b]={};for(g in c){if(h=c[g],j={},void 0!==h.components){j.components={},o=h.components;for(d in o)e=o[d],j.components[d]=this._serializeAnimation(e)}else j=this._serializeAnimation(h);i.animations[b][g]=j}}f.actors.push(i)}return JSON.stringify(f)},a.prototype._serializeAnimation=function(a){var b;return b={},b.x1=a._start.x,b.y1=a._start.y,b.x2=a._end.x,b.y2=a._end.y,void 0!==a._control[0]&&(b.cp1x=a._control[0].x,b.cp1y=a._control[0].y),void 0!==a._control[1]&&(b.cp2x=a._control[1].x,b.cp2y=a._control[1].y),b},a.prototype._deserializeAnimation=function(a){var b,c,d,e;return e={x:a.x1,y:a.y1},d={x:a.x2,y:a.y2},c=0,void 0!==a.cp1x&&void 0!==a.cp1y&&(b=[],b.push({x:a.cp1x,y:a.cp1y}),c=1),void 0!==a.cp2x&&void 0!==a.cp2y&&(b.push({x:a.cp2x,y:a.cp2y}),c=2),new ABezier(e,d,c,b,!1)},a.prototype._deserialize=function(a){var b,c,d,e,f,g,h,i,j,k,l,m,n;if(param.required(a),0!==a.length){for(a=JSON.parse(a),param.required(a.cursorPosition),param.required(a.actors),AWidgetWorkspace.getMe().reset(),l=a.actors,j=0,k=l.length;k>j;j++){if(b=l[j],i=void 0!==b.type,i=i&&void 0!==b.name,i=i&&void 0!==b.timebarColor,i=i&&void 0!==b.lifetimeStart,i=i&&void 0!==b.lifetimeEnd,i=i&&void 0!==b.propBuffer,i=i&&void 0!==b.lastTemporalState,i=i&&void 0!==b.animations,AWidgetTimeline.getMe().setCursorTime(a.cursorPosition),!i)throw new Error("Data invalid: "+JSON.stringify(b));if("AHTriangle"===b.type)f=new AHTriangle(b.lifetimeStart,b.base,b.height,b.x,b.y,b.r,b.lifetimeEnd,!0);else if("AHRectangle"===b.type)f=new AHRectangle(b.lifetimeStart,b.width,b.height,b.x,b.y,b.r,b.lifetimeEnd,!0);else{if("AHPolygon"!==b.type)throw new Error("Invalid actor type, can't instantiate!");f=new AHPolygon(b.lifetimeStart,b.sides,b.radius,b.x,b.y,b.r,b.lifetimeEnd,!0)}f._propBuffer=b.propBuffer,m=b.animations;for(b in m){c=m[b],f._animations[b]={};for(g in c)if(h=c[g],f._animations[b][g]={},void 0!==h.components){f._animations[b][g].components={},n=h.components;for(d in n)e=n[d],f._animations[b][g].components[d]=this._deserializeAnimation(e)}else f._animations[b][g]=this._deserializeAnimation(h)}f.postInit(),AWidgetWorkspace.getMe().registerActor(f)}return null}},a.prototype.save=function(){var a;return a=this._serialize(),$.post("/logic/editor/save?id="+window.ad+"&data="+a,function(a){return void 0!==a.error?new AWidgetNotification("Error saving: "+a.error,"red"):new AWidgetNotification("Saved","green",1e3)})},a.prototype.load=function(a){var b=this;return param.required(a),$.post("/logic/editor/load?id="+a,function(a){return void 0!==a.error?(new AWidgetNotification("Error loading: "+a.error,"red"),void 0):b._deserialize(a.ad)})},a.prototype["export"]=function(){var a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(j="",m="a",a=function(){var a;return a=m.charCodeAt(m.length-1),65>a?a=65:a>89&&97>a?a=97:a>121?a=65:(a>=97||a>=65)&&a++,65===a?m+=String.fromCharCode(a):(m=m.split(""),m[m.length-1]=""+String.fromCharCode(a),m=m.join("")),m},d=function(a,b){return"var "+a+" = "+b+";"},f=function(a,b,c,d){var e,f,g,h;for(void 0===c&&(c=!1),void 0===b&&(b=[]),void 0===d&&(d=!1),f="",c&&(f+="new "),f+=""+a+"(",g=0,h=b.length;h>g;g++)e=b[g],"string"==typeof e?e='"'+e+'"':"object"==typeof e&&(e=JSON.stringify(e)),f+=""+e+", ";return f=f.slice(0,-2),f+=d?");":")"},p=AWidgetWorkspace.getMe().actorObjects,n=0,o=p.length;o>n;n++)b=p[n],i="",l="",c=a(),e={},k=b.getPosition(),g=b.getColor(),b instanceof AHTriangle?(l="AJSTriangle",e.base=b.getBase(),e.height=b.getHeight(),e.rotation=b.getRotation(),e.position={x:k.x,y:k.y},e.color={r:g.r,g:g.g,b:g.b}):b instanceof AHPolygon?(l="AJSPolygon",e.radius=b.getRadius(),e.segments=b.getSides(),e.position={x:k.x,y:k.y},e.color={r:g.r,g:g.g,b:g.b},e.rotation=b.getRotation()):b instanceof AHRectangle&&(l="AJSRectangle",e.w=b.getWidth(),e.h=b.getHeight(),e.position={x:k.x,y:k.y},e.color={r:g.r,g:g.g,b:g.b},e.rotation=b.getRotation()),0===l.length?(h="Unrecognized actor, can't export: "+b._id,AUtilLog.warn(h),new AWidgetNotification(h,"red")):i+=d(c,f(l,[e],!0,!1));return $.post("/logic/editor/export?id="+window.ad+"&data="+i,function(a){var b;return void 0!==a.error?(new AWidgetNotification("Error exporting: "+a.error),void 0):(b="",b+='<a href="'+a.link+'" target="_blank">View</a>',b+=" or ",b+='<a href="'+a.link+'?download=yes">Download</a>',new AWidgetModal("Exported",b))})},a}(),$(document).ready(function(){return window.adefy_editor=new AdefyEditor});